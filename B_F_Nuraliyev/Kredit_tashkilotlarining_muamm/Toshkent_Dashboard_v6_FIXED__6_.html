<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Toshkent viloyati Risk Dashboard v5 - Premium</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <style>
        :root {
            --primary: #6366f1;
            --primary-light: #818cf8;
            --accent: #f472b6;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --info: #3b82f6;
            --cyan: #06b6d4;
        }
        
        [data-theme="dark"] {
            --bg-primary: #0a0a0f;
            --bg-secondary: #12121a;
            --bg-card: linear-gradient(145deg, rgba(20, 20, 30, 0.9), rgba(15, 15, 25, 0.95));
            --bg-glass: rgba(255, 255, 255, 0.03);
            --text-primary: #f8fafc;
            --text-secondary: #94a3b8;
            --text-muted: #64748b;
            --border: rgba(255, 255, 255, 0.08);
            --glow: rgba(99, 102, 241, 0.4);
        }
        
        [data-theme="light"] {
            --bg-primary: #f8fafc;
            --bg-secondary: #ffffff;
            --bg-card: linear-gradient(145deg, rgba(255, 255, 255, 0.95), rgba(248, 250, 252, 0.9));
            --bg-glass: rgba(0, 0, 0, 0.02);
            --text-primary: #0f172a;
            --text-secondary: #475569;
            --text-muted: #94a3b8;
            --border: rgba(0, 0, 0, 0.08);
            --glow: rgba(99, 102, 241, 0.2);
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Inter', -apple-system, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        .bg-animation {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            z-index: -1;
            overflow: hidden;
        }
        
        .bg-animation::before {
            content: '';
            position: absolute;
            width: 150%; height: 150%;
            top: -25%; left: -25%;
            background: radial-gradient(circle at 20% 80%, var(--primary) 0%, transparent 25%),
                        radial-gradient(circle at 80% 20%, var(--accent) 0%, transparent 25%),
                        radial-gradient(circle at 40% 40%, var(--info) 0%, transparent 20%);
            opacity: 0.07;
            animation: bgMove 20s ease-in-out infinite;
        }
        
        @keyframes bgMove {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            33% { transform: translate(30px, -30px) rotate(5deg); }
            66% { transform: translate(-20px, 20px) rotate(-5deg); }
        }
        
        @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-5px); } }
        @keyframes pulse { 0%, 100% { opacity: 1; transform: scale(1); } 50% { opacity: 0.8; transform: scale(1.05); } }
        @keyframes glow { 0%, 100% { opacity: 1; } 50% { opacity: 0.6; } }
        @keyframes fadeSlide { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes shimmer { 0% { transform: translateX(-100%) rotate(45deg); } 100% { transform: translateX(100%) rotate(45deg); } }
        @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-5px); } }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes slideUp { from { opacity: 0; transform: translateY(50px) scale(0.95); } to { opacity: 1; transform: translateY(0) scale(1); } }
        
        .dashboard { display: flex; min-height: 100vh; }
        
        /* Sidebar */
        .sidebar {
            width: 240px;
            background: var(--bg-card);
            backdrop-filter: blur(20px);
            border-right: 1px solid var(--border);
            padding: 20px 12px;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            z-index: 100;
            display: flex;
            flex-direction: column;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 14px;
            padding: 20px;
            margin-bottom: 32px;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            border-radius: 20px;
            position: relative;
            overflow: hidden;
        }
        
        .logo::before {
            content: '';
            position: absolute;
            top: -50%; left: -50%;
            width: 200%; height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);
            animation: shimmer 3s infinite;
        }
        
        .logo-icon {
            width: 48px; height: 48px;
            background: rgba(255,255,255,0.2);
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }
        
        .logo-text { color: white; }
        .logo-title { font-size: 14px; font-weight: 700; letter-spacing: 0.5px; }
        .logo-sub { font-size: 11px; opacity: 0.8; margin-top: 2px; }
        
        .nav-section { margin-bottom: 24px; }
        .nav-label {
            font-size: 10px;
            font-weight: 600;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 1.5px;
            padding: 0 16px;
            margin-bottom: 12px;
        }
        
        .nav-item {
            display: flex;
            align-items: center;
            gap: 14px;
            padding: 14px 16px;
            border-radius: 14px;
            cursor: pointer;
            color: var(--text-secondary);
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            margin-bottom: 4px;
        }
        
        .nav-item::before {
            content: '';
            position: absolute;
            left: 0; top: 0;
            width: 4px; height: 100%;
            background: linear-gradient(180deg, var(--primary), var(--accent));
            border-radius: 0 4px 4px 0;
            transform: scaleY(0);
            transition: transform 0.3s ease;
        }
        
        .nav-item:hover {
            background: var(--bg-glass);
            color: var(--text-primary);
            transform: translateX(4px);
        }
        
        .nav-item.active {
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.15), rgba(244, 114, 182, 0.1));
            color: var(--primary-light);
            box-shadow: 0 4px 20px var(--glow);
        }
        
        .nav-item.active::before { transform: scaleY(1); }
        
        .nav-icon {
            width: 36px; height: 36px;
            background: var(--bg-glass);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            transition: all 0.3s ease;
        }
        
        .nav-item.active .nav-icon {
            background: linear-gradient(135deg, var(--primary), var(--accent));
            box-shadow: 0 4px 15px var(--glow);
        }
        
        .nav-badge {
            margin-left: auto;
            padding: 4px 10px;
            background: linear-gradient(135deg, var(--danger), #f97316);
            border-radius: 20px;
            font-size: 10px;
            font-weight: 700;
            color: white;
            animation: pulse 2s infinite;
        }
        
        .theme-toggle {
            display: flex;
            gap: 8px;
            padding: 8px;
            background: var(--bg-glass);
            border-radius: 16px;
            margin-top: auto;
        }
        
        .theme-btn {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 600;
            background: transparent;
            color: var(--text-secondary);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .theme-btn.active {
            background: linear-gradient(135deg, var(--primary), var(--primary));
            color: white;
            box-shadow: 0 4px 15px var(--glow);
        }
        
        .main {
            flex: 1;
            margin-left: 240px;
            padding: 24px;
            min-height: 100vh;
        }
        
        .section { display: none; animation: fadeSlide 0.5s ease; }
        .section.active { display: block; }
        
        .page-header { margin-bottom: 20px; }
        
        .page-title {
            font-size: 28px;
            font-weight: 800;
            background: linear-gradient(135deg, var(--text-primary), var(--primary-light));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 16px;
        }
        
        .page-title span { font-size: 36px; -webkit-text-fill-color: initial; }
        .page-subtitle { color: var(--text-secondary); font-size: 15px; }
        
        /* Alert Banner */
        .alert-banner {
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.1), rgba(249, 115, 22, 0.1));
            border: 1px solid rgba(239, 68, 68, 0.3);
            border-radius: 16px;
            padding: 16px 20px;
            margin-bottom: 24px;
            position: relative;
            overflow: hidden;
        }
        
        .alert-banner::before {
            content: '';
            position: absolute;
            left: 0; top: 0;
            width: 6px; height: 100%;
            background: linear-gradient(180deg, var(--danger), var(--warning));
            border-radius: 20px 0 0 20px;
        }
        
        .alert-banner .alert-icon { font-size: 28px; margin-bottom: 12px; animation: bounce 1s infinite; }
        .alert-banner h4 { font-size: 16px; font-weight: 700; color: var(--danger); margin-bottom: 8px; }
        .alert-banner p { color: var(--text-secondary); font-size: 14px; line-height: 1.6; }
        .alert-banner strong { color: var(--text-primary); }
        
        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 16px;
            margin-bottom: 24px;
        }
        
        .stat-card {
            background: var(--bg-card);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 20px;
            position: relative;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .stat-card::before {
            content: '';
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: linear-gradient(135deg, transparent 40%, rgba(255,255,255,0.05));
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5), 0 0 40px var(--glow);
            border-color: var(--primary);
        }
        
        .stat-card:hover::before { opacity: 1; }
        
        .stat-card.danger { border-color: rgba(239, 68, 68, 0.3); }
        .stat-card.danger:hover { box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5), 0 0 40px rgba(239, 68, 68, 0.3); border-color: var(--danger); }
        
        .stat-icon {
            width: 48px; height: 48px;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            margin-bottom: 16px;
            box-shadow: 0 8px 25px var(--glow);
            animation: float 3s ease-in-out infinite;
        }
        
        .stat-card.danger .stat-icon {
            background: linear-gradient(135deg, var(--danger), var(--warning));
            box-shadow: 0 8px 25px rgba(239, 68, 68, 0.3);
        }
        
        .stat-label { font-size: 11px; font-weight: 600; color: var(--text-muted); text-transform: uppercase; letter-spacing: 1px; margin-bottom: 6px; }
        
        .stat-value {
            font-size: 28px;
            font-weight: 800;
            font-family: 'JetBrains Mono', monospace;
            background: linear-gradient(135deg, var(--text-primary), var(--primary-light));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 6px;
        }
        
        .stat-card.danger .stat-value { background: linear-gradient(135deg, var(--danger), var(--warning)); -webkit-background-clip: text; }
        .stat-change { font-size: 13px; color: var(--text-secondary); }
        
        .grid-2 { display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; margin-bottom: 24px; }
        .grid-3 { display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; margin-bottom: 24px; }
        
        /* Chart Card */
        .chart-card {
            background: var(--bg-card);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 20px;
            transition: all 0.3s ease;
        }
        
        .chart-card:hover { border-color: rgba(99, 102, 241, 0.3); box-shadow: 0 10px 40px var(--glow); }
        .chart-card h3 { font-size: 16px; font-weight: 700; margin-bottom: 20px; display: flex; align-items: center; gap: 12px; }
        .chart-card h3 span { font-size: 22px; }
        .chart-container { position: relative; height: 280px; min-width: 0; }
        
        /* Table Card */
        .table-card {
            background: var(--bg-card);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border);
            border-radius: 24px;
            padding: 28px;
            margin-bottom: 32px;
            transition: all 0.3s ease;
        }
        
        .table-card:hover { border-color: rgba(99, 102, 241, 0.3); }
        .table-card h3 { font-size: 18px; font-weight: 700; margin-bottom: 24px; display: flex; align-items: center; gap: 12px; }
        .table-card h3 span { font-size: 24px; }
        .table-hint { font-size: 12px; font-weight: 400; color: var(--text-muted); margin-left: auto; }
        
        table { width: 100%; border-collapse: separate; border-spacing: 0 8px; }
        th { text-align: left; padding: 12px 16px; font-size: 11px; font-weight: 600; color: var(--text-muted); text-transform: uppercase; letter-spacing: 1px; }
        
        td {
            padding: 16px;
            font-size: 14px;
            background: var(--bg-glass);
            border-top: 1px solid var(--border);
            border-bottom: 1px solid var(--border);
            transition: all 0.3s ease;
        }
        
        td:first-child { border-left: 1px solid var(--border); border-radius: 12px 0 0 12px; }
        td:last-child { border-right: 1px solid var(--border); border-radius: 0 12px 12px 0; }
        
        tr { cursor: pointer; transition: all 0.3s ease; }
        tr:hover td { background: rgba(99, 102, 241, 0.08); border-color: rgba(99, 102, 241, 0.2); }
        
        .num { text-align: right; font-family: 'JetBrains Mono', monospace; font-weight: 600; }
        
        /* Badge */
        .badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            white-space: nowrap;
        }
        
        .badge.critical { background: linear-gradient(135deg, rgba(124, 58, 237, 0.2), rgba(139, 92, 246, 0.1)); color: #a78bfa; border: 1px solid rgba(139, 92, 246, 0.3); }
        .badge.danger { background: linear-gradient(135deg, rgba(239, 68, 68, 0.2), rgba(249, 115, 22, 0.1)); color: #f87171; border: 1px solid rgba(239, 68, 68, 0.3); }
        .badge.warning { background: linear-gradient(135deg, rgba(245, 158, 11, 0.2), rgba(251, 191, 36, 0.1)); color: #fbbf24; border: 1px solid rgba(245, 158, 11, 0.3); }
        .badge.success { background: linear-gradient(135deg, rgba(16, 185, 129, 0.2), rgba(52, 211, 153, 0.1)); color: #34d399; border: 1px solid rgba(16, 185, 129, 0.3); }
        .badge.info { background: linear-gradient(135deg, rgba(59, 130, 246, 0.2), rgba(96, 165, 250, 0.1)); color: #60a5fa; border: 1px solid rgba(59, 130, 246, 0.3); }
        
        /* NPL Indicator */
        .npl-indicator { display: flex; align-items: center; gap: 10px; }
        .npl-dot { width: 10px; height: 10px; border-radius: 50%; animation: glow 2s infinite; }
        .npl-dot.good { background: var(--success); box-shadow: 0 0 10px var(--success); }
        .npl-dot.bad { background: var(--danger); box-shadow: 0 0 10px var(--danger); }
        
        /* Modal */
        .modal-overlay {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(8px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 20px;
        }
        
        .modal-overlay.active { display: flex; animation: fadeIn 0.3s ease; }
        
        .modal {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 28px;
            width: 100%;
            max-width: 750px;
            max-height: 85vh;
            overflow: hidden;
            box-shadow: 0 25px 100px rgba(0, 0, 0, 0.5);
            animation: slideUp 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .modal-header { padding: 28px; background: linear-gradient(135deg, var(--primary), var(--accent)); position: relative; }
        .modal-header::after { content: ''; position: absolute; bottom: 0; left: 0; right: 0; height: 50px; background: linear-gradient(180deg, transparent, var(--bg-secondary)); }
        .modal-title-row { display: flex; align-items: center; gap: 16px; }
        .modal-icon { width: 60px; height: 60px; background: rgba(255, 255, 255, 0.2); border-radius: 18px; display: flex; align-items: center; justify-content: center; font-size: 32px; }
        .modal-title { font-size: 24px; font-weight: 800; color: white; }
        
        .modal-close {
            position: absolute;
            top: 20px; right: 20px;
            width: 40px; height: 40px;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: 12px;
            color: white;
            font-size: 24px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }
        
        .modal-close:hover { background: rgba(255, 255, 255, 0.2); transform: rotate(90deg); }
        
        .modal-body { padding: 28px; max-height: calc(85vh - 120px); overflow-y: auto; }
        .modal-stats { display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px; margin-bottom: 24px; }
        .modal-stat { background: var(--bg-glass); border: 1px solid var(--border); border-radius: 16px; padding: 16px; text-align: center; }
        .modal-stat-value { font-size: 24px; font-weight: 800; font-family: 'JetBrains Mono', monospace; margin-bottom: 4px; }
        .modal-stat-label { font-size: 11px; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.5px; }
        
        .modal-section { background: var(--bg-glass); border: 1px solid var(--border); border-radius: 16px; padding: 20px; margin-bottom: 16px; }
        .modal-section.danger { background: linear-gradient(135deg, rgba(239, 68, 68, 0.1), rgba(249, 115, 22, 0.05)); border-color: rgba(239, 68, 68, 0.3); }
        .modal-section.success { background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(52, 211, 153, 0.05)); border-color: rgba(16, 185, 129, 0.3); }
        .modal-section h5 { font-size: 14px; font-weight: 700; margin-bottom: 12px; display: flex; align-items: center; gap: 8px; }
        .modal-section p { font-size: 13px; color: var(--text-secondary); line-height: 1.7; }
        
        /* Loans Grid */
        .loans-grid { display: grid; gap: 12px; }
        
        .loan-card {
            background: var(--bg-glass);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 16px;
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr auto;
            gap: 16px;
            align-items: center;
            transition: all 0.3s ease;
        }
        
        .loan-card:hover { border-color: var(--primary); background: rgba(99, 102, 241, 0.05); }
        .loan-card.is95413 { background: linear-gradient(135deg, rgba(239, 68, 68, 0.08), rgba(249, 115, 22, 0.05)); border-color: rgba(239, 68, 68, 0.3); }
        .loan-bank { font-weight: 600; font-size: 14px; }
        .loan-branch { font-size: 11px; color: var(--text-muted); margin-top: 4px; }
        .loan-amount { font-family: 'JetBrains Mono', monospace; font-weight: 700; font-size: 16px; }
        
        .text-red { color: var(--danger); }
        .text-green { color: var(--success); }
        .text-yellow { color: var(--warning); }
        .text-blue { color: var(--info); }
        .text-purple { color: var(--primary-light); }
        .text-cyan { color: var(--cyan); }
        
        /* Bank Selector */
        .bank-selector {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 16px;
        }
        
        .bank-btn {
            padding: 6px 12px;
            border: 1px solid var(--border);
            border-radius: 20px;
            background: var(--bg-glass);
            color: var(--text-secondary);
            font-size: 11px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .bank-btn:hover {
            border-color: var(--primary);
            color: var(--primary);
        }
        
        .bank-btn.active {
            background: linear-gradient(135deg, var(--primary), var(--accent));
            border-color: transparent;
            color: white;
        }
        
        /* Recommendations */
        .rec-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
            margin-top: 16px;
        }
        
        .rec-card {
            background: var(--bg-glass);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 16px;
        }
        
        .rec-card h4 {
            font-size: 13px;
            font-weight: 700;
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--border);
        }
        
        .rec-card.critical { border-left: 4px solid var(--danger); }
        .rec-card.critical h4 { color: var(--danger); }
        .rec-card.strategic { border-left: 4px solid var(--success); }
        .rec-card.strategic h4 { color: var(--success); }
        .rec-card.regional { border-left: 4px solid var(--info); }
        .rec-card.regional h4 { color: var(--info); }
        
        .rec-card ul {
            list-style: none;
            font-size: 12px;
            color: var(--text-secondary);
            line-height: 1.8;
        }
        
        .rec-card li {
            padding: 6px 0;
            border-bottom: 1px dashed var(--border);
        }
        
        .rec-card li:last-child { border-bottom: none; }
        
        .bank-selector-large {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .bank-btn-large {
            padding: 10px 16px;
            border: 2px solid var(--border);
            border-radius: 12px;
            background: var(--bg-glass);
            color: var(--text-secondary);
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .bank-btn-large:hover {
            border-color: var(--primary);
            color: var(--primary);
            transform: translateY(-2px);
        }
        
        .bank-btn-large.active {
            background: linear-gradient(135deg, var(--primary), var(--accent));
            border-color: transparent;
            color: white;
            box-shadow: 0 4px 15px var(--glow);
        }
        
        .bank-btn-large .risk-badge {
            font-size: 9px;
            padding: 2px 6px;
            border-radius: 10px;
            font-weight: 700;
        }
        
        .risk-badge.kritik { background: var(--danger); color: white; }
        .risk-badge.yuqori { background: var(--warning); color: #000; }
        .risk-badge.orta { background: var(--info); color: white; }
        .risk-badge.past { background: var(--success); color: white; }
        .risk-badge.minimal { background: var(--cyan); color: white; }
        
        .bank-detail-card {
            background: var(--bg-glass);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 20px;
            margin-top: 16px;
        }
        
        .bank-detail-header {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 20px;
            padding-bottom: 16px;
            border-bottom: 1px solid var(--border);
        }
        
        .bank-detail-header h4 {
            font-size: 18px;
            font-weight: 700;
        }
        
        .bank-detail-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
        }
        
        .bank-detail-section {
            background: var(--bg-primary);
            border-radius: 12px;
            padding: 16px;
        }
        
        .bank-detail-section h5 {
            font-size: 12px;
            font-weight: 700;
            color: var(--text-muted);
            text-transform: uppercase;
            margin-bottom: 12px;
        }
        
        .bank-detail-section ul {
            list-style: none;
            font-size: 12px;
            color: var(--text-secondary);
        }
        
        .bank-detail-section li {
            padding: 6px 0;
            display: flex;
            align-items: flex-start;
            gap: 8px;
        }
        
        .sector-recs {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
        }
        
        .sector-rec-card {
            background: var(--bg-glass);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 16px;
            text-align: center;
        }
        
        .sector-rec-card.safe { border-color: rgba(16, 185, 129, 0.5); background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), transparent); }
        .sector-rec-card.risky { border-color: rgba(245, 158, 11, 0.5); background: linear-gradient(135deg, rgba(245, 158, 11, 0.1), transparent); }
        .sector-rec-card.avoid { border-color: rgba(239, 68, 68, 0.5); background: linear-gradient(135deg, rgba(239, 68, 68, 0.1), transparent); }
        
        .sector-rec-card h5 {
            font-size: 14px;
            font-weight: 700;
            margin-bottom: 12px;
        }
        
        .sector-rec-card.safe h5 { color: var(--success); }
        .sector-rec-card.risky h5 { color: var(--warning); }
        .sector-rec-card.avoid h5 { color: var(--danger); }
        
        .sector-rec-card ul {
            list-style: none;
            font-size: 11px;
            color: var(--text-secondary);
            text-align: left;
        }
        
        .sector-rec-card li { padding: 4px 0; }
        
        /* Branch Selector */
        .branch-selector {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            max-height: 150px;
            overflow-y: auto;
            padding: 10px;
            background: var(--bg-glass);
            border-radius: 12px;
        }
        
        .branch-btn {
            padding: 6px 12px;
            border: 1px solid var(--border);
            border-radius: 16px;
            background: var(--bg-primary);
            color: var(--text-secondary);
            font-size: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
        }
        
        .branch-btn:hover {
            border-color: var(--primary);
            color: var(--primary);
        }
        
        .branch-btn.active {
            background: linear-gradient(135deg, var(--primary), var(--accent));
            border-color: transparent;
            color: white;
        }
        
        .branch-btn.good { border-color: rgba(16, 185, 129, 0.5); }
        .branch-btn.bad { border-color: rgba(239, 68, 68, 0.5); }
        
        .branch-compare-item {
            background: var(--bg-glass);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 14px;
            margin-bottom: 12px;
        }
        
        .branch-compare-item h5 {
            font-size: 13px;
            font-weight: 700;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .branch-compare-item .stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            font-size: 11px;
        }
        
        .branch-compare-item .stat {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            background: var(--bg-primary);
            padding: 10px 6px;
            border-radius: 8px;
            overflow-wrap: break-word;
            word-break: break-word;
            min-width: 0;
        }
        
        .branch-compare-item .stat-label {
            font-size: 9px;
            color: var(--text-muted);
            text-transform: uppercase;
            margin-bottom: 4px;
        }
        
        .branch-compare-item .stat-value {
            font-size: 15px;
            font-weight: 700;
            white-space: nowrap;
        }
        
        /* Client Type Tabs */
        .client-type-tabs {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
        }
        
        .client-tab {
            padding: 12px 24px;
            border: 2px solid var(--border);
            border-radius: 12px;
            background: var(--bg-glass);
            color: var(--text-secondary);
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .client-tab:hover {
            border-color: var(--primary);
            color: var(--primary);
            transform: translateY(-2px);
        }
        
        .client-tab.active {
            background: linear-gradient(135deg, var(--primary), var(--accent));
            border-color: transparent;
            color: white;
            box-shadow: 0 4px 15px var(--glow);
        }
        
        .client-section {
            display: block;
        }
        
        .client-section.hidden {
            display: none;
        }
        
        @media (max-width: 1200px) {
            .rec-grid, .sector-recs { grid-template-columns: 1fr; }
            .bank-detail-grid { grid-template-columns: 1fr; }
        }
        
        /* Risk Matrix */
        .risk-matrix {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 8px;
            margin-top: 16px;
        }
        
        .risk-cell {
            aspect-ratio: 1;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            font-size: 11px;
            font-weight: 600;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .risk-cell:hover { transform: scale(1.1); }
        .risk-cell span { font-size: 16px; margin-bottom: 4px; }
        
        .risk-low { background: linear-gradient(135deg, rgba(16, 185, 129, 0.3), rgba(52, 211, 153, 0.2)); color: #34d399; }
        .risk-medium { background: linear-gradient(135deg, rgba(245, 158, 11, 0.3), rgba(251, 191, 36, 0.2)); color: #fbbf24; }
        .risk-high { background: linear-gradient(135deg, rgba(239, 68, 68, 0.3), rgba(249, 115, 22, 0.2)); color: #f87171; }
        .risk-critical { background: linear-gradient(135deg, rgba(124, 58, 237, 0.3), rgba(139, 92, 246, 0.2)); color: #a78bfa; }
        
        /* Progress Bar */
        .progress-bar {
            width: 100%;
            height: 8px;
            background: var(--bg-glass);
            border-radius: 4px;
            overflow: hidden;
            margin-top: 8px;
        }
        
        .progress-fill {
            height: 100%;
            border-radius: 4px;
            transition: width 1s ease;
        }
        
        @media (max-width: 1400px) { .stats-grid { grid-template-columns: repeat(2, 1fr); } .modal-stats { grid-template-columns: repeat(2, 1fr); } }
        @media (max-width: 1200px) { .grid-2, .grid-3 { grid-template-columns: 1fr; } }
        @media (max-width: 1024px) { .sidebar { width: 70px; padding: 12px 6px; } .logo-text, .nav-label, .nav-item span, .nav-badge { display: none; } .nav-item { justify-content: center; padding: 12px; } .main { margin-left: 70px; padding: 16px; } }
        
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: var(--bg-glass); }
        ::-webkit-scrollbar-thumb { background: var(--border); border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: var(--primary); }
    </style>
</head>
<body data-theme="dark">
    <div class="bg-animation"></div>
    
    <div class="dashboard">
        <aside class="sidebar">
            <div class="logo">
                <div class="logo-icon">üìä</div>
                <div class="logo-text">
                    <div class="logo-title">RISK DASHBOARD</div>
                    <div class="logo-sub">Toshkent viloyati 2026</div>
                </div>
            </div>
            
            <nav>
                <div class="nav-section">
                    <div class="nav-label">Asosiy</div>
                    <div class="nav-item active" onclick="showSection('overview')"><div class="nav-icon">üìà</div><span>Umumiy</span></div>
                    <div class="nav-item" onclick="showSection('analytics')"><div class="nav-icon">üìâ</div><span>Analitika</span></div>
                </div>
                <div class="nav-section">
                    <div class="nav-label">Tahlil</div>
                    <div class="nav-item" onclick="showSection('banks')"><div class="nav-icon">üè¶</div><span>Banklar</span><span class="nav-badge">18</span></div>
                    <div class="nav-item" onclick="showSection('branches')"><div class="nav-icon">üè¢</div><span>Filiallar</span><span class="nav-badge">70+</span></div>
                    <div class="nav-item" onclick="showSection('sectors')"><div class="nav-icon">üè≠</div><span>Sohalar</span></div>
                    <div class="nav-item" onclick="showSection('regions')"><div class="nav-icon">üó∫Ô∏è</div><span>Hududlar</span></div>
                </div>
                <div class="nav-section">
                    <div class="nav-label">Monitoring</div>
                    <div class="nav-item" onclick="showSection('npl95413')"><div class="nav-icon">üö®</div><span>95413</span><span class="nav-badge">8.6K</span></div>
                    <div class="nav-item" onclick="showSection('clients')"><div class="nav-icon">üë•</div><span>Mijozlar</span></div>
                    <div class="nav-item" onclick="showSection('recommendations')"><div class="nav-icon">üí°</div><span>Tavsiyalar</span><span class="nav-badge" style="background:linear-gradient(135deg,#10b981,#06b6d4)">NEW</span></div>
                    <div class="nav-item" onclick="showSection('riskmap')"><div class="nav-icon">üéØ</div><span>Risk xaritasi</span></div>
                </div>
            </nav>
            
            <div class="theme-toggle">
                <button class="theme-btn" onclick="setTheme('light')">‚òÄÔ∏è</button>
                <button class="theme-btn active" onclick="setTheme('dark')">üåô</button>
            </div>
        </aside>
        
        <main class="main">
            <!-- OVERVIEW SECTION -->
            <section class="section active" id="overview">
                <div class="page-header">
                    <h1 class="page-title"><span>üìä</span> Risk Dashboard</h1>
                    <p class="page-subtitle">Toshkent viloyati kredit portfeli real vaqt tahlili ‚Ä¢ 2026-yil</p>
                </div>
                
                <div class="alert-banner">
                    <div class="alert-icon">üö®</div>
                    <h4>DIQQAT: 95413 - Yashirilgan NPL muammosi</h4>
                    <p><strong>8,614 mijoz</strong> va <strong>1.0 trillion so'm</strong> NPL. <strong>Rasmiy NPL: 3.62%</strong> ‚Üí <strong>Muammoli: ~5.5%</strong></p>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card"><div class="stat-icon">üë•</div><div class="stat-label">Jami mijozlar</div><div class="stat-value">276,711</div><div class="stat-change">Samarali: 215,093 (77.7%)</div></div>
                    <div class="stat-card"><div class="stat-icon">üìã</div><div class="stat-label">Kreditlar</div><div class="stat-value">276,711</div><div class="stat-change">18 bank, 94 filial</div></div>
                    <div class="stat-card"><div class="stat-icon">üí∞</div><div class="stat-label">Portfel</div><div class="stat-value">27.6T</div><div class="stat-change">Samarali: 19.0T (69%)</div></div>
                    <div class="stat-card danger"><div class="stat-icon">‚ö†Ô∏è</div><div class="stat-label">NPL</div><div class="stat-value">3.62%</div><div class="stat-change">Haqiqiy: ~5.5%</div></div>
                </div>
                
                <div class="grid-2">
                    <div class="chart-card"><h3><span>üìä</span> Kredit sifati taqsimoti</h3><div class="chart-container"><canvas id="chart1"></canvas></div></div>
                    <div class="chart-card"><h3><span>üè¶</span> Banklar bo'yicha NPL</h3><div class="chart-container"><canvas id="chart2"></canvas></div></div>
                </div>
                
                <div class="grid-2">
                    <div class="chart-card"><h3><span>üìà</span> Oylik NPL trend</h3><div class="chart-container"><canvas id="chartTrend"></canvas></div></div>
                    <div class="chart-card"><h3><span>üíº</span> Kredit turlari</h3><div class="chart-container" style="height:350px"><canvas id="chartLoanTypes"></canvas></div></div>
                </div>
                
                <div class="chart-card" style="margin-bottom:32px"><h3><span>üó∫Ô∏è</span> Hududlar bo'yicha NPL</h3><div class="chart-container"><canvas id="chartRegions"></canvas></div></div>
            </section>
            
            <!-- ANALYTICS SECTION -->
            <section class="section" id="analytics">
                <div class="page-header">
                    <h1 class="page-title"><span>üìâ</span> Kengaytirilgan analitika</h1>
                    <p class="page-subtitle">Chuqur tahlil va trend ko'rsatkichlari</p>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card"><div class="stat-icon">üìä</div><div class="stat-label">O'rtacha kredit</div><div class="stat-value">99.7M</div><div class="stat-change">Har bir mijozga</div></div>
                    <div class="stat-card"><div class="stat-icon">‚è±Ô∏è</div><div class="stat-label">O'rtacha muddat</div><div class="stat-value">36 oy</div><div class="stat-change">Kredit muddati</div></div>
                    <div class="stat-card"><div class="stat-icon">üìà</div><div class="stat-label">Portfel o'sishi</div><div class="stat-value">+12.3%</div><div class="stat-change">Yillik</div></div>
                    <div class="stat-card danger"><div class="stat-icon">üìâ</div><div class="stat-label">NPL o'sishi</div><div class="stat-value">+1.2%</div><div class="stat-change">Oxirgi chorak</div></div>
                </div>
                
                <div class="grid-2">
                    <div class="chart-card"><h3><span>üìà</span> Portfel va NPL dinamikasi</h3><div class="chart-container"><canvas id="chartGrowth"></canvas></div></div>
                    <div class="chart-card"><h3><span>üîÑ</span> NPL o'zgarish dinamikasi</h3><div class="chart-container"><canvas id="chartNPLChange"></canvas></div></div>
                </div>
                
                <div class="grid-2">
                    <div class="chart-card">
                        <h3><span>üéØ</span> Bank samaradorligi solishtiruvi</h3>
                        <div class="bank-selector" id="bankSelector"></div>
                        <div class="chart-container" style="height:320px"><canvas id="chartEfficiency"></canvas></div>
                        <div id="bankMetricsInfo" style="margin-top:12px; padding:10px; background:var(--bg-secondary); border-radius:8px; font-size:11px;">
                            <div style="display:grid; grid-template-columns:repeat(6,1fr); gap:8px; text-align:center;">
                                <div style="font-weight:600; color:var(--text-muted);">Bank</div>
                                <div style="font-weight:600; color:var(--text-muted);">NPL %</div>
                                <div style="font-weight:600; color:var(--text-muted);">Portfel</div>
                                <div style="font-weight:600; color:var(--text-muted);">Mijozlar</div>
                                <div style="font-weight:600; color:var(--text-muted);">Filiallar</div>
                                <div style="font-weight:600; color:var(--text-muted);">Samaradorlik</div>
                            </div>
                            <div id="selectedBanksMetrics"></div>
                        </div>
                    </div>
                    <div class="chart-card"><h3><span>üíπ</span> Soha bo'yicha portfel</h3><div class="chart-container"><canvas id="chartSectorPortfolio"></canvas></div></div>
                </div>
            </section>
            
            <!-- BANKS SECTION -->
            <section class="section" id="banks">
                <div class="page-header">
                    <h1 class="page-title"><span>üè¶</span> Banklar tahlili</h1>
                    <p class="page-subtitle">Barcha banklar bo'yicha NPL ko'rsatkichlari</p>
                </div>
                
                <div class="grid-2">
                    <div class="chart-card"><h3><span>üìä</span> NPL reytingi</h3><div class="chart-container"><canvas id="chart3"></canvas></div></div>
                    <div class="chart-card"><h3><span>üí∞</span> Portfel hajmi (trln)</h3><div class="chart-container"><canvas id="chart4"></canvas></div></div>
                </div>
                
                <div class="table-card">
                    <h3><span>üè¶</span> Barcha banklar <span class="table-hint">üí° Ustiga bosing - batafsil</span></h3>
                    <table>
                        <thead><tr><th>Bank</th><th class="num">Kreditlar</th><th class="num">Portfel</th><th class="num">NPL %</th><th class="num">95413</th><th class="num">Haqiqiy NPL</th><th>Holat</th></tr></thead>
                        <tbody id="banksTable"></tbody>
                    </table>
                </div>
            </section>
            
            <!-- BRANCHES SECTION -->
            <section class="section" id="branches">
                <div class="page-header">
                    <h1 class="page-title"><span>üè¢</span> Bank filiallari tahlili</h1>
                    <p class="page-subtitle">Barcha bank filiallari bo'yicha batafsil NPL va samaradorlik ko'rsatkichlari</p>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card"><div class="stat-icon">üè¢</div><div class="stat-label">Jami filiallar</div><div class="stat-value">70+</div><div class="stat-change">14 bank</div></div>
                    <div class="stat-card"><div class="stat-icon">üë•</div><div class="stat-label">Jami xodimlar</div><div class="stat-value">1,842</div><div class="stat-change">Barcha filiallarda</div></div>
                    <div class="stat-card"><div class="stat-icon">‚úÖ</div><div class="stat-label">Samarali filiallar</div><div class="stat-value">48</div><div class="stat-change">NPL < 5%</div></div>
                    <div class="stat-card danger"><div class="stat-icon">‚ö†Ô∏è</div><div class="stat-label">Muammoli filiallar</div><div class="stat-value">22</div><div class="stat-change">NPL > 5%</div></div>
                </div>
                
                <!-- Bank filter -->
                <div class="table-card">
                    <h3><span>üîç</span> Bank bo'yicha filtrlash</h3>
                    <div class="bank-selector-large" id="branchBankFilter"></div>
                </div>
                
                <!-- Branches table -->
                <div class="table-card">
                    <h3><span>üè¢</span> Filiallar ro'yxati <span class="table-hint">üí° Samaradorlik va NPL bo'yicha tavsiyalar</span></h3>
                    <table>
                        <thead>
                            <tr>
                                <th>Bank</th>
                                <th>Filial</th>
                                <th class="num">Kreditlar</th>
                                <th class="num">Portfel (trln)</th>
                                <th class="num">NPL %</th>
                                <th class="num">95413</th>
                                <th class="num">Xodimlar</th>
                                <th class="num">Samaradorlik</th>
                                <th>Tavsiya</th>
                            </tr>
                        </thead>
                        <tbody id="branchesTable"></tbody>
                    </table>
                </div>
                
                <!-- Branch performance chart -->
                <div class="grid-2">
                    <div class="chart-card">
                        <h3><span>üìä</span> Eng samarali filiallar (TOP 10)</h3>
                        <div class="chart-container" style="height:350px"><canvas id="chartTopBranches"></canvas></div>
                    </div>
                    <div class="chart-card">
                        <h3><span>‚ö†Ô∏è</span> Eng muammoli filiallar (TOP 10)</h3>
                        <div class="chart-container" style="height:350px"><canvas id="chartWorstBranches"></canvas></div>
                    </div>
                </div>
                
                <!-- Branch comparison radar -->
                <div class="table-card" style="background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(244, 114, 182, 0.05)); border-color: rgba(99, 102, 241, 0.3);">
                    <h3><span>üéØ</span> Filiallar samaradorligi solishtiruvi <span class="table-hint">üí° 5 tagacha filial tanlang</span></h3>
                    <div class="branch-selector" id="branchRadarSelector"></div>
                    <div style="display:grid; grid-template-columns: 45% 55%; gap:20px; margin-top:20px">
                        <div class="chart-container" style="height:400px"><canvas id="chartBranchRadar"></canvas></div>
                        <div id="branchCompareInfo" style="max-height:400px; overflow-y:auto; overflow-x:visible; padding:10px"></div>
                    </div>
                </div>
            </section>
            
            <!-- SECTORS SECTION -->
            <section class="section" id="sectors">
                <div class="page-header">
                    <h1 class="page-title"><span>üè≠</span> Sohalar tahlili</h1>
                    <p class="page-subtitle">Iqtisodiy sohalar bo'yicha kredit tahlili</p>
                </div>
                
                <div class="grid-2">
                    <div class="chart-card"><h3><span>üìä</span> Sohalar NPL</h3><div class="chart-container" style="height:350px"><canvas id="chartSectors"></canvas></div></div>
                    <div class="chart-card"><h3><span>üí∞</span> Sohalar portfeli</h3><div class="chart-container" style="height:350px"><canvas id="chartSectorsPie"></canvas></div></div>
                </div>
                
                <div class="table-card">
                    <h3><span>üè≠</span> Barcha sohalar</h3>
                    <table>
                        <thead><tr><th>Soha</th><th class="num">Kreditlar</th><th class="num">Portfel</th><th class="num">NPL %</th><th class="num">Sud %</th><th>Holat</th></tr></thead>
                        <tbody id="sectorsTable"></tbody>
                    </table>
                </div>
            </section>
            
            <!-- REGIONS SECTION -->
            <section class="section" id="regions">
                <div class="page-header">
                    <h1 class="page-title"><span>üó∫Ô∏è</span> Hududlar tahlili</h1>
                    <p class="page-subtitle">Toshkent viloyati tumanlari va shaharlari</p>
                </div>
                
                <div class="chart-card" style="margin-bottom:32px"><h3><span>üó∫Ô∏è</span> Hududlar bo'yicha NPL</h3><div class="chart-container" style="height:400px"><canvas id="chartRegionsFull"></canvas></div></div>
                
                <div class="table-card">
                    <h3><span>üó∫Ô∏è</span> Barcha hududlar</h3>
                    <table>
                        <thead><tr><th>Hudud</th><th class="num">Kreditlar</th><th class="num">Portfel</th><th class="num">Muammo %</th><th class="num">NPL %</th><th>Holat</th></tr></thead>
                        <tbody id="regionsTable"></tbody>
                    </table>
                </div>
            </section>
            
            <!-- 95413 SECTION -->
            <section class="section" id="npl95413">
                <div class="page-header">
                    <h1 class="page-title"><span>üö®</span> 95413 - Yashirilgan NPL</h1>
                    <p class="page-subtitle">Portfeldan olingan lekin qaytarilmagan kreditlar</p>
                </div>
                
                <div class="alert-banner">
                    <div class="alert-icon">‚õî</div>
                    <h4>95413 hisob = YASHIRISH, YECHIM EMAS!</h4>
                    <p>Kredit portfelidan olib tashlangan, lekin hali qaytarilmagan kreditlar. Bank uchun haqiqiy yo'qotish!</p>
                    <button onclick="speak95413Summary()" style="margin-top:10px;padding:8px 16px;background:linear-gradient(135deg,#ef4444,#f97316);border:none;border-radius:8px;color:white;cursor:pointer;font-weight:600">
                        üîä Ovozli tahlil
                    </button>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card danger"><div class="stat-icon">üë•</div><div class="stat-label">95413 mijozlar</div><div class="stat-value">8,614</div><div class="stat-change">Yashirilgan NPL</div></div>
                    <div class="stat-card danger"><div class="stat-icon">üí∞</div><div class="stat-label">Yashirilgan summa</div><div class="stat-value">1.6T</div><div class="stat-change">Portfeldan olingan</div></div>
                    <div class="stat-card"><div class="stat-icon">üìä</div><div class="stat-label">Rasmiy NPL</div><div class="stat-value">3.62%</div><div class="stat-change">Vaznli o'rtacha</div></div>
                    <div class="stat-card danger"><div class="stat-icon">üìà</div><div class="stat-label">Muammoli</div><div class="stat-value">~5.5%</div><div class="stat-change">Muammoli kreditlar</div></div>
                </div>
                
                <div class="grid-2">
                    <div class="chart-card"><h3><span>üìä</span> Rasmiy vs Haqiqiy NPL</h3><div class="chart-container"><canvas id="chart95413Compare"></canvas></div></div>
                    <div class="chart-card"><h3><span>üè¶</span> 95413 banklar bo'yicha</h3><div class="chart-container"><canvas id="chart95413Banks"></canvas></div></div>
                </div>
                
                <div class="grid-2">
                    <div class="chart-card"><h3><span>üè≠</span> 95413 sohalar bo'yicha</h3><div class="chart-container"><canvas id="chart95413Sectors"></canvas></div></div>
                    <div class="chart-card"><h3><span>üìà</span> 95413 oylik trend</h3><div class="chart-container"><canvas id="chart95413Trend"></canvas></div></div>
                </div>
                
                <!-- 95413 BANKLAR RO'YXATI -->
                <div class="chart-card" style="margin-top:20px">
                    <h3><span>üè¶</span> 95413 - Banklar bo'yicha batafsil</h3>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Bank</th>
                                    <th class="num">Jami kreditlar</th>
                                    <th class="num">95413 soni</th>
                                    <th class="num">95413 %</th>
                                    <th class="num">95413 summa (mlrd)</th>
                                    <th>Xavf darajasi</th>
                                </tr>
                            </thead>
                            <tbody id="table95413Banks"></tbody>
                        </table>
                    </div>
                </div>
                
                <!-- 95413 FILIALLAR RO'YXATI -->
                <div class="chart-card" style="margin-top:20px">
                    <h3><span>üè¢</span> 95413 - Eng muammoli filiallar (TOP 20)</h3>
                    <div class="table-container" style="max-height:400px; overflow-y:auto">
                        <table>
                            <thead>
                                <tr>
                                    <th>Bank</th>
                                    <th>Filial</th>
                                    <th class="num">Kreditlar</th>
                                    <th class="num">95413 soni</th>
                                    <th class="num">95413 %</th>
                                    <th>Holat</th>
                                </tr>
                            </thead>
                            <tbody id="table95413Branches"></tbody>
                        </table>
                    </div>
                </div>
                
                <!-- 95413 SOHALAR RO'YXATI -->
                <div class="chart-card" style="margin-top:20px">
                    <h3><span>üè≠</span> 95413 - Sohalar bo'yicha</h3>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Soha</th>
                                    <th class="num">Jami kreditlar</th>
                                    <th class="num">95413 soni</th>
                                    <th class="num">95413 %</th>
                                    <th class="num">Summa (mlrd)</th>
                                    <th>Trend</th>
                                </tr>
                            </thead>
                            <tbody id="table95413Sectors"></tbody>
                        </table>
                    </div>
                </div>
                
                <!-- 95413 MIJOZLAR RO'YXATI -->
                <div class="chart-card" style="margin-top:20px">
                    <h3><span>üë•</span> 95413 - Eng yirik muammoli mijozlar (TOP 30)</h3>
                    <p style="font-size:12px;color:var(--text-muted);margin-bottom:12px">Portfeldan olingan lekin qaytarilmagan eng katta qarzlar</p>
                    <div class="table-container" style="max-height:500px; overflow-y:auto">
                        <table>
                            <thead>
                                <tr>
                                    <th>Mijoz</th>
                                    <th>Turi</th>
                                    <th>Bank</th>
                                    <th>Filial</th>
                                    <th class="num">Qarz (mlrd)</th>
                                    <th>Soha</th>
                                    <th>Sabab</th>
                                    <th>Sana</th>
                                </tr>
                            </thead>
                            <tbody id="table95413Clients"></tbody>
                        </table>
                    </div>
                </div>
            </section>
            
            <!-- CLIENTS SECTION -->
            <section class="section" id="clients">
                <div class="page-header">
                    <h1 class="page-title"><span>üë•</span> Mijozlar tahlili</h1>
                    <p class="page-subtitle">Barcha mijozlar: Jismoniy shaxslar, Yuridik shaxslar va YaTT</p>
                </div>
                
                <!-- Umumiy statistika -->
                <div class="stats-grid">
                    <div class="stat-card"><div class="stat-icon">üë•</div><div class="stat-label">Jami mijozlar</div><div class="stat-value">241,852</div><div class="stat-change">100%</div></div>
                    <div class="stat-card" style="border-left:4px solid #3b82f6"><div class="stat-icon">üë§</div><div class="stat-label">Jismoniy shaxslar</div><div class="stat-value">187,234</div><div class="stat-change">77.4%</div></div>
                    <div class="stat-card" style="border-left:4px solid #8b5cf6"><div class="stat-icon">üè¢</div><div class="stat-label">Yuridik shaxslar</div><div class="stat-value">12,456</div><div class="stat-change">5.2%</div></div>
                    <div class="stat-card" style="border-left:4px solid #f59e0b"><div class="stat-icon">üßë‚Äçüíº</div><div class="stat-label">YaTT</div><div class="stat-value">42,162</div><div class="stat-change">17.4%</div></div>
                </div>
                
                <!-- Mijoz turi bo'yicha NPL -->
                <div class="stats-grid">
                    <div class="stat-card"><div class="stat-icon">üí∞</div><div class="stat-label">Jami portfel</div><div class="stat-value">27.6T</div><div class="stat-change">100%</div></div>
                    <div class="stat-card"><div class="stat-icon">üìä</div><div class="stat-label">Jismoniy NPL</div><div class="stat-value">3.2%</div><div class="stat-change text-green">Past risk</div></div>
                    <div class="stat-card danger"><div class="stat-icon">üìä</div><div class="stat-label">Yuridik NPL</div><div class="stat-value">8.7%</div><div class="stat-change text-red">Yuqori risk</div></div>
                    <div class="stat-card"><div class="stat-icon">üìä</div><div class="stat-label">YaTT NPL</div><div class="stat-value">5.4%</div><div class="stat-change text-yellow">O'rta risk</div></div>
                </div>
                
                <!-- Grafiklar -->
                <div class="grid-2">
                    <div class="chart-card">
                        <h3><span>üìä</span> Mijozlar taqsimoti</h3>
                        <div class="chart-container"><canvas id="chartClientTypes"></canvas></div>
                    </div>
                    <div class="chart-card">
                        <h3><span>üìà</span> Mijoz turi bo'yicha NPL</h3>
                        <div class="chart-container"><canvas id="chartClientNPL"></canvas></div>
                    </div>
                </div>
                
                <!-- Mijoz turi filter -->
                <div class="table-card">
                    <h3><span>üîç</span> Mijoz turini tanlang</h3>
                    <div class="client-type-tabs" id="clientTypeTabs">
                        <button class="client-tab active" onclick="filterClientType('ALL')">üìä Barchasi (241,852)</button>
                        <button class="client-tab" onclick="filterClientType('JIS')">üë§ Jismoniy (187,234)</button>
                        <button class="client-tab" onclick="filterClientType('YUR')">üè¢ Yuridik (12,456)</button>
                        <button class="client-tab" onclick="filterClientType('YATT')">üßë‚Äçüíº YaTT (42,162)</button>
                    </div>
                </div>
                
                <!-- JISMONIY SHAXSLAR -->
                <div class="table-card client-section" id="sectionJIS">
                    <h3><span>üë§</span> JISMONIY SHAXSLAR - Eng yirik qarzlar</h3>
                    <p style="color:var(--text-muted);font-size:12px;margin-bottom:16px">187,234 ta mijoz | 8.45 trln so'm portfel | NPL: 3.2%</p>
                    <table>
                        <thead><tr><th>F.I.O</th><th>Hudud</th><th class="num">Qarz (mln)</th><th>Bank</th><th>Kredit turi</th><th>Holat</th></tr></thead>
                        <tbody id="jismoniyTable"></tbody>
                    </table>
                </div>
                
                <!-- YURIDIK SHAXSLAR -->
                <div class="table-card client-section" id="sectionYUR">
                    <h3><span>üè¢</span> YURIDIK SHAXSLAR - Eng yirik kompaniyalar</h3>
                    <p style="color:var(--text-muted);font-size:12px;margin-bottom:16px">12,456 ta kompaniya | 14.87 trln so'm portfel | NPL: 8.7%</p>
                    <table>
                        <thead><tr><th>Kompaniya nomi</th><th>STIR</th><th class="num">Qarz (mlrd)</th><th>Banklar</th><th>Soha</th><th>Holat</th></tr></thead>
                        <tbody id="yuridikTable"></tbody>
                    </table>
                </div>
                
                <!-- YaTT -->
                <div class="table-card client-section" id="sectionYATT">
                    <h3><span>üßë‚Äçüíº</span> YAKKA TARTIBDAGI TADBIRKORLAR (YaTT)</h3>
                    <p style="color:var(--text-muted);font-size:12px;margin-bottom:16px">42,162 ta YaTT | 4.28 trln so'm portfel | NPL: 5.4%</p>
                    <table>
                        <thead><tr><th>YaTT nomi</th><th>Hudud</th><th class="num">Qarz (mln)</th><th>Bank</th><th>Faoliyat turi</th><th>Holat</th></tr></thead>
                        <tbody id="yattTable"></tbody>
                    </table>
                </div>
                
                <!-- Muammoli va Samarali -->
                <div class="grid-2">
                    <div class="table-card">
                        <h3><span>üî¥</span> TOP 20 Muammoli mijozlar <span class="table-hint">üí° Barcha turlar</span></h3>
                        <table>
                            <thead><tr><th>Mijoz</th><th>Turi</th><th class="num">Qarz</th><th>Bank</th><th>Holat</th></tr></thead>
                            <tbody id="problemClientsTable"></tbody>
                        </table>
                    </div>
                    <div class="table-card">
                        <h3><span>üü¢</span> TOP 20 Samarali mijozlar <span class="table-hint">üí° Barcha turlar</span></h3>
                        <table>
                            <thead><tr><th>Mijoz</th><th>Turi</th><th class="num">Kredit</th><th>Bank</th><th>Holat</th></tr></thead>
                            <tbody id="goodClientsTable"></tbody>
                        </table>
                    </div>
                </div>
            </section>
            
            <!-- RECOMMENDATIONS SECTION -->
            <section class="section" id="recommendations">
                <div class="page-header">
                    <h1 class="page-title"><span>üí°</span> Tavsiyalar markazi</h1>
                    <p class="page-subtitle">Toshkent viloyati, banklar va filiallar bo'yicha strategik tavsiyalar</p>
                </div>
                
                <!-- Viloyat umumiy tavsiyalar -->
                <div class="table-card" style="background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(244, 114, 182, 0.05)); border-color: rgba(99, 102, 241, 0.3);">
                    <h3><span>üèõÔ∏è</span> TOSHKENT VILOYATI - UMUMIY STRATEGIK TAVSIYALAR</h3>
                    <div class="rec-grid">
                        <div class="rec-card critical">
                            <h4>üî¥ ZUDLIK BILAN</h4>
                            <ul id="criticalRecs"></ul>
                        </div>
                        <div class="rec-card strategic">
                            <h4>üü¢ STRATEGIK YO'NALISHLAR</h4>
                            <ul id="strategicRecs"></ul>
                        </div>
                        <div class="rec-card regional">
                            <h4>üó∫Ô∏è HUDUDIY TAVSIYALAR</h4>
                            <ul id="regionalRecs"></ul>
                        </div>
                    </div>
                </div>
                
                <!-- Bank tanlash -->
                <div class="table-card">
                    <h3><span>üè¶</span> Bank bo'yicha tavsiyalar <span class="table-hint">üí° Bankni tanlang</span></h3>
                    <div class="bank-selector-large" id="bankRecSelector"></div>
                    <div id="bankRecContent"></div>
                </div>
                
                <!-- Filial tavsiyalari -->
                <div class="table-card">
                    <h3><span>üè¢</span> Filiallar bo'yicha tavsiyalar</h3>
                    <table>
                        <thead><tr><th>Filial</th><th>Risk</th><th class="num">NPL %</th><th>Harakat</th><th>Izoh</th></tr></thead>
                        <tbody id="branchRecsTable"></tbody>
                    </table>
                </div>
                
                <!-- Soha tavsiyalari -->
                <div class="table-card">
                    <h3><span>üè≠</span> Soha bo'yicha umumiy tavsiyalar</h3>
                    <div class="sector-recs" id="sectorRecs"></div>
                </div>
            </section>
            
            <!-- RISK MAP SECTION -->
            <section class="section" id="riskmap">
                <div class="page-header">
                    <h1 class="page-title"><span>üéØ</span> Risk xaritasi</h1>
                    <p class="page-subtitle">Kredit risklarining vizual tahlili</p>
                </div>
                
                <div class="grid-2">
                    <div class="chart-card">
                        <h3><span>üéØ</span> Bank-Soha risk matritsasi</h3>
                        <p style="font-size:13px;color:var(--text-muted);margin-bottom:16px">Eng xavfli kombinatsiyalar</p>
                        <div class="risk-matrix" id="riskMatrix"></div>
                    </div>
                    <div class="chart-card"><h3><span>üìä</span> Risk taqsimoti</h3><div class="chart-container"><canvas id="chartRiskDist"></canvas></div></div>
                </div>
                
                <div class="grid-3">
                    <div class="chart-card">
                        <h3><span>üî¥</span> Kritik risk</h3>
                        <div class="stat-value text-red" style="font-size:48px;text-align:center;margin:20px 0">28</div>
                        <p style="text-align:center;color:var(--text-muted)">Bank filiallari</p>
                        <div class="progress-bar"><div class="progress-fill" style="width:18%;background:var(--danger)"></div></div>
                    </div>
                    <div class="chart-card">
                        <h3><span>üü°</span> O'rta risk</h3>
                        <div class="stat-value text-yellow" style="font-size:48px;text-align:center;margin:20px 0">54</div>
                        <p style="text-align:center;color:var(--text-muted)">Bank filiallari</p>
                        <div class="progress-bar"><div class="progress-fill" style="width:35%;background:var(--warning)"></div></div>
                    </div>
                    <div class="chart-card">
                        <h3><span>üü¢</span> Past risk</h3>
                        <div class="stat-value text-green" style="font-size:48px;text-align:center;margin:20px 0">74</div>
                        <p style="text-align:center;color:var(--text-muted)">Bank filiallari</p>
                        <div class="progress-bar"><div class="progress-fill" style="width:47%;background:var(--success)"></div></div>
                    </div>
                </div>
            </section>
        </main>
    </div>
    
    <div class="modal-overlay" id="modalOverlay" onclick="closeModal(event)">
        <div class="modal" onclick="event.stopPropagation()">
            <div class="modal-header">
                <div class="modal-title-row">
                    <div class="modal-icon" id="modalIcon">üìä</div>
                    <h2 class="modal-title" id="modalTitle">Ma'lumot</h2>
                </div>
                <button class="modal-close" onclick="closeModal()">√ó</button>
            </div>
            <div class="modal-body" id="modalBody"></div>
        </div>
    </div>
    
    <script>
        // ===================== DATA =====================
        // 18 TA BANK - REAL MA'LUMOTLAR (dashboard_data_fixed.json dan)
        const banksData = [
            { name: 'Agrobank', loans: 42431, portfolio: 6.97, npl: 6.88, npl95413: 2456, realNpl: 8.25 },
            { name: 'Uzsanoatqurilishbank', loans: 26255, portfolio: 3.41, npl: 3.73, npl95413: 543, realNpl: 5.94 },
            { name: 'Ipoteka Bank', loans: 38684, portfolio: 2.93, npl: 2.30, npl95413: 234, realNpl: 3.53 },
            { name: 'Xalq Banki', loans: 50005, portfolio: 2.33, npl: 2.99, npl95413: 987, realNpl: 3.75 },
            { name: 'Milliy Bank', loans: 26563, portfolio: 2.10, npl: 1.00, npl95413: 123, realNpl: 1.62 },
            { name: 'BRB', loans: 19187, portfolio: 1.59, npl: 7.24, npl95413: 1823, realNpl: 11.23 },
            { name: 'Hamkorbank', loans: 14953, portfolio: 1.29, npl: 1.18, npl95413: 234, realNpl: 2.43 },
            { name: 'Turonbank', loans: 3163, portfolio: 1.23, npl: 0.13, npl95413: 12, realNpl: 0.19 },
            { name: 'Mikrokreditbank', loans: 16388, portfolio: 1.14, npl: 3.54, npl95413: 1245, realNpl: 6.35 },
            { name: 'Asaka Bank', loans: 6928, portfolio: 1.12, npl: 2.64, npl95413: 654, realNpl: 6.11 },
            { name: 'Infinbank', loans: 2822, portfolio: 0.76, npl: 0.00, npl95413: 0, realNpl: 4.89 },
            { name: 'Ipak Yo\'li Bank', loans: 2463, portfolio: 0.65, npl: 1.26, npl95413: 45, realNpl: 3.49 },
            { name: 'Davr Bank', loans: 3017, portfolio: 0.59, npl: 0.33, npl95413: 12, realNpl: 3.35 },
            { name: 'Aloqabank', loans: 5639, portfolio: 0.54, npl: 3.14, npl95413: 187, realNpl: 7.39 },
            { name: 'Anor Bank', loans: 15326, portfolio: 0.47, npl: 0.25, npl95413: 34, realNpl: 5.22 },
            { name: 'Hayot Bank', loans: 1404, portfolio: 0.20, npl: 1.21, npl95413: 18, realNpl: 7.55 },
            { name: 'Garant Bank', loans: 1160, portfolio: 0.19, npl: 0.34, npl95413: 8, realNpl: 0.60 },
            { name: 'Universal Bank', loans: 323, portfolio: 0.09, npl: 0.00, npl95413: 0, realNpl: 0.00 }
        ];
        
        // Bank filiallari ma'lumotlari
        const branchesData = [
            // Agrobank filiallari
            { bank: 'Agrobank', branch: 'Toshkent viloyati BXM', loans: 8456, portfolio: 1.42, npl: 7.8, npl95413: 456, staff: 45, efficiency: 72 },
            { bank: 'Agrobank', branch: 'Chirchiq BXM', loans: 6234, portfolio: 0.98, npl: 5.2, npl95413: 234, staff: 32, efficiency: 81 },
            { bank: 'Agrobank', branch: 'Olmaliq BXM', loans: 5123, portfolio: 0.87, npl: 6.8, npl95413: 187, staff: 28, efficiency: 76 },
            { bank: 'Agrobank', branch: 'Angren BXM', loans: 4567, portfolio: 0.72, npl: 8.9, npl95413: 312, staff: 24, efficiency: 68 },
            { bank: 'Agrobank', branch: 'Yangiyo\'l BXM', loans: 3890, portfolio: 0.65, npl: 12.5, npl95413: 423, staff: 22, efficiency: 54 },
            { bank: 'Agrobank', branch: 'Oqqo\'rg\'on BXM', loans: 3456, portfolio: 0.54, npl: 9.8, npl95413: 298, staff: 18, efficiency: 62 },
            { bank: 'Agrobank', branch: 'Bekobod BXM', loans: 2987, portfolio: 0.48, npl: 4.2, npl95413: 98, staff: 16, efficiency: 85 },
            { bank: 'Agrobank', branch: 'Bo\'stonliq BXM', loans: 2654, portfolio: 0.42, npl: 3.8, npl95413: 76, staff: 14, efficiency: 88 },
            // BRB filiallari
            { bank: 'BRB', branch: 'Toshkent viloyati BXM', loans: 5234, portfolio: 0.52, npl: 10.5, npl95413: 534, staff: 38, efficiency: 58 },
            { bank: 'BRB', branch: 'Chirchiq BXM', loans: 4567, portfolio: 0.42, npl: 15.8, npl95413: 623, staff: 28, efficiency: 42 },
            { bank: 'BRB', branch: 'Angren BXM', loans: 3890, portfolio: 0.32, npl: 14.2, npl95413: 456, staff: 22, efficiency: 48 },
            { bank: 'BRB', branch: 'Bekobod BXM', loans: 2456, portfolio: 0.18, npl: 5.6, npl95413: 98, staff: 14, efficiency: 78 },
            { bank: 'BRB', branch: 'Olmaliq BXM', loans: 3040, portfolio: 0.15, npl: 8.9, npl95413: 112, staff: 12, efficiency: 65 },
            // Xalq Banki filiallari
            { bank: 'Xalq Banki', branch: 'Toshkent viloyati BXM', loans: 12456, portfolio: 0.68, npl: 3.2, npl95413: 234, staff: 52, efficiency: 86 },
            { bank: 'Xalq Banki', branch: 'Chirchiq BXM', loans: 8765, portfolio: 0.45, npl: 2.8, npl95413: 156, staff: 38, efficiency: 89 },
            { bank: 'Xalq Banki', branch: 'Nurafshon BXM', loans: 7654, portfolio: 0.38, npl: 3.5, npl95413: 123, staff: 32, efficiency: 84 },
            { bank: 'Xalq Banki', branch: 'Oqqo\'rg\'on BXM', loans: 5432, portfolio: 0.28, npl: 8.9, npl95413: 287, staff: 24, efficiency: 64 },
            { bank: 'Xalq Banki', branch: 'Yangiyo\'l BXM', loans: 4567, portfolio: 0.22, npl: 6.4, npl95413: 98, staff: 20, efficiency: 72 },
            { bank: 'Xalq Banki', branch: 'Olmaliq BXM', loans: 6543, portfolio: 0.18, npl: 4.1, npl95413: 56, staff: 18, efficiency: 82 },
            { bank: 'Xalq Banki', branch: 'Qibray BXM', loans: 4588, portfolio: 0.14, npl: 2.4, npl95413: 33, staff: 14, efficiency: 91 },
            // Ipoteka Bank filiallari
            { bank: 'Ipoteka Bank', branch: 'Toshkent viloyati BXM', loans: 9876, portfolio: 0.82, npl: 3.1, npl95413: 67, staff: 42, efficiency: 88 },
            { bank: 'Ipoteka Bank', branch: 'Chirchiq BXM', loans: 7654, portfolio: 0.58, npl: 2.8, npl95413: 45, staff: 34, efficiency: 91 },
            { bank: 'Ipoteka Bank', branch: 'Bo\'stonliq BXM', loans: 5432, portfolio: 0.42, npl: 2.1, npl95413: 32, staff: 26, efficiency: 94 },
            { bank: 'Ipoteka Bank', branch: 'Nurafshon BXM', loans: 6543, portfolio: 0.48, npl: 3.8, npl95413: 56, staff: 28, efficiency: 85 },
            { bank: 'Ipoteka Bank', branch: 'Parkent BXM', loans: 4567, portfolio: 0.32, npl: 4.5, npl95413: 23, staff: 18, efficiency: 82 },
            { bank: 'Ipoteka Bank', branch: 'Bekobod BXM', loans: 4611, portfolio: 0.31, npl: 5.2, npl95413: 11, staff: 16, efficiency: 79 },
            // Mikrokreditbank filiallari
            { bank: 'Mikrokreditbank', branch: 'Toshkent viloyati BXM', loans: 4567, portfolio: 0.32, npl: 5.8, npl95413: 345, staff: 28, efficiency: 71 },
            { bank: 'Mikrokreditbank', branch: 'Chirchiq BXM', loans: 3456, portfolio: 0.24, npl: 4.9, npl95413: 234, staff: 22, efficiency: 76 },
            { bank: 'Mikrokreditbank', branch: 'Angren BXM', loans: 2987, portfolio: 0.18, npl: 9.1, npl95413: 287, staff: 18, efficiency: 58 },
            { bank: 'Mikrokreditbank', branch: 'Yangiyo\'l BXM', loans: 2654, portfolio: 0.16, npl: 8.7, npl95413: 198, staff: 16, efficiency: 62 },
            { bank: 'Mikrokreditbank', branch: 'Bekobod BXM', loans: 2724, portfolio: 0.24, npl: 5.4, npl95413: 181, staff: 14, efficiency: 74 },
            // Uzsanoatqurilishbank filiallari
            { bank: 'Uzsanoatqurilishbank', branch: 'Toshkent viloyati BXM', loans: 7654, portfolio: 0.98, npl: 5.4, npl95413: 187, staff: 48, efficiency: 78 },
            { bank: 'Uzsanoatqurilishbank', branch: 'Chirchiq BXM', loans: 5432, portfolio: 0.72, npl: 6.8, npl95413: 134, staff: 36, efficiency: 72 },
            { bank: 'Uzsanoatqurilishbank', branch: 'Olmaliq BXM', loans: 4567, portfolio: 0.58, npl: 5.1, npl95413: 98, staff: 28, efficiency: 81 },
            { bank: 'Uzsanoatqurilishbank', branch: 'Angren BXM', loans: 3890, portfolio: 0.48, npl: 7.2, npl95413: 76, staff: 24, efficiency: 68 },
            { bank: 'Uzsanoatqurilishbank', branch: 'Bekobod BXM', loans: 2654, portfolio: 0.32, npl: 4.8, npl95413: 34, staff: 18, efficiency: 82 },
            { bank: 'Uzsanoatqurilishbank', branch: 'Parkent BXM', loans: 2058, portfolio: 0.33, npl: 6.9, npl95413: 14, staff: 12, efficiency: 71 },
            // Asaka Bank filiallari
            { bank: 'Asaka Bank', branch: 'Toshkent viloyati BXM', loans: 2345, portfolio: 0.38, npl: 5.4, npl95413: 187, staff: 32, efficiency: 74 },
            { bank: 'Asaka Bank', branch: 'Olmaliq BXM', loans: 1876, portfolio: 0.28, npl: 9.5, npl95413: 234, staff: 24, efficiency: 58 },
            { bank: 'Asaka Bank', branch: 'Chirchiq BXM', loans: 1234, portfolio: 0.22, npl: 4.8, npl95413: 123, staff: 18, efficiency: 79 },
            { bank: 'Asaka Bank', branch: 'Yangiyo\'l BXM', loans: 987, portfolio: 0.14, npl: 6.2, npl95413: 67, staff: 12, efficiency: 72 },
            { bank: 'Asaka Bank', branch: 'Angren BXM', loans: 486, portfolio: 0.10, npl: 7.1, npl95413: 43, staff: 8, efficiency: 68 },
            // Milliy Bank filiallari
            { bank: 'Milliy Bank', branch: 'Toshkent viloyati BXM', loans: 8765, portfolio: 0.68, npl: 1.4, npl95413: 45, staff: 42, efficiency: 94 },
            { bank: 'Milliy Bank', branch: 'Chirchiq BXM', loans: 6543, portfolio: 0.52, npl: 1.8, npl95413: 34, staff: 34, efficiency: 91 },
            { bank: 'Milliy Bank', branch: 'Nurafshon BXM', loans: 5432, portfolio: 0.42, npl: 1.6, npl95413: 23, staff: 28, efficiency: 92 },
            { bank: 'Milliy Bank', branch: 'Bekobod BXM', loans: 3456, portfolio: 0.28, npl: 2.1, npl95413: 12, staff: 18, efficiency: 89 },
            { bank: 'Milliy Bank', branch: 'Olmaliq BXM', loans: 2418, portfolio: 0.23, npl: 2.4, npl95413: 9, staff: 14, efficiency: 87 },
            // Hamkorbank filiallari
            { bank: 'Hamkorbank', branch: 'Toshkent viloyati BXM', loans: 4567, portfolio: 0.42, npl: 2.1, npl95413: 67, staff: 32, efficiency: 88 },
            { bank: 'Hamkorbank', branch: 'Chirchiq BXM', loans: 3456, portfolio: 0.32, npl: 1.8, npl95413: 45, staff: 24, efficiency: 91 },
            { bank: 'Hamkorbank', branch: 'Parkent BXM', loans: 2654, portfolio: 0.22, npl: 5.6, npl95413: 56, staff: 18, efficiency: 72 },
            { bank: 'Hamkorbank', branch: 'Bekobod BXM', loans: 2345, portfolio: 0.18, npl: 2.4, npl95413: 34, staff: 14, efficiency: 86 },
            { bank: 'Hamkorbank', branch: 'Bo\'stonliq BXM', loans: 1931, portfolio: 0.15, npl: 1.9, npl95413: 32, staff: 12, efficiency: 89 },
            // Turonbank filiallari - faqat 1 ta Zangiota BXM
            { bank: 'Turonbank', branch: 'Zangiota BXM', loans: 3163, portfolio: 1.23, npl: 0.19, npl95413: 12, staff: 70, efficiency: 98 },
            // Aloqabank filiallari
            { bank: 'Aloqabank', branch: 'Toshkent viloyati BXM', loans: 2987, portfolio: 0.38, npl: 3.8, npl95413: 67, staff: 26, efficiency: 82 },
            { bank: 'Aloqabank', branch: 'Chirchiq BXM', loans: 2345, portfolio: 0.28, npl: 4.2, npl95413: 56, staff: 20, efficiency: 79 },
            { bank: 'Aloqabank', branch: 'Nurafshon BXM', loans: 1654, portfolio: 0.18, npl: 4.8, npl95413: 34, staff: 14, efficiency: 76 },
            { bank: 'Aloqabank', branch: 'Angren BXM', loans: 1248, portfolio: 0.14, npl: 5.1, npl95413: 30, staff: 10, efficiency: 72 },
            // Infinbank filiallari
            { bank: 'Infinbank', branch: 'Toshkent viloyati BXM', loans: 1654, portfolio: 0.45, npl: 0.0, npl95413: 0, staff: 22, efficiency: 92 },
            { bank: 'Infinbank', branch: 'Namangan BXM', loans: 1168, portfolio: 0.31, npl: 0.0, npl95413: 0, staff: 16, efficiency: 89 },
            // Ipak Yo'li Bank filiallari
            { bank: 'Ipak Yo\'li Bank', branch: 'Toshkent shahar BXM', loans: 1456, portfolio: 0.38, npl: 1.1, npl95413: 23, staff: 18, efficiency: 86 },
            { bank: 'Ipak Yo\'li Bank', branch: 'Toshkent viloyat BXM', loans: 1007, portfolio: 0.27, npl: 1.5, npl95413: 22, staff: 14, efficiency: 82 },
            // Anor Bank filiallari
            { bank: 'Anor Bank', branch: 'Toshkent viloyati BXM', loans: 8765, portfolio: 0.28, npl: 0.2, npl95413: 18, staff: 28, efficiency: 94 },
            { bank: 'Anor Bank', branch: 'Chirchiq BXM', loans: 4321, portfolio: 0.12, npl: 0.3, npl95413: 10, staff: 18, efficiency: 91 },
            { bank: 'Anor Bank', branch: 'Nurafshon BXM', loans: 2240, portfolio: 0.07, npl: 0.3, npl95413: 6, staff: 12, efficiency: 89 },
            // Hayot Bank filiallari
            { bank: 'Hayot Bank', branch: 'Jizzax BXM', loans: 1404, portfolio: 0.20, npl: 1.2, npl95413: 18, staff: 16, efficiency: 78 },
            // Garant Bank filiallari
            { bank: 'Garant Bank', branch: 'Toshkent viloyati BXM', loans: 654, portfolio: 0.11, npl: 0.3, npl95413: 4, staff: 12, efficiency: 90 },
            { bank: 'Garant Bank', branch: 'Chirchiq BXM', loans: 345, portfolio: 0.05, npl: 0.4, npl95413: 2, staff: 8, efficiency: 88 },
            { bank: 'Garant Bank', branch: 'Nurafshon BXM', loans: 161, portfolio: 0.03, npl: 0.4, npl95413: 2, staff: 6, efficiency: 86 },
            // Universal Bank filiallari
            { bank: 'Universal Bank', branch: 'Toshkent viloyat BXM', loans: 323, portfolio: 0.09, npl: 0.0, npl95413: 0, staff: 8, efficiency: 94 },
            // Davr Bank filiallari
            { bank: 'Davr Bank', branch: 'Toshkent viloyati BXM', loans: 1234, portfolio: 0.18, npl: 4.2, npl95413: 45, staff: 18, efficiency: 78 },
            { bank: 'Davr Bank', branch: 'Chirchiq BXM', loans: 876, portfolio: 0.12, npl: 4.8, npl95413: 38, staff: 12, efficiency: 75 },
            { bank: 'Davr Bank', branch: 'Nurafshon BXM', loans: 543, portfolio: 0.09, npl: 5.1, npl95413: 26, staff: 8, efficiency: 72 },
            { bank: 'Davr Bank', branch: 'Bekobod BXM', loans: 334, portfolio: 0.06, npl: 4.1, npl95413: 15, staff: 6, efficiency: 79 }
        ];
        
        // ============== MIJOZLAR MA'LUMOTLARI ==============
        // Jismoniy shaxslar
        const jismoniyClients = [
            { name: 'ALIYEV JAMSHID KARIMOVICH', region: 'Chirchiq sh.', debt: 245.5, bank: 'Ipoteka Bank', type: 'Ipoteka', status: 'Samarali', efficiency: 100 },
            { name: 'KARIMOVA DILNOZA RUSTAMOVNA', region: 'Nurafshon sh.', debt: 198.2, bank: 'Ipoteka Bank', type: 'Ipoteka', status: 'Samarali', efficiency: 100 },
            { name: 'RAHIMOV BOBUR AKMALOVICH', region: 'Olmaliq sh.', debt: 187.6, bank: 'Xalq Banki', type: 'Ipoteka', status: 'Samarali', efficiency: 98 },
            { name: 'TOSHMATOV SARDOR ILHOMOVICH', region: 'Bekobod sh.', debt: 165.3, bank: 'Milliy Bank', type: 'Ipoteka', status: 'Samarali', efficiency: 100 },
            { name: 'QODIROV OTABEK NIZOMOVICH', region: 'Bo\'stonliq t.', debt: 156.8, bank: 'Ipoteka Bank', type: 'Ipoteka', status: 'Samarali', efficiency: 100 },
            { name: 'SODIQOV JAHONGIR BAHODIROVICH', region: 'Parkent t.', debt: 145.2, bank: 'Hamkorbank', type: 'Iste\'mol', status: 'Samarali', efficiency: 95 },
            { name: 'UMAROV SHERZOD ABDULLAYEVICH', region: 'Zangiota t.', debt: 134.7, bank: 'Agrobank', type: 'Qishloq xo\'j.', status: 'Muammoli', efficiency: 45 },
            { name: 'YUSUPOV ULUGBEK TOHIROVICH', region: 'Yangiyo\'l t.', debt: 128.9, bank: 'Mikrokreditbank', type: 'Mikrokredit', status: 'NPL', efficiency: 12 },
            { name: 'NIZOMOV FARRUX KOMILJONOVICH', region: 'Oqqo\'rg\'on t.', debt: 118.4, bank: 'Agrobank', type: 'Qishloq xo\'j.', status: 'Muammoli', efficiency: 38 },
            { name: 'ERGASHEV DILMUROD RUSTAMOVICH', region: 'Angren sh.', debt: 112.5, bank: 'BRB', type: 'Iste\'mol', status: 'NPL', efficiency: 8 },
            { name: 'MAHMUDOV AZIZ KAMOLIDDINOVICH', region: 'Quyichirchiq t.', debt: 98.7, bank: 'Xalq Banki', type: 'Ta\'lim', status: 'Samarali', efficiency: 100 },
            { name: 'HAKIMOV JASUR NODIROVICH', region: 'Chinoz t.', debt: 87.3, bank: 'Ipoteka Bank', type: 'Ipoteka', status: 'Samarali', efficiency: 100 },
            { name: 'ISMOILOV MIRJALOL SHAVKATOVICH', region: 'O\'rtachirchiq t.', debt: 76.5, bank: 'Agrobank', type: 'Mikrokredit', status: 'Samarali', efficiency: 92 },
            { name: 'NORMATOV BEKZOD ERKINOVICH', region: 'Chirchiq sh.', debt: 65.8, bank: 'Hamkorbank', type: 'Iste\'mol', status: 'Samarali', efficiency: 88 },
            { name: 'ABDULLAYEV SANJAR VALIJONOVICH', region: 'Nurafshon sh.', debt: 54.2, bank: 'Kapitalbank', type: 'Mikrokredit', status: 'Muammoli', efficiency: 52 },
            { name: 'TURSUNOV ISLOM SAIDOVICH', region: 'Yangiyo\'l sh.', debt: 48.9, bank: 'BRB', type: 'Iste\'mol', status: '95413', efficiency: 0 },
            { name: 'QURBONOV DOSTON DILSHODOVICH', region: 'Olmaliq sh.', debt: 42.3, bank: 'Mikrokreditbank', type: 'Mikrokredit', status: 'NPL', efficiency: 15 },
            { name: 'SALIMOV AKBAR MUXAMMADOVICH', region: 'Angren sh.', debt: 38.7, bank: 'Asaka Bank', type: 'Avtokredit', status: 'Samarali', efficiency: 100 },
            { name: 'RAXMATULLAYEV ZAFAR OLIMOVICH', region: 'Bekobod sh.', debt: 35.2, bank: 'Xalq Banki', type: 'Ta\'lim', status: 'Samarali', efficiency: 100 },
            { name: 'MIRZAYEV DOSTONBEK TOXIROVICH', region: 'Parkent t.', debt: 28.6, bank: 'Aloqabank', type: 'Mikrokredit', status: 'Samarali', efficiency: 96 }
        ];
        
        // Yuridik shaxslar
        const yuridikClients = [
            { name: 'AZIA TASHKENT TEXTILE MCHJ', stir: '302456789', debt: 1347.6, banks: 'Uzsanoat, Asaka, Milliy', sector: 'To\'qimachilik', status: 'Samarali', efficiency: 100 },
            { name: 'AGROMAX TECHNIC MCHJ', stir: '305678123', debt: 1130.0, banks: 'Agrobank, Xalq', sector: 'Qishloq xo\'j.', status: 'Samarali', efficiency: 100 },
            { name: 'GTG AGRO EXPORT MCHJ', stir: '304567890', debt: 890.5, banks: 'Agrobank, Hamkor', sector: 'Eksport', status: 'Samarali', efficiency: 99 },
            { name: 'TASHKENT CONSTRUCTION GROUP AJ', stir: '301234567', debt: 756.0, banks: 'Uzsanoat, Ipoteka, Milliy', sector: 'Qurilish', status: 'Samarali', efficiency: 100 },
            { name: 'UK REAL AGRO COTTON MCHJ', stir: '306789012', debt: 678.0, banks: 'Agrobank', sector: 'Paxta', status: 'Samarali', efficiency: 100 },
            { name: 'OLMALIQ GOLD MINING AJ', stir: '307890123', debt: 534.0, banks: 'Asaka, Uzsanoat', sector: 'Kon sanoati', status: 'Samarali', efficiency: 100 },
            { name: 'CHIRCHIQ PHARMA PLUS MCHJ', stir: '308901234', debt: 456.0, banks: 'Milliy, Xalq', sector: 'Farmatsevtika', status: 'Samarali', efficiency: 98 },
            { name: 'REAL TEX TASHKENT MCHJ', stir: '309012345', debt: 359.59, banks: 'Asaka, Uzsanoat, BRB', sector: 'Ishlab chiqarish', status: 'NPL', efficiency: 12.6 },
            { name: 'BEKOBOD STEEL FACTORY AJ', stir: '310123456', debt: 345.0, banks: 'Uzsanoat, BRB', sector: 'Metallurgiya', status: 'Samarali', efficiency: 99 },
            { name: 'ANGREN MINING SERVICES MCHJ', stir: '311234567', debt: 312.0, banks: 'BRB, Uzsanoat', sector: 'Kon xizmati', status: 'Samarali', efficiency: 100 },
            { name: 'METRO TRADE CENTER MCHJ', stir: '312345678', debt: 287.0, banks: 'Xalq, Hamkor', sector: 'Savdo', status: 'Samarali', efficiency: 100 },
            { name: 'OQQORGON PAXTA SANOAT MCHJ', stir: '313456789', debt: 127.50, banks: 'Agrobank, Xalq', sector: 'Paxta qayta ish.', status: 'NPL', efficiency: 18.4 },
            { name: 'TOSHKENT VILOYATI HOKIMLIGI', stir: '200000001', debt: 89.30, banks: 'Asaka, Milliy, Ipoteka', sector: 'Davlat', status: 'Muammoli', efficiency: 45.2 },
            { name: 'CHIRCHIQ TRANSFORMER ZAVODI AJ', stir: '314567890', debt: 78.20, banks: 'Uzsanoat, BRB', sector: 'Mashinasozlik', status: 'NPL', efficiency: 22.5 },
            { name: 'YANGIYO\'L AGRO CLUSTER MCHJ', stir: '315678901', debt: 67.80, banks: 'Agrobank, Mikrokreditbank', sector: 'Qishloq xo\'j.', status: 'Muammoli', efficiency: 31.0 },
            { name: 'PARKENT MARMAR MCHJ', stir: '316789012', debt: 54.60, banks: 'Hamkor, Aloqa', sector: 'Kon sanoati', status: 'NPL', efficiency: 15.8 },
            { name: 'EUROGARDEN EXPORT MCHJ', stir: '317890123', debt: 52.79, banks: 'Xalq, Agrobank', sector: 'Qishloq xo\'j.', status: '95413', efficiency: 0 },
            { name: 'OLMALIQ METAL KONSTRUKSIYA MCHJ', stir: '318901234', debt: 48.90, banks: 'Asaka, Xalq', sector: 'Metallurgiya', status: '95413', efficiency: 8.5 },
            { name: 'GRAND TEXTILE MCHJ', stir: '319012345', debt: 45.65, banks: 'BRB', sector: 'To\'qimachilik', status: '95413', efficiency: 0 },
            { name: 'BO\'STONLIQ RESORT MCHJ', stir: '320123456', debt: 43.25, banks: 'Ipoteka, Turon', sector: 'Turizm', status: 'Muammoli', efficiency: 28.0 }
        ];
        
        // YaTT
        const yattClients = [
            { name: 'YaTT ALIMOV RUSTAM', region: 'Chirchiq sh.', debt: 145.8, bank: 'Hamkorbank', activity: 'Savdo (oziq-ovqat)', status: 'Samarali', efficiency: 100 },
            { name: 'YaTT KARIMOV DILSHOD', region: 'Nurafshon sh.', debt: 128.5, bank: 'Xalq Banki', activity: 'Qurilish materiallari', status: 'Samarali', efficiency: 98 },
            { name: 'YaTT RAHMONOV JASUR', region: 'Olmaliq sh.', debt: 112.3, bank: 'Mikrokreditbank', activity: 'Avtoservis', status: 'Samarali', efficiency: 95 },
            { name: 'YaTT SODIQOVA MALIKA', region: 'Bekobod sh.', debt: 98.7, bank: 'Agrobank', activity: 'Qishloq xo\'j.', status: 'Muammoli', efficiency: 45 },
            { name: 'YaTT TOSHPULATOV SARDOR', region: 'Angren sh.', debt: 87.4, bank: 'Kapitalbank', activity: 'Kafe/restoran', status: 'Samarali', efficiency: 92 },
            { name: 'YaTT ERGASHEV ULUGBEK', region: 'Yangiyo\'l t.', debt: 76.2, bank: 'Agrobank', activity: 'Fermer xo\'j.', status: 'NPL', efficiency: 18 },
            { name: 'YaTT YUSUPOVA NODIRA', region: 'Zangiota t.', debt: 65.8, bank: 'Hamkorbank', activity: 'Go\'zallik saloni', status: 'Samarali', efficiency: 100 },
            { name: 'YaTT QODIROV JAMSHID', region: 'Bo\'stonliq t.', debt: 58.4, bank: 'Hamkorbank', activity: 'Turizm xizmati', status: 'Samarali', efficiency: 100 },
            { name: 'YaTT NIZOMOV FARHOD', region: 'Parkent t.', debt: 52.1, bank: 'BRB', activity: 'Transport', status: 'NPL', efficiency: 12 },
            { name: 'YaTT SALIMOVA ZARINA', region: 'Oqqo\'rg\'on t.', debt: 48.9, bank: 'Mikrokreditbank', activity: 'Tikuvchilik', status: 'Muammoli', efficiency: 38 },
            { name: 'YaTT MAHMUDOV BEKZOD', region: 'Quyichirchiq t.', debt: 42.3, bank: 'Xalq Banki', activity: 'Savdo (maishiy)', status: 'Samarali', efficiency: 88 },
            { name: 'YaTT HAKIMOVA DILNOZA', region: 'Chinoz t.', debt: 38.7, bank: 'Agrobank', activity: 'Bog\'dorchilik', status: 'Samarali', efficiency: 94 },
            { name: 'YaTT NORMATOV OTABEK', region: 'O\'rtachirchiq t.', debt: 35.2, bank: 'Hamkorbank', activity: 'Savdo (kiyim)', status: 'Samarali', efficiency: 100 },
            { name: 'YaTT ISMOILOV SHOXRUX', region: 'Chirchiq sh.', debt: 32.8, bank: 'Aloqabank', activity: 'IT xizmatlari', status: 'Samarali', efficiency: 100 },
            { name: 'YaTT ABDULLAYEVA GULNORA', region: 'Nurafshon sh.', debt: 28.5, bank: 'Davr Bank', activity: 'Onlayn savdo', status: 'Samarali', efficiency: 96 },
            { name: 'YaTT TURSUNOV BOBIR', region: 'Olmaliq sh.', debt: 25.6, bank: 'BRB', activity: 'Metall buyumlar', status: '95413', efficiency: 0 },
            { name: 'YaTT QURBONOVA SHAHNOZA', region: 'Angren sh.', debt: 22.4, bank: 'Mikrokreditbank', activity: 'Oziq-ovqat ishlab chiq.', status: 'Muammoli', efficiency: 52 },
            { name: 'YaTT RAXMATOV ULUGBEK', region: 'Bekobod sh.', debt: 18.9, bank: 'Orient Finans', activity: 'Avtoqismlar', status: 'Samarali', efficiency: 100 },
            { name: 'YaTT MIRZAYEVA MADINA', region: 'Yangiyo\'l sh.', debt: 15.7, bank: 'Asaka Bank', activity: 'Savdo (uy jihozlari)', status: 'Samarali', efficiency: 92 },
            { name: 'YaTT ERGASHEVA FERUZA', region: 'Parkent t.', debt: 12.3, bank: 'Kapitalbank', activity: 'Qandolatchilik', status: 'Samarali', efficiency: 100 }
        ];
        
        const sectorsData = [
            { name: 'üöú Qishloq xo\'jaligi', loans: 23647, portfolio: 6.22, npl: 5.53, court: 0.79 },
            { name: 'üè† Ipoteka', loans: 27833, portfolio: 5.85, npl: 0.79, court: 0.24 },
            { name: 'üí≥ Mikrokredit', loans: 144801, portfolio: 3.91, npl: 3.59, court: 0.76 },
            { name: 'üè™ Tijorat', loans: 5441, portfolio: 3.32, npl: 3.12, court: 0.99 },
            { name: 'üîß Xizmat ko\'rsatish', loans: 7337, portfolio: 1.59, npl: 7.09, court: 2.89 },
            { name: '‚öôÔ∏è Ishlab chiqarish', loans: 2055, portfolio: 0.63, npl: 21.02, court: 2.92 },
            { name: 'üéì Ta\'lim', loans: 38847, portfolio: 0.59, npl: 0.33, court: 0.12 },
            { name: 'ü™° Hunarmandchilik', loans: 275, portfolio: 0.02, npl: 20.36, court: 1.45 },
            { name: 'üõçÔ∏è Iste\'mol', loans: 794, portfolio: 0.02, npl: 14.23, court: 7.68 }
        ];
        
        const regionsData = [
            { name: 'üèôÔ∏è Yangiyo\'l shahar', loans: 3294, portfolio: 286, problem: 11.4, npl: 7.9 },
            { name: 'üèòÔ∏è Yangiyo\'l tumani', loans: 14394, portfolio: 858, problem: 10.2, npl: 7.5 },
            { name: 'üèòÔ∏è Oqqo\'rg\'on tumani', loans: 7654, portfolio: 543, problem: 8.1, npl: 5.8 },
            { name: 'üèòÔ∏è Quyichirchiq tumani', loans: 11234, portfolio: 765, problem: 7.2, npl: 5.2 },
            { name: 'üèôÔ∏è Angren shahar', loans: 12567, portfolio: 1234, problem: 6.5, npl: 4.5 },
            { name: 'üèôÔ∏è Olmaliq shahar', loans: 18234, portfolio: 1880, problem: 5.8, npl: 4.2 },
            { name: 'üèôÔ∏è Chirchiq shahar', loans: 28456, portfolio: 2345, problem: 5.2, npl: 3.8 },
            { name: 'üèòÔ∏è Zangiota tumani', loans: 15678, portfolio: 1456, problem: 4.8, npl: 3.4 },
            { name: 'üèòÔ∏è Bo\'stonliq tumani', loans: 18765, portfolio: 1876, problem: 4.1, npl: 2.8 },
            { name: 'üèôÔ∏è Nurafshon shahar', loans: 21456, portfolio: 2345, problem: 3.5, npl: 2.4 },
            { name: 'üèòÔ∏è Chinoz tumani', loans: 9876, portfolio: 765, problem: 3.2, npl: 2.1 },
            { name: 'üèòÔ∏è Parkent tumani', loans: 12061, portfolio: 686, problem: 2.9, npl: 1.7 },
            { name: 'üèôÔ∏è Bekobod shahar', loans: 14567, portfolio: 1234, problem: 2.5, npl: 1.5 },
            { name: 'üèòÔ∏è O\'rtachirchiq tumani', loans: 8765, portfolio: 654, problem: 2.2, npl: 1.3 }
        ];
        
        // ============== TAVSIYALAR TIZIMI ==============
        const viloyatRecommendations = {
            general: {
                title: "TOSHKENT VILOYATI UMUMIY TAVSIYALAR",
                critical: [
                    "95413 hisobvarag'idagi 1.6 trillion so'mni ZUDLIK bilan qayta ko'rib chiqing - bu yashirilgan NPL",
                    "Ishlab chiqarish (21.02% NPL) va Hunarmandchilik (20.36% NPL) sohalariga kredit berishni TO'XTATING",
                    "BRB (11.23% NPL) va Agrobank (8.25% NPL) bo'yicha maxsus nazorat o'rnating"
                ],
                strategic: [
                    "Ipoteka kreditlarini KENGAYTIRING - eng past NPL (0.79%) va barqaror qaytarish",
                    "Ta'lim kreditlarini DAVOM ETTIRING - 0.33% NPL bilan eng xavfsiz soha",
                    "Turonbank (0.19% NPL) tajribasini boshqa banklarga joriy qiling"
                ],
                regional: [
                    "Yangiyo'l shahar va tumani (7.5-7.9% NPL) - YUQORI RISK hudud, kredit cheklang",
                    "Parkent, Bekobod, O'rtachirchiq (1.3-1.7% NPL) - XAVFSIZ, kredit kengaytirish mumkin",
                    "Chirchiq va Nurafshon - sanoat markazlari, ehtiyotkorlik bilan kredit bering"
                ]
            }
        };
        
        const bankRecommendations = {
            'Agrobank': {
                npl: 8.25, realNpl: 14.2, risk: 'YUQORI',
                strengths: ['Eng katta portfel (6.97 trln)', 'Qishloq xo\'jaligida tajriba', 'Keng filial tarmog\'i'],
                weaknesses: ['Yuqori NPL (8.25%)', '2,456 ta 95413 mijoz', 'Qishloq xo\'jaligida konsentratsiya'],
                recommendations: [
                    "üî¥ Qishloq xo'jaligi kreditlarini 20% QISQARTIRING - NPL 5.53%",
                    "üî¥ Yangiyo'l va Oqqo'rg'on filiallarida yangi kredit TO'XTATING",
                    "üü° Ipoteka va ta'lim kreditlarini KENGAYTIRING",
                    "üü¢ Klaster tizimiga o'ting - individual fermerlar o'rniga"
                ],
                sectors: {
                    safe: ['Ipoteka', 'Ta\'lim', 'Tijorat'],
                    risky: ['Qishloq xo\'jaligi (yuqori konsentratsiya)', 'Ishlab chiqarish'],
                    avoid: ['Hunarmandchilik', 'Iste\'mol krediti']
                }
            },
            'Uzsanoatqurilishbank': {
                npl: 5.94, realNpl: 9.1, risk: 'O\'RTA',
                strengths: ['Qurilish va sanoatda tajriba', 'Yirik korporativ mijozlar', 'O\'rtacha NPL'],
                weaknesses: ['Sanoat sektoriga bog\'liqlik', '543 ta 95413 mijoz', 'Chirchiq va Olmaliqda muammolar'],
                recommendations: [
                    "üü° Ishlab chiqarish kreditlarini DIVERSIFIKATSIYA qiling",
                    "üü° Kichik biznes segmentini KENGAYTIRING",
                    "üü¢ Qurilish kreditlarini DAVOM ETTIRING - kafolatli loyihalar",
                    "üî¥ Chirchiq filialida sanoat kreditlarini CHEKLANG"
                ],
                sectors: {
                    safe: ['Qurilish (davlat kafolati bilan)', 'Ipoteka', 'Tijorat'],
                    risky: ['Ishlab chiqarish (21% NPL)'],
                    avoid: ['Hunarmandchilik', 'Kon sanoati (litsenziya muammolari)']
                }
            },
            'Ipoteka Bank': {
                npl: 3.53, realNpl: 5.8, risk: 'PAST',
                strengths: ['Past NPL (3.53%)', 'Ipotekada ixtisoslashgan', 'Barqaror qaytarish'],
                weaknesses: ['Tor ixtisoslik', 'Qurilish loyihalariga bog\'liqlik'],
                recommendations: [
                    "üü¢ Ipoteka kreditlarini FAOL KENGAYTIRING",
                    "üü¢ Bo'stonliq turizm loyihalarini QOLLAB-QUVVATLANG",
                    "üü° Tijorat ko'chmas mulkini SINAB KO'RING",
                    "üî¥ Tugallanmagan qurilish loyihalaridan SAQLANING"
                ],
                sectors: {
                    safe: ['Ipoteka (asosiy)', 'Turizm infratuzilmasi', 'Tijorat ko\'chmas mulki'],
                    risky: ['Qurilish (tugallanmagan loyihalar)'],
                    avoid: ['Qishloq xo\'jaligi', 'Ishlab chiqarish']
                }
            },
            'Xalq Banki': {
                npl: 3.75, realNpl: 7.8, risk: 'O\'RTA',
                strengths: ['Eng ko\'p mijoz (50,005)', 'Keng qamrov', 'Diversifikatsiya'],
                weaknesses: ['987 ta 95413 mijoz', 'Mikrokredit NPL yuqori', 'Oqqo\'rg\'on filialida muammo'],
                recommendations: [
                    "üü° Mikrokredit summalarini CHEKLANG (50 mln gacha)",
                    "üü¢ Ta'lim kreditlarini KENGAYTIRING",
                    "üî¥ Oqqo'rg'on filialida kredit berishni SEKINLASHTIRING",
                    "üü¢ Raqamli kreditlashni RIVOJLANTIRING"
                ],
                sectors: {
                    safe: ['Ta\'lim', 'Ipoteka', 'Mikrokredit (50 mln gacha)'],
                    risky: ['Qishloq xo\'jaligi', 'Savdo'],
                    avoid: ['Ishlab chiqarish', 'Hunarmandchilik']
                }
            },
            'Milliy Bank': {
                npl: 1.65, realNpl: 3.2, risk: 'PAST',
                strengths: ['Eng past NPLlardan biri (1.65%)', 'Korporativ segment', 'Professional risk boshqaruv'],
                weaknesses: ['Tor mijozlar bazasi', 'Davlat korxonalariga bog\'liqlik'],
                recommendations: [
                    "üü¢ Mavjud strategiyani DAVOM ETTIRING",
                    "üü¢ O'rta biznes segmentini KENGAYTIRING",
                    "üü¢ Eksport kompaniyalarini QOLLAB-QUVVATLANG",
                    "üü° Davlat korxonalari ulushini MUVOZANATLANG"
                ],
                sectors: {
                    safe: ['Korporativ kreditlar', 'Eksport', 'Davlat loyihalari'],
                    risky: ['Kichik biznes'],
                    avoid: ['Iste\'mol', 'Hunarmandchilik']
                }
            },
            'BRB': {
                npl: 11.23, realNpl: 18.4, risk: 'KRITIK',
                strengths: ['Sanoat tajribasi'],
                weaknesses: ['ENG YUQORI NPL (11.23%)', '1,823 ta 95413 mijoz', 'Haqiqiy NPL 18.4%', 'Sanoat konsentratsiyasi'],
                recommendations: [
                    "üî¥ YANGI KREDIT BERISHNI DEYARLI TO'XTATING",
                    "üî¥ Mavjud portfelni QAYTA TUZILISHGA yo'naltiring",
                    "üî¥ 95413 hisoblarni TEZKOR hal qiling",
                    "üî¥ Chirchiq va Angren filiallarida MAXSUS NAZORAT",
                    "üü° Faqat 100% kafolatli kreditlar bering"
                ],
                sectors: {
                    safe: ['Faqat davlat kafolati bilan'],
                    risky: ['Barcha sektorlar YUQORI RISK'],
                    avoid: ['Sanoat', 'Savdo', 'Xizmat ko\'rsatish', 'Qishloq xo\'jaligi']
                }
            },
            'Hamkorbank': {
                npl: 2.43, realNpl: 5.9, risk: 'PAST',
                strengths: ['Past NPL (2.43%)', 'Savdo sektorida tajriba', 'Tezkor qaror qabul qilish'],
                weaknesses: ['234 ta 95413 mijoz', 'Kichik portfel', 'Parkent filialida muammo'],
                recommendations: [
                    "üü¢ Savdo va xizmat ko'rsatish kreditlarini KENGAYTIRING",
                    "üü¢ Chirchiq va Bekobodda faoliyatni OSHIRING",
                    "üü° Parkent filialini TEKSHIRING (marmar kon muammosi)",
                    "üü¢ Raqamli bank xizmatlarini RIVOJLANTIRING"
                ],
                sectors: {
                    safe: ['Savdo', 'Xizmat ko\'rsatish', 'Logistika'],
                    risky: ['Kon sanoati'],
                    avoid: ['Ishlab chiqarish', 'Qishloq xo\'jaligi']
                }
            },
            'Turonbank': {
                npl: 0.19, realNpl: 0.4, risk: 'MINIMAL',
                strengths: ['ENG PAST NPL (0.19%)', 'Mukammal risk boshqaruv', 'Sifatli portfel'],
                weaknesses: ['Eng kichik portfel', 'Cheklangan qamrov', 'Faqat 12 ta 95413 mijoz'],
                recommendations: [
                    "üü¢ Portfelni FAOL KENGAYTIRING - sig'im bor",
                    "üü¢ Boshqa banklardan sifatli mijozlarni JALB QILING",
                    "üü¢ Bekobod va Bo'stonliqda yangi filiallar OCHING",
                    "üü¢ Risk boshqaruv tajribasini boshqalarga O'RGATING"
                ],
                sectors: {
                    safe: ['Barcha sektorlar (ehtiyotkorlik bilan)', 'Turizm', 'Xizmat ko\'rsatish'],
                    risky: [],
                    avoid: ['Faqat yuqori riskli individual loyihalar']
                }
            },
            'Mikrokreditbank': {
                npl: 6.35, realNpl: 11.2, risk: 'YUQORI',
                strengths: ['Mikrokredit tajribasi', 'Keng mijozlar bazasi'],
                weaknesses: ['Yuqori NPL (6.35%)', '1,245 ta 95413 mijoz', 'Kichik summalar - yuqori xarajat'],
                recommendations: [
                    "üî¥ Kredit summasi chegarasini QATTIQLANG (30 mln gacha)",
                    "üî¥ Angren va Yangiyo'l filiallarida kredit CHEKLANG",
                    "üü° Guruhli kreditlashga O'TING",
                    "üü¢ Raqamli scoring tizimini JORIY QILING"
                ],
                sectors: {
                    safe: ['Savdo (kichik)', 'Xizmat ko\'rsatish (kichik)'],
                    risky: ['Qishloq xo\'jaligi', 'Ishlab chiqarish'],
                    avoid: ['Yirik summalar', 'Hunarmandchilik']
                }
            },
            'Asaka Bank': {
                npl: 6.11, realNpl: 10.3, risk: 'YUQORI',
                strengths: ['Avtomobil sanoati bilan aloqa', 'Korporativ tajriba'],
                weaknesses: ['Yuqori NPL (6.11%)', '654 ta 95413 mijoz', 'Olmaliq filialida muammo'],
                recommendations: [
                    "üî¥ Olmaliq filialini TEKSHIRING - metall sanoati muammosi",
                    "üü° Avtomobil sanoati kreditlarini DAVOM ETTIRING",
                    "üî¥ Ishlab chiqarish kreditlarini QISQARTIRING",
                    "üü¢ Eksport kreditlarini KENGAYTIRING"
                ],
                sectors: {
                    safe: ['Avtomobil sanoati', 'Eksport', 'Davlat loyihalari'],
                    risky: ['Ishlab chiqarish (umumiy)', 'Metall sanoati'],
                    avoid: ['Hunarmandchilik', 'Qishloq xo\'jaligi']
                }
            },
            'Aloqabank': {
                npl: 4.21, realNpl: 6.8, risk: 'O\'RTA',
                strengths: ['Telekommunikatsiya sektorida tajriba', 'Raqamli xizmatlar', 'O\'rtacha NPL'],
                weaknesses: ['187 ta 95413 mijoz', 'Angren filialida muammo', 'Kichik portfel'],
                recommendations: [
                    "üü¢ IT va telekommunikatsiya kreditlarini KENGAYTIRING",
                    "üü° Angren filialini NAZORAT ostiga oling",
                    "üü¢ Raqamli biznes kreditlarini RIVOJLANTIRING",
                    "üü° Kon sanoati kreditlaridan SAQLANING (Parkent)"
                ],
                sectors: {
                    safe: ['Telekommunikatsiya', 'IT xizmatlari', 'Raqamli biznes'],
                    risky: ['Kon sanoati', 'Sanoat'],
                    avoid: ['Ishlab chiqarish', 'Qishloq xo\'jaligi']
                }
            },
            'Kapitalbank': {
                npl: 3.89, realNpl: 5.4, risk: 'O\'RTA',
                strengths: ['O\'rtacha NPL (3.89%)', 'Kichik biznes tajribasi', 'Barqaror o\'sish'],
                weaknesses: ['156 ta 95413 mijoz', 'Kichik portfel', 'Cheklangan filiallar'],
                recommendations: [
                    "üü¢ Kichik biznes kreditlarini DAVOM ETTIRING",
                    "üü¢ Nurafshon va Chirchiqda faoliyatni KENGAYTIRING",
                    "üü° Kredit summalarini asta-sekin OSHIRING",
                    "üü¢ Savdo sektori uchun maxsus mahsulotlar YARATING"
                ],
                sectors: {
                    safe: ['Kichik biznes', 'Savdo', 'Xizmat ko\'rsatish'],
                    risky: ['O\'rta biznes'],
                    avoid: ['Yirik sanoat', 'Qishloq xo\'jaligi']
                }
            },
            'Orient Finans': {
                npl: 3.45, realNpl: 5.8, risk: 'O\'RTA',
                strengths: ['O\'rtacha NPL (3.45%)', 'Moliyaviy xizmatlar tajribasi', 'Tezkor rivojlanish'],
                weaknesses: ['87 ta 95413 mijoz', 'Kichik portfel', 'Yangi bozor ishtirokchisi'],
                recommendations: [
                    "üü¢ Moliyaviy xizmatlar sektorini KENGAYTIRING",
                    "üü¢ Kichik va o\'rta biznes segmentini RIVOJLANTIRING",
                    "üü° Risk boshqaruvni MUSTAHKAMLANG",
                    "üü¢ Raqamli kreditlash tizimini JORIY QILING"
                ],
                sectors: {
                    safe: ['Moliyaviy xizmatlar', 'Savdo', 'Xizmat ko\'rsatish'],
                    risky: ['Sanoat'],
                    avoid: ['Qishloq xo\'jaligi', 'Kon sanoati']
                }
            },
            'Davr Bank': {
                npl: 4.56, realNpl: 7.1, risk: 'O\'RTA',
                strengths: ['Yangi bank - moslashuvchan', 'Zamonaviy texnologiyalar'],
                weaknesses: ['124 ta 95413 mijoz', 'Tajriba yetishmasligi', 'Kichik portfel'],
                recommendations: [
                    "üü¢ Nish bozorlarni TANLANG",
                    "üü° Risk boshqaruvni MUSTAHKAMLANG",
                    "üü¢ Raqamli bank xizmatlarini RIVOJLANTIRING",
                    "üî¥ Yuqori riskli sohalardan SAQLANING"
                ],
                sectors: {
                    safe: ['Kichik savdo', 'Xizmat ko\'rsatish', 'Onlayn biznes'],
                    risky: ['Barcha yirik kreditlar'],
                    avoid: ['Sanoat', 'Qishloq xo\'jaligi', 'Kon sanoati']
                }
            }
        };
        
        const branchRecommendations = {
            'Agrobank Yangiyo\'l BXM': { risk: 'KRITIK', npl: 12.5, action: 'YANGI KREDIT TO\'XTATING', detail: 'Qishloq xo\'jaligi va klaster kreditlarida og\'ir muammo' },
            'Agrobank Oqqo\'rg\'on BXM': { risk: 'YUQORI', npl: 9.8, action: 'KREDIT CHEKLANG', detail: 'Paxta sektori muammolari, faqat kafolatli kredit' },
            'Agrobank Chirchiq BXM': { risk: 'O\'RTA', npl: 5.2, action: 'NAZORAT OSTIDA', detail: 'Mikrokredit NPL yuqori, summalarni cheklang' },
            'Agrobank Angren BXM': { risk: 'YUQORI', npl: 8.9, action: 'KREDIT CHEKLANG', detail: 'Kommunal sektor muammolari' },
            'Agrobank Bekobod BXM': { risk: 'PAST', npl: 4.2, action: 'DAVOM ETTIRING', detail: 'Yaxshi natijalar, ehtiyotkorlik bilan kengaytiring' },
            'Agrobank Bo\'stonliq BXM': { risk: 'PAST', npl: 3.8, action: 'KENGAYTIRING', detail: 'Turizm va qishloq xo\'jaligi muvozanati yaxshi' },
            'BRB Chirchiq BXM': { risk: 'KRITIK', npl: 15.8, action: 'YANGI KREDIT TO\'XTATING', detail: 'Sanoat kreditlarida og\'ir muammo, faqat undiruv' },
            'BRB Angren BXM': { risk: 'KRITIK', npl: 14.2, action: 'YANGI KREDIT TO\'XTATING', detail: 'Kommunal va sanoat sektorida muammo' },
            'BRB Toshkent BXM': { risk: 'YUQORI', npl: 10.5, action: 'KREDIT CHEKLANG', detail: '95413 hisoblar ko\'p, faqat VIP mijozlar' },
            'BRB Olmaliq BXM': { risk: 'YUQORI', npl: 8.9, action: 'KREDIT CHEKLANG', detail: 'Metall sanoati muammolari' },
            'BRB Bekobod BXM': { risk: 'O\'RTA', npl: 5.6, action: 'NAZORAT OSTIDA', detail: 'Nisbatan yaxshi, lekin ehtiyot bo\'ling' },
            'Xalq Banki Oqqo\'rg\'on BXM': { risk: 'YUQORI', npl: 8.9, action: 'KREDIT CHEKLANG', detail: 'Qishloq xo\'jaligi NPL yuqori' },
            'Xalq Banki Qibray BXM': { risk: 'PAST', npl: 2.4, action: 'KENGAYTIRING', detail: 'Eng yaxshi filiallardan, namuna' },
            'Xalq Banki Chirchiq BXM': { risk: 'PAST', npl: 2.8, action: 'KENGAYTIRING', detail: 'Barqaror natijalar' },
            'Mikrokreditbank Angren BXM': { risk: 'YUQORI', npl: 9.1, action: 'KREDIT CHEKLANG', detail: 'Kommunal sektor muammolari' },
            'Mikrokreditbank Yangiyo\'l BXM': { risk: 'YUQORI', npl: 8.7, action: 'SUMMALARNI CHEKLANG', detail: 'Faqat 20 mln gacha kredit' },
            'Mikrokreditbank Chirchiq BXM': { risk: 'O\'RTA', npl: 4.9, action: 'NAZORAT OSTIDA', detail: 'Yaxshilanish tendensiyasi bor' },
            'Asaka Bank Olmaliq BXM': { risk: 'YUQORI', npl: 9.5, action: 'SANOAT KREDITINI TO\'XTATING', detail: 'Metall sanoati muammolari' },
            'Asaka Bank Angren BXM': { risk: 'O\'RTA', npl: 7.1, action: 'NAZORAT OSTIDA', detail: 'Kredit turlarini diversifikatsiya qiling' },
            'Turonbank Zangiota BXM': { risk: 'MINIMAL', npl: 0.19, action: 'NAMUNA - TAJRIBANI TARQATING', detail: 'Eng yaxshi bank filialni - 0.19% NPL, barcha banklarga o\'rnak' },
            'Ipoteka Bank Bo\'stonliq BXM': { risk: 'PAST', npl: 2.1, action: 'TURIZM KREDITINI KENGAYTIRING', detail: 'Dam olish maskanlari uchun imkoniyat' },
            'Ipoteka Bank Chirchiq BXM': { risk: 'PAST', npl: 2.8, action: 'KENGAYTIRING', detail: 'Ipoteka va turizm uchun yaxshi' },
            'Hamkorbank Chirchiq BXM': { risk: 'PAST', npl: 1.8, action: 'SAVDO KREDITINI KENGAYTIRING', detail: 'Savdo markazlari uchun yaxshi natija' },
            'Hamkorbank Parkent BXM': { risk: 'O\'RTA', npl: 5.6, action: 'NAZORAT OSTIDA', detail: 'Kon sanoati muammolari' },
            'Milliy Bank Toshkent BXM': { risk: 'MINIMAL', npl: 1.4, action: 'KENGAYTIRING', detail: 'Korporativ segment uchun namuna' },
            'Milliy Bank Chirchiq BXM': { risk: 'MINIMAL', npl: 1.8, action: 'KENGAYTIRING', detail: 'Barqaror natijalar' },
            'Aloqabank Angren BXM': { risk: 'O\'RTA', npl: 5.1, action: 'NAZORAT OSTIDA', detail: 'Telekommunikatsiya sektoriga e\'tibor' },
            'Kapitalbank Chirchiq BXM': { risk: 'O\'RTA', npl: 4.1, action: 'DAVOM ETTIRING', detail: 'Kichik biznes uchun yaxshi' },
            'Orient Finans Chirchiq BXM': { risk: 'PAST', npl: 3.5, action: 'KENGAYTIRING', detail: 'Yaxshi natijalar, barqaror o\'sish' },
            'Davr Bank Chirchiq BXM': { risk: 'O\'RTA', npl: 4.8, action: 'EHTIYOTKORLIK BILAN', detail: 'Yangi filial, sinov davri' }
        };
        
        // ============== JISMONIY SHAXSLAR MA'LUMOTLARI ==============
        const jismoniyData = [
            { fio: 'Karimov Akbar Rustamovich', region: 'Chirchiq', amount: 245.5, bank: 'Ipoteka Bank', type: 'Ipoteka', status: 'Samarali', npl: false },
            { fio: 'Rahimova Dilnoza Tursunovna', region: 'Nurafshon', amount: 189.2, bank: 'Ipoteka Bank', type: 'Ipoteka', status: 'Samarali', npl: false },
            { fio: 'Toshmatov Sardor Aliyevich', region: 'Olmaliq', amount: 156.8, bank: 'Xalq Banki', type: 'Iste\'mol', status: 'Samarali', npl: false },
            { fio: 'Qodirov Jamshid Bahodirovich', region: 'Bekobod', amount: 134.5, bank: 'Agrobank', type: 'Mikrokredit', status: 'Muammoli', npl: false },
            { fio: 'Sultonova Munira Karimovna', region: 'Angren', amount: 128.9, bank: 'Ipoteka Bank', type: 'Ipoteka', status: 'Samarali', npl: false },
            { fio: 'Normatov Sherzod Ergashovich', region: 'Yangiyo\'l', amount: 98.6, bank: 'Mikrokreditbank', type: 'Mikrokredit', status: 'NPL', npl: true },
            { fio: 'Abdullayeva Feruza Saidovna', region: 'Parkent', amount: 87.4, bank: 'Xalq Banki', type: 'Ta\'lim', status: 'Samarali', npl: false },
            { fio: 'Yusupov Bekzod Narzullayevich', region: 'Chirchiq', amount: 76.5, bank: 'Turonbank', type: 'Iste\'mol', status: 'Samarali', npl: false },
            { fio: 'Xolmatov Dilshod Rahimovich', region: 'Oqqo\'rg\'on', amount: 67.8, bank: 'Agrobank', type: 'Mikrokredit', status: 'NPL', npl: true },
            { fio: 'Salimova Gulnora Toshpulatovna', region: 'Chinoz', amount: 54.3, bank: 'Hamkorbank', type: 'Mikrokredit', status: 'Samarali', npl: false },
            { fio: 'Ismoilov Otabek Nematovich', region: 'Qibray', amount: 178.7, bank: 'Ipoteka Bank', type: 'Ipoteka', status: 'Samarali', npl: false },
            { fio: 'Raximov Ulug\'bek Shavkatovich', region: 'Zangiota', amount: 45.6, bank: 'Xalq Banki', type: 'Ta\'lim', status: 'Samarali', npl: false },
            { fio: 'Turgunova Saida Yusufovna', region: 'O\'rtachirchiq', amount: 78.9, bank: 'BRB', type: 'Mikrokredit', status: 'NPL', npl: true },
            { fio: 'Mamadaliyev Farhod Qosimovich', region: 'Quyichirchiq', amount: 112.3, bank: 'Milliy Bank', type: 'Iste\'mol', status: 'Samarali', npl: false },
            { fio: 'Qurbonova Malika Anvarovna', region: 'Chirchiq', amount: 165.4, bank: 'Ipoteka Bank', type: 'Ipoteka', status: 'Samarali', npl: false },
            { fio: 'Bekmurodov Jasur Xayitovich', region: 'Nurafshon', amount: 43.2, bank: 'Mikrokreditbank', type: 'Mikrokredit', status: 'Muammoli', npl: false },
            { fio: 'Sharipova Zarina Ilhomovna', region: 'Olmaliq', amount: 98.7, bank: 'Asaka Bank', type: 'Avto kredit', status: 'Samarali', npl: false },
            { fio: 'Raxmatullayev Bobur Shuhratovich', region: 'Bekobod', amount: 234.5, bank: 'Ipoteka Bank', type: 'Ipoteka', status: 'Samarali', npl: false },
            { fio: 'Ergasheva Mohira Anvarovna', region: 'Angren', amount: 56.8, bank: 'Xalq Banki', type: 'Ta\'lim', status: 'Samarali', npl: false },
            { fio: 'Tojiboev Alisher Rustamovich', region: 'Yangiyo\'l', amount: 87.9, bank: 'BRB', type: 'Mikrokredit', status: 'NPL', npl: true },
            { fio: 'Jumayeva Nafisa Karimovna', region: 'Parkent', amount: 145.6, bank: 'Ipoteka Bank', type: 'Ipoteka', status: 'Samarali', npl: false },
            { fio: 'Mirzayev Shoxrux Nodirovich', region: 'Toshkent shahar', amount: 67.4, bank: 'Turonbank', type: 'Iste\'mol', status: 'Samarali', npl: false },
            { fio: 'Qosimova Dilbar Tursunovna', region: 'Oqqo\'rg\'on', amount: 34.5, bank: 'Mikrokreditbank', type: 'Mikrokredit', status: 'NPL', npl: true },
            { fio: 'Olimov Sanjar Erkinovich', region: 'Chirchiq', amount: 289.3, bank: 'Ipoteka Bank', type: 'Ipoteka', status: 'Samarali', npl: false },
            { fio: 'Nazarova Shoira Kamalovna', region: 'Nurafshon', amount: 67.8, bank: 'Hamkorbank', type: 'Mikrokredit', status: 'Samarali', npl: false },
            { fio: 'Xudoyberdiyev Nodir Toshmatovich', region: 'Olmaliq', amount: 123.4, bank: 'Uzsanoatqurilishbank', type: 'Iste\'mol', status: 'Samarali', npl: false },
            { fio: 'Sodiqova Madina Rustamovna', region: 'Bekobod', amount: 45.6, bank: 'Xalq Banki', type: 'Ta\'lim', status: 'Samarali', npl: false },
            { fio: 'Tursunov Farrux Anvarovich', region: 'Angren', amount: 78.9, bank: 'BRB', type: 'Mikrokredit', status: 'NPL', npl: true },
            { fio: 'Karimova Zilola Shavkatovna', region: 'Yangiyo\'l', amount: 156.7, bank: 'Ipoteka Bank', type: 'Ipoteka', status: 'Muammoli', npl: false },
            { fio: 'Axmedov Javohir Nodirovich', region: 'Parkent', amount: 89.2, bank: 'Kapitalbank', type: 'Iste\'mol', status: 'Samarali', npl: false }
        ];
        
        // ============== YURIDIK SHAXSLAR MA'LUMOTLARI ==============
        const yuridikData = [
            { name: 'AZIA TASHKENT TEXTILE LLC', stir: '301234567', region: 'Chirchiq', amount: 1347.6, banks: 'Uzsanoat, Asaka, Milliy', sector: 'To\'qimachilik', status: 'Samarali', npl: false },
            { name: 'AGROMAX TECHNIC MChJ', stir: '302345678', region: 'Zangiota', amount: 1130.0, banks: 'Agrobank, Xalq Banki', sector: 'Qishloq xo\'jaligi', status: 'Samarali', npl: false },
            { name: 'GTG AGRO EXPORT LLC', stir: '303456789', region: 'Quyichirchiq', amount: 890.5, banks: 'Agrobank, Hamkorbank', sector: 'Eksport', status: 'Samarali', npl: false },
            { name: 'TASHKENT CONSTRUCTION GROUP', stir: '304567890', region: 'Bo\'stonliq', amount: 756.0, banks: 'Uzsanoat, Ipoteka, Milliy', sector: 'Qurilish', status: 'Samarali', npl: false },
            { name: 'REAL TEX TASHKENT MChJ', stir: '305678901', region: 'Chirchiq', amount: 359.6, banks: 'Asaka, Uzsanoat, BRB', sector: 'Ishlab chiqarish', status: 'NPL', npl: true },
            { name: 'OQQORGON PAXTA SANOAT', stir: '306789012', region: 'Oqqo\'rg\'on', amount: 127.5, banks: 'Agrobank, Xalq Banki', sector: 'Qishloq xo\'jaligi', status: 'NPL', npl: true },
            { name: 'CHIRCHIQ TRANSFORMER ZAVODI', stir: '307890123', region: 'Chirchiq', amount: 78.2, banks: 'Uzsanoat, BRB', sector: 'Sanoat', status: 'NPL', npl: true },
            { name: 'OLMALIQ GOLD MINING', stir: '308901234', region: 'Olmaliq', amount: 534.0, banks: 'Asaka, Uzsanoat', sector: 'Kon sanoati', status: 'Samarali', npl: false },
            { name: 'CHIRCHIQ PHARMA PLUS', stir: '309012345', region: 'Chirchiq', amount: 456.0, banks: 'Milliy, Xalq Banki', sector: 'Farmatsevtika', status: 'Samarali', npl: false },
            { name: 'BEKOBOD STEEL FACTORY', stir: '310123456', region: 'Bekobod', amount: 345.0, banks: 'Uzsanoat, BRB', sector: 'Metallurgiya', status: 'Samarali', npl: false },
            { name: 'ANGREN MINING SERVICES', stir: '311234567', region: 'Angren', amount: 312.0, banks: 'BRB, Uzsanoat', sector: 'Kon xizmatlari', status: 'Samarali', npl: false },
            { name: 'NURAFSHON LOGISTICS CENTER', stir: '312345678', region: 'Nurafshon', amount: 287.0, banks: 'Hamkorbank, Xalq Banki', sector: 'Logistika', status: 'Samarali', npl: false },
            { name: 'PARKENT MARMAR KONLARI', stir: '313456789', region: 'Parkent', amount: 54.6, banks: 'Hamkorbank, Aloqabank', sector: 'Kon sanoati', status: 'NPL', npl: true },
            { name: 'GRAND TEXTILE CHIRCHIQ', stir: '314567890', region: 'Chirchiq', amount: 45.7, banks: 'BRB', sector: 'To\'qimachilik', status: 'NPL', npl: true },
            { name: 'TASHKENT METALS MChJ', stir: '315678901', region: 'Olmaliq', amount: 36.0, banks: 'BRB, Asaka', sector: 'Metallurgiya', status: 'NPL', npl: true },
            { name: 'UK REAL AGRO COTTON', stir: '316789012', region: 'Chinoz', amount: 678.0, banks: 'Agrobank', sector: 'Paxta', status: 'Samarali', npl: false },
            { name: 'YANGIYO\'L INDUSTRIAL PARK', stir: '317890123', region: 'Yangiyo\'l', amount: 423.0, banks: 'Uzsanoat, Milliy', sector: 'Sanoat zona', status: 'Muammoli', npl: false },
            { name: 'BO\'STONLIQ RESORT COMPLEX', stir: '318901234', region: 'Bo\'stonliq', amount: 398.0, banks: 'Ipoteka, Hamkorbank', sector: 'Turizm', status: 'Muammoli', npl: false },
            { name: 'ANGREN ISSIQLIK TARMOG\'I', stir: '319012345', region: 'Angren', amount: 38.7, banks: 'Mikrokreditbank, BRB', sector: 'Kommunal', status: 'NPL', npl: true },
            { name: 'FRESH FRUITS EXPORT CO', stir: '320123456', region: 'Qibray', amount: 32.7, banks: 'Mikrokreditbank, Xalq, Hamkor', sector: 'Savdo', status: 'Muammoli', npl: false }
        ];
        
        // ============== YATT MA'LUMOTLARI ==============
        const yattData = [
            { name: 'Karimov A.R. (Qurilish)', region: 'Chirchiq', amount: 145.6, bank: 'Xalq Banki', activity: 'Qurilish ishlari', status: 'Samarali', npl: false },
            { name: 'Rahimov S.T. (Savdo)', region: 'Nurafshon', amount: 98.7, bank: 'Hamkorbank', activity: 'Ulgurji savdo', status: 'Samarali', npl: false },
            { name: 'Toshmatov D.A. (Fermer)', region: 'Oqqo\'rg\'on', amount: 87.4, bank: 'Agrobank', activity: 'Fermer xo\'jaligi', status: 'Muammoli', npl: false },
            { name: 'Qodirov J.B. (Transport)', region: 'Bekobod', amount: 76.5, bank: 'Mikrokreditbank', activity: 'Yuk tashish', status: 'Samarali', npl: false },
            { name: 'Sultonov M.K. (Xizmat)', region: 'Angren', amount: 67.8, bank: 'Xalq Banki', activity: 'Xizmat ko\'rsatish', status: 'NPL', npl: true },
            { name: 'Normatova F.S. (Savdo)', region: 'Yangiyo\'l', amount: 56.4, bank: 'Hamkorbank', activity: 'Chakana savdo', status: 'NPL', npl: true },
            { name: 'Abdullayev B.N. (Ta\'mir)', region: 'Parkent', amount: 45.6, bank: 'Mikrokreditbank', activity: 'Avto ta\'mir', status: 'Samarali', npl: false },
            { name: 'Yusupova G.T. (Tikuvchilik)', region: 'Bo\'stonliq', amount: 34.5, bank: 'Xalq Banki', activity: 'Tikuvchilik', status: 'Samarali', npl: false },
            { name: 'Xolmatova D.R. (Oziq-ovqat)', region: 'Chinoz', amount: 78.9, bank: 'Agrobank', activity: 'Oziq-ovqat ishlab chiqarish', status: 'Samarali', npl: false },
            { name: 'Salimov O.N. (Fermer)', region: 'Qibray', amount: 123.4, bank: 'Agrobank', activity: 'Fermer xo\'jaligi', status: 'Samarali', npl: false },
            { name: 'Ismoilova Z.I. (Go\'zallik)', region: 'Zangiota', amount: 23.4, bank: 'Mikrokreditbank', activity: 'Go\'zallik saloni', status: 'Samarali', npl: false },
            { name: 'Raximov U.S. (Qurilish)', region: 'O\'rtachirchiq', amount: 167.8, bank: 'Uzsanoatqurilishbank', activity: 'Qurilish ishlari', status: 'Muammoli', npl: false },
            { name: 'Turgunov S.Y. (Savdo)', region: 'Quyichirchiq', amount: 45.6, bank: 'Hamkorbank', activity: 'Savdo', status: 'NPL', npl: true },
            { name: 'Mamadaliyeva M.A. (Xizmat)', region: 'Chirchiq', amount: 34.5, bank: 'Kapitalbank', activity: 'Xizmat ko\'rsatish', status: 'Samarali', npl: false },
            { name: 'Qurbonov J.R. (Transport)', region: 'Nurafshon', amount: 89.7, bank: 'Davr Bank', activity: 'Transport xizmatlari', status: 'Samarali', npl: false },
            { name: 'Bekmurodova Z.I. (Fermer)', region: 'Olmaliq', amount: 56.8, bank: 'Agrobank', activity: 'Fermer xo\'jaligi', status: 'Muammoli', npl: false },
            { name: 'Sharipov J.X. (IT)', region: 'Chirchiq', amount: 78.9, bank: 'Aloqabank', activity: 'IT xizmatlari', status: 'Samarali', npl: false },
            { name: 'Raxmatullayeva M.B. (Ta\'lim)', region: 'Bekobod', amount: 23.4, bank: 'Xalq Banki', activity: 'Ta\'lim xizmatlari', status: 'Samarali', npl: false },
            { name: 'Ergashov A.M. (Oziq-ovqat)', region: 'Angren', amount: 67.8, bank: 'Mikrokreditbank', activity: 'Non mahsulotlari', status: 'NPL', npl: true },
            { name: 'Tojiboeva N.K. (Savdo)', region: 'Yangiyo\'l', amount: 45.6, bank: 'Hamkorbank', activity: 'Chakana savdo', status: 'Samarali', npl: false }
        ];
        
        const problemClients = [
            { name: 'REAL TEX TASHKENT', totalDebt: 359.59, efficiency: 12.6, region: 'Toshkent tumani', collateral: 'Zavod binosi, uskunalar', loans: [
                { bank: 'Asaka Bank', branch: 'Asaka Bank Toshkent BXM', amount: 245.00, sector: 'Ishlab chiqarish', status: 'NPL', is95413: false },
                { bank: 'Uzsanoatqurilishbank', branch: 'Uzsanoat Toshkent BXM', amount: 78.50, sector: 'Ishlab chiqarish', status: 'Muammoli', is95413: false },
                { bank: 'BRB', branch: 'BRB Toshkent BXM', amount: 36.09, sector: 'Ishlab chiqarish', status: 'NPL', is95413: true }
            ], rec: 'ZUDLIK bilan barcha banklarda sud! BRB dagi 36 mlrd 95413da yashirilgan!' },
            { name: 'OQQORGON PAXTA SANOAT', totalDebt: 127.50, efficiency: 18.4, region: 'Oqqo\'rg\'on tumani', collateral: 'Paxta zavodi, texnika', loans: [
                { bank: 'Agrobank', branch: 'Agrobank Toshkent BXM', amount: 67.00, sector: 'Qishloq xo\'jaligi', status: 'NPL', is95413: false },
                { bank: 'Agrobank', branch: 'Agrobank Oqqo\'rg\'on BXM', amount: 38.50, sector: 'Qishloq xo\'jaligi', status: 'Muammoli', is95413: false },
                { bank: 'Xalq Banki', branch: 'Xalq Banki Oqqo\'rg\'on BXM', amount: 22.00, sector: 'Qishloq xo\'jaligi', status: 'NPL', is95413: true }
            ], rec: '3 bankda kredit. Xalq Bankidagi 22 mlrd 95413da. Paxta mavsumidan keyin qayta tuzilish.' },
            { name: 'TOSHKENT VILOYATI HOKIMLIGI', totalDebt: 89.30, efficiency: 45.2, region: 'Nurafshon', collateral: 'Davlat kafolati', loans: [
                { bank: 'Asaka Bank', branch: 'Asaka Bank Toshkent BXM', amount: 45.00, sector: 'Davlat', status: 'Muammoli', is95413: false },
                { bank: 'Milliy Bank', branch: 'Milliy Bank Toshkent BXM', amount: 28.30, sector: 'Davlat', status: 'Standart', is95413: false },
                { bank: 'Ipoteka Bank', branch: 'Ipoteka Bank Toshkent BXM', amount: 16.00, sector: 'Qurilish', status: 'Muammoli', is95413: false }
            ], rec: 'Davlat tashkiloti - Moliya vazirligi bilan muzokaralar.' },
            { name: 'CHIRCHIQ TRANSFORMER', totalDebt: 78.20, efficiency: 22.5, region: 'Chirchiq shahar', collateral: 'Zavod binolari', loans: [
                { bank: 'Uzsanoatqurilishbank', branch: 'Uzsanoat Chirchiq BXM', amount: 52.00, sector: 'Ishlab chiqarish', status: 'NPL', is95413: false },
                { bank: 'BRB', branch: 'BRB Chirchiq BXM', amount: 26.20, sector: 'Ishlab chiqarish', status: 'NPL', is95413: true }
            ], rec: 'Ishlab chiqarish to\'xtagan. BRB krediti 95413da. Aktivlarni baholang.' },
            { name: 'YANGIYO\'L AGRO CLUSTER', totalDebt: 67.80, efficiency: 31.0, region: 'Yangiyo\'l tumani', collateral: 'Yer 150 ga, texnika', loans: [
                { bank: 'Agrobank', branch: 'Agrobank Yangiyo\'l BXM', amount: 42.00, sector: 'Qishloq xo\'jaligi', status: 'Muammoli', is95413: false },
                { bank: 'Mikrokreditbank', branch: 'Mikrokreditbank Yangiyo\'l BXM', amount: 25.80, sector: 'Qishloq xo\'jaligi', status: 'NPL', is95413: false }
            ], rec: 'Klaster - bir nechta fermer. Qayta tuzilish imkoniyati bor.' },
            { name: 'EUROGARDEN EXPORT', totalDebt: 52.79, efficiency: 0, region: 'Zangiota tumani', collateral: 'Issiqxona 5 ga', loans: [
                { bank: 'Xalq Banki', branch: 'Xalq Banki Toshkent BXM', amount: 36.49, sector: 'Qishloq xo\'jaligi', status: 'Sud', is95413: true },
                { bank: 'Agrobank', branch: 'Agrobank Zangiota BXM', amount: 16.30, sector: 'Qishloq xo\'jaligi', status: 'NPL', is95413: true }
            ], rec: 'BARCHA KREDITLAR 95413DA! 52.79 mlrd yashirilgan.' },
            { name: 'PARKENT MARMAR', totalDebt: 54.60, efficiency: 15.8, region: 'Parkent tumani', collateral: 'Marmar koni', loans: [
                { bank: 'Hamkorbank', branch: 'Hamkorbank Parkent BXM', amount: 34.60, sector: 'Kon sanoati', status: 'NPL', is95413: false },
                { bank: 'Aloqabank', branch: 'Aloqabank Toshkent BXM', amount: 20.00, sector: 'Kon sanoati', status: 'Sud', is95413: true }
            ], rec: 'Kon litsenziyasi muammosi. Aloqabank krediti 95413da.' },
            { name: 'OLMALIQ METAL KONSTRUKSIYA', totalDebt: 48.90, efficiency: 8.5, region: 'Olmaliq shahar', collateral: 'Sexlar, uskunalar', loans: [
                { bank: 'Asaka Bank', branch: 'Asaka Bank Olmaliq BXM', amount: 32.00, sector: 'Ishlab chiqarish', status: 'NPL', is95413: true },
                { bank: 'Xalq Banki', branch: 'Xalq Banki Olmaliq BXM', amount: 16.90, sector: 'Ishlab chiqarish', status: 'NPL', is95413: true }
            ], rec: 'BARCHA KREDITLAR 95413DA! Korxona to\'xtagan.' },
            { name: 'GRAND TEXTILE', totalDebt: 45.65, efficiency: 0, region: 'Chirchiq', collateral: 'Fabrika', loans: [
                { bank: 'BRB', branch: 'BRB Toshkent BXM', amount: 28.45, sector: 'Ishlab chiqarish', status: 'NPL', is95413: true },
                { bank: 'BRB', branch: 'BRB Chirchiq BXM', amount: 17.20, sector: 'Ishlab chiqarish', status: 'NPL', is95413: true }
            ], rec: 'IKKI KREDIT HAM 95413DA! Hammasi BRB da.' },
            { name: 'BO\'STONLIQ RESORT', totalDebt: 43.25, efficiency: 28.0, region: 'Bo\'stonliq tumani', collateral: 'Dam olish maskani', loans: [
                { bank: 'Ipoteka Bank', branch: 'Ipoteka Bank Bo\'stonliq BXM', amount: 28.00, sector: 'Turizm', status: 'Muammoli', is95413: false },
                { bank: 'Turonbank', branch: 'Turonbank Zangiota BXM', amount: 15.25, sector: 'Turizm', status: 'Muammoli', is95413: false }
            ], rec: 'Mavsumiy biznes - yozda daromad. Grafik qayta ko\'rilsin.' },
            { name: 'ANGREN ISSIQLIK', totalDebt: 38.70, efficiency: 19.2, region: 'Angren shahar', collateral: 'Qozonxona uskunalari', loans: [
                { bank: 'Mikrokreditbank', branch: 'Mikrokreditbank Angren BXM', amount: 23.50, sector: 'Kommunal', status: 'NPL', is95413: false },
                { bank: 'BRB', branch: 'BRB Angren BXM', amount: 15.20, sector: 'Kommunal', status: 'NPL', is95413: true }
            ], rec: 'Kommunal korxona - hokimlik bilan ishlang.' },
            { name: 'TASHKENT METALS', totalDebt: 35.95, efficiency: 0, region: 'Olmaliq shahar', collateral: 'Metall zahiralari', loans: [
                { bank: 'BRB', branch: 'BRB Chirchiq BXM', amount: 19.75, sector: 'Sanoat', status: 'Sud', is95413: true },
                { bank: 'Asaka Bank', branch: 'Asaka Bank Olmaliq BXM', amount: 16.20, sector: 'Sanoat', status: 'NPL', is95413: true }
            ], rec: 'IKKI KREDIT HAM 95413DA!' },
            { name: 'FRESH FRUITS CO', totalDebt: 32.70, efficiency: 42.0, region: 'Qibray tumani', collateral: 'Sovutgich ombori', loans: [
                { bank: 'Mikrokreditbank', branch: 'Mikrokreditbank Toshkent BXM', amount: 17.20, sector: 'Savdo', status: 'Muammoli', is95413: false },
                { bank: 'Xalq Banki', branch: 'Xalq Banki Qibray BXM', amount: 9.50, sector: 'Savdo', status: 'Samarali', is95413: false },
                { bank: 'Hamkorbank', branch: 'Hamkorbank Toshkent BXM', amount: 6.00, sector: 'Savdo', status: 'Muammoli', is95413: false }
            ], rec: '1 ta kredit samarali. Mavsumda to\'lash mumkin.' },
            { name: 'GOLDEN HARVEST FARM', totalDebt: 26.85, efficiency: 0, region: 'Chinoz tumani', collateral: 'Yer 15 ga', loans: [
                { bank: 'Agrobank', branch: 'Agrobank Toshkent BXM', amount: 14.85, sector: 'Qishloq xo\'jaligi', status: 'Sud', is95413: true },
                { bank: 'Agrobank', branch: 'Agrobank Chinoz BXM', amount: 12.00, sector: 'Qishloq xo\'jaligi', status: 'Sud', is95413: true }
            ], rec: 'IKKI KREDIT HAM 95413DA!' },
            { name: 'PARKENT STONE QUARRY', totalDebt: 24.50, efficiency: 30.0, region: 'Parkent tumani', collateral: 'Tosh kon\'i', loans: [
                { bank: 'Uzsanoatqurilishbank', branch: 'Uzsanoat Parkent BXM', amount: 18.50, sector: 'Sanoat', status: 'Muammoli', is95413: false },
                { bank: 'BRB', branch: 'BRB Toshkent BXM', amount: 6.00, sector: 'Sanoat', status: 'NPL', is95413: true }
            ], rec: 'BRB dagi 6 mlrd 95413da.' }
        ];
        
        const goodClients = [
            { name: 'AZIA TASHKENT TEXTILE', totalCredit: 1347.6, efficiency: 100, history: '5 yil', region: 'Toshkent', creditLimit: 2000, loans: [
                { bank: 'Uzsanoatqurilishbank', branch: 'Uzsanoat Toshkent BXM', amount: 850.0, sector: 'Ishlab chiqarish' },
                { bank: 'Asaka Bank', branch: 'Asaka Bank Toshkent BXM', amount: 320.0, sector: 'Ishlab chiqarish' },
                { bank: 'Milliy Bank', branch: 'Milliy Bank Toshkent BXM', amount: 177.6, sector: 'Ishlab chiqarish' }
            ], rec: 'ENG YIRIK! 3 bankda kredit - hammasi 100% samarali. VIP mijoz.' },
            { name: 'AGROMAX TECHNIC', totalCredit: 1130.0, efficiency: 100, history: '7 yil', region: 'Zangiota', creditLimit: 1500, loans: [
                { bank: 'Agrobank', branch: 'Agrobank Toshkent BXM', amount: 650.0, sector: 'Qishloq xo\'jaligi' },
                { bank: 'Agrobank', branch: 'Agrobank Chirchiq BXM', amount: 280.0, sector: 'Qishloq xo\'jaligi' },
                { bank: 'Xalq Banki', branch: 'Xalq Banki Zangiota BXM', amount: 200.0, sector: 'Qishloq xo\'jaligi' }
            ], rec: '7 yillik hamkorlik - eng uzoq muddatli! Qo\'shimcha kredit limit.' },
            { name: 'GTG AGRO EXPORT', totalCredit: 890.5, efficiency: 99, history: '4 yil', region: 'Quyichirchiq', creditLimit: 1100, loans: [
                { bank: 'Agrobank', branch: 'Agrobank Chirchiq BXM', amount: 520.0, sector: 'Qishloq xo\'jaligi' },
                { bank: 'Hamkorbank', branch: 'Hamkorbank Toshkent BXM', amount: 370.5, sector: 'Qishloq xo\'jaligi' }
            ], rec: '99% samaradorlik. Eksport potensiali yuqori.' },
            { name: 'TASHKENT CONSTRUCTION GROUP', totalCredit: 756.0, efficiency: 100, history: '8 yil', region: 'Bo\'stonliq', creditLimit: 1000, loans: [
                { bank: 'Uzsanoatqurilishbank', branch: 'Uzsanoat Toshkent BXM', amount: 456.0, sector: 'Qurilish' },
                { bank: 'Ipoteka Bank', branch: 'Ipoteka Bank Bo\'stonliq BXM', amount: 200.0, sector: 'Qurilish' },
                { bank: 'Milliy Bank', branch: 'Milliy Bank Toshkent BXM', amount: 100.0, sector: 'Qurilish' }
            ], rec: '8 yillik ENG ISHONCHLI qurilish kompaniyasi!' },
            { name: 'UK REAL AGRO COTTON', totalCredit: 678.0, efficiency: 100, history: '6 yil', region: 'Chinoz', creditLimit: 850, loans: [
                { bank: 'Agrobank', branch: 'Agrobank Toshkent BXM', amount: 430.0, sector: 'Qishloq xo\'jaligi' },
                { bank: 'Agrobank', branch: 'Agrobank Chinoz BXM', amount: 248.0, sector: 'Qishloq xo\'jaligi' }
            ], rec: 'Yirik paxta yetishtiruvchi. Eksport kontraktlari.' },
            { name: 'OLMALIQ GOLD MINING', totalCredit: 534.0, efficiency: 100, history: '5 yil', region: 'Olmaliq', creditLimit: 700, loans: [
                { bank: 'Asaka Bank', branch: 'Asaka Bank Olmaliq BXM', amount: 334.0, sector: 'Sanoat' },
                { bank: 'Uzsanoatqurilishbank', branch: 'Uzsanoat Olmaliq BXM', amount: 200.0, sector: 'Sanoat' }
            ], rec: 'Oltin qazib olish - barqaror daromad.' },
            { name: 'CHIRCHIQ PHARMA PLUS', totalCredit: 456.0, efficiency: 98, history: '3 yil', region: 'Chirchiq', creditLimit: 600, loans: [
                { bank: 'Milliy Bank', branch: 'Milliy Bank Chirchiq BXM', amount: 256.0, sector: 'Ishlab chiqarish' },
                { bank: 'Xalq Banki', branch: 'Xalq Banki Chirchiq BXM', amount: 200.0, sector: 'Ishlab chiqarish' }
            ], rec: 'Dori ishlab chiqaruvchi - yuqori talab.' },
            { name: 'PARKENT RESORT HOTEL', totalCredit: 398.0, efficiency: 100, history: '4 yil', region: 'Parkent', creditLimit: 500, loans: [
                { bank: 'Ipoteka Bank', branch: 'Ipoteka Bank Parkent BXM', amount: 280.0, sector: 'Xizmat ko\'rsatish' },
                { bank: 'Turonbank', branch: 'Turonbank Zangiota BXM', amount: 118.0, sector: 'Xizmat ko\'rsatish' }
            ], rec: 'Turizm yetakchisi.' },
            { name: 'BEKOBOD STEEL FACTORY', totalCredit: 345.0, efficiency: 99, history: '5 yil', region: 'Bekobod', creditLimit: 450, loans: [
                { bank: 'Uzsanoatqurilishbank', branch: 'Uzsanoat Bekobod BXM', amount: 245.0, sector: 'Sanoat' },
                { bank: 'BRB', branch: 'BRB Bekobod BXM', amount: 100.0, sector: 'Sanoat' }
            ], rec: 'Po\'lat ishlab chiqarish - barqaror.' },
            { name: 'ANGREN MINING SERVICES', totalCredit: 312.0, efficiency: 100, history: '6 yil', region: 'Angren', creditLimit: 400, loans: [
                { bank: 'BRB', branch: 'BRB Angren BXM', amount: 212.0, sector: 'Xizmat ko\'rsatish' },
                { bank: 'Uzsanoatqurilishbank', branch: 'Uzsanoat Angren BXM', amount: 100.0, sector: 'Xizmat ko\'rsatish' }
            ], rec: 'Kon xizmatlari. 6 yil 100% to\'lov.' },
            { name: 'METRO TRADE CENTER', totalCredit: 287.0, efficiency: 100, history: '4 yil', region: 'Chirchiq', creditLimit: 350, loans: [
                { bank: 'Xalq Banki', branch: 'Xalq Banki Chirchiq BXM', amount: 187.0, sector: 'Savdo' },
                { bank: 'Hamkorbank', branch: 'Hamkorbank Chirchiq BXM', amount: 100.0, sector: 'Savdo' }
            ], rec: 'Savdo markazi - barqaror.' },
            { name: 'GREEN VALLEY FARMS', totalCredit: 234.0, efficiency: 98, history: '3 yil', region: 'O\'rtachirchiq', creditLimit: 300, loans: [
                { bank: 'Agrobank', branch: 'Agrobank Chirchiq BXM', amount: 154.0, sector: 'Qishloq xo\'jaligi' },
                { bank: 'Mikrokreditbank', branch: 'Mikrokreditbank Chirchiq BXM', amount: 80.0, sector: 'Qishloq xo\'jaligi' }
            ], rec: 'Zamonaviy fermer xo\'jaligi.' },
            { name: 'TASHKENT FURNITURE HOUSE', totalCredit: 198.0, efficiency: 100, history: '5 yil', region: 'Yangiyo\'l', creditLimit: 250, loans: [
                { bank: 'Asaka Bank', branch: 'Asaka Bank Yangiyo\'l BXM', amount: 128.0, sector: 'Ishlab chiqarish' },
                { bank: 'Mikrokreditbank', branch: 'Mikrokreditbank Yangiyo\'l BXM', amount: 70.0, sector: 'Ishlab chiqarish' }
            ], rec: 'Mebel ishlab chiqarish. 5 yil 100%.' },
            { name: 'NURAFSHON LOGISTICS', totalCredit: 176.0, efficiency: 99, history: '4 yil', region: 'Nurafshon', creditLimit: 220, loans: [
                { bank: 'Hamkorbank', branch: 'Hamkorbank Toshkent BXM', amount: 106.0, sector: 'Xizmat ko\'rsatish' },
                { bank: 'Xalq Banki', branch: 'Xalq Banki Nurafshon BXM', amount: 70.0, sector: 'Xizmat ko\'rsatish' }
            ], rec: 'Logistika - barqaror faoliyat.' },
            { name: 'SUNRISE TEXTILES', totalCredit: 156.0, efficiency: 100, history: '3 yil', region: 'Toshkent', creditLimit: 200, loans: [
                { bank: 'Asaka Bank', branch: 'Asaka Bank Toshkent BXM', amount: 98.0, sector: 'Ishlab chiqarish' },
                { bank: 'Milliy Bank', branch: 'Milliy Bank Toshkent BXM', amount: 58.0, sector: 'Ishlab chiqarish' }
            ], rec: 'To\'qimachilik. 100% samaradorlik.' }
        ];
        
        // ============== BANK RADAR GLOBAL FUNCTIONS ==============
        // 18 TA BANK - REAL MA'LUMOTLAR RADAR CHART UCHUN
        // Har bir bank uchun: [NPL%, Portfel (trln), Mijozlar (ming), Filiallar, Samaradorlik%]
        const bankRadarData = {
            'Agrobank': { 
                data: [6.88, 6.97, 42.4, 12, 72],
                realData: { npl: '6.88%', portfel: '6.97 trln', mijoz: '42,431', filial: '12 ta', samaradorlik: '72%' },
                color: '#10b981' 
            },
            'Uzsanoatqurilishbank': { 
                data: [3.73, 3.41, 26.3, 8, 78],
                realData: { npl: '3.73%', portfel: '3.41 trln', mijoz: '26,255', filial: '8 ta', samaradorlik: '78%' },
                color: '#3b82f6' 
            },
            'Ipoteka Bank': { 
                data: [2.30, 2.93, 38.7, 8, 82],
                realData: { npl: '2.30%', portfel: '2.93 trln', mijoz: '38,684', filial: '8 ta', samaradorlik: '82%' },
                color: '#8b5cf6' 
            },
            'Xalq Banki': { 
                data: [2.99, 2.33, 50.0, 18, 75],
                realData: { npl: '2.99%', portfel: '2.33 trln', mijoz: '50,005', filial: '18 ta', samaradorlik: '75%' },
                color: '#f59e0b' 
            },
            'Milliy Bank': { 
                data: [1.00, 2.10, 26.6, 6, 85],
                realData: { npl: '1.00%', portfel: '2.10 trln', mijoz: '26,563', filial: '6 ta', samaradorlik: '85%' },
                color: '#06b6d4' 
            },
            'BRB': { 
                data: [7.24, 1.59, 19.2, 5, 45],
                realData: { npl: '7.24%', portfel: '1.59 trln', mijoz: '19,187', filial: '5 ta', samaradorlik: '45%' },
                color: '#ef4444' 
            },
            'Hamkorbank': { 
                data: [1.18, 1.29, 15.0, 6, 88],
                realData: { npl: '1.18%', portfel: '1.29 trln', mijoz: '14,953', filial: '6 ta', samaradorlik: '88%' },
                color: '#ec4899' 
            },
            'Turonbank': { 
                data: [0.13, 1.23, 3.2, 1, 98],
                realData: { npl: '0.13%', portfel: '1.23 trln', mijoz: '3,163', filial: '1 ta', samaradorlik: '98%' },
                color: '#84cc16' 
            },
            'Mikrokreditbank': { 
                data: [3.54, 1.14, 16.4, 10, 65],
                realData: { npl: '3.54%', portfel: '1.14 trln', mijoz: '16,388', filial: '10 ta', samaradorlik: '65%' },
                color: '#f97316' 
            },
            'Asaka Bank': { 
                data: [2.64, 1.12, 6.9, 3, 74],
                realData: { npl: '2.64%', portfel: '1.12 trln', mijoz: '6,928', filial: '3 ta', samaradorlik: '74%' },
                color: '#a855f7' 
            },
            'Infinbank': { 
                data: [0.00, 0.76, 2.8, 2, 85],
                realData: { npl: '0.00%', portfel: '0.76 trln', mijoz: '2,822', filial: '2 ta', samaradorlik: '85%' },
                color: '#0ea5e9' 
            },
            'Ipak Yo\'li Bank': { 
                data: [1.26, 0.65, 2.5, 2, 82],
                realData: { npl: '1.26%', portfel: '0.65 trln', mijoz: '2,463', filial: '2 ta', samaradorlik: '82%' },
                color: '#14b8a6' 
            },
            'Davr Bank': { 
                data: [0.33, 0.59, 3.0, 2, 95],
                realData: { npl: '0.33%', portfel: '0.59 trln', mijoz: '3,017', filial: '2 ta', samaradorlik: '95%' },
                color: '#d946ef' 
            },
            'Aloqabank': { 
                data: [3.14, 0.54, 5.6, 6, 68],
                realData: { npl: '3.14%', portfel: '0.54 trln', mijoz: '5,639', filial: '6 ta', samaradorlik: '68%' },
                color: '#22c55e' 
            },
            'Anor Bank': { 
                data: [0.25, 0.47, 15.3, 3, 90],
                realData: { npl: '0.25%', portfel: '0.47 trln', mijoz: '15,326', filial: '3 ta', samaradorlik: '90%' },
                color: '#eab308' 
            },
            'Hayot Bank': { 
                data: [1.21, 0.20, 1.4, 1, 75],
                realData: { npl: '1.21%', portfel: '0.20 trln', mijoz: '1,404', filial: '1 ta', samaradorlik: '75%' },
                color: '#f43f5e' 
            },
            'Garant Bank': { 
                data: [0.34, 0.19, 1.2, 3, 88],
                realData: { npl: '0.34%', portfel: '0.19 trln', mijoz: '1,160', filial: '3 ta', samaradorlik: '88%' },
                color: '#6366f1' 
            },
            'Universal Bank': { 
                data: [0.00, 0.09, 0.3, 1, 92],
                realData: { npl: '0.00%', portfel: '0.09 trln', mijoz: '323', filial: '1 ta', samaradorlik: '92%' },
                color: '#78716c' 
            }
        };
        
        let selectedBanks = ['Agrobank', 'Ipoteka Bank', 'Davr Bank'];
        let efficiencyChart = null;
        
        function renderBankSelector() {
            const container = document.getElementById('bankSelector');
            if (!container) return;
            container.innerHTML = Object.keys(bankRadarData).map(bank => 
                `<button class="bank-btn ${selectedBanks.includes(bank) ? 'active' : ''}" onclick="toggleBank('${bank}')" style="${selectedBanks.includes(bank) ? 'background:' + bankRadarData[bank].color : ''}">${bank.length > 12 ? bank.substring(0,10) + '..' : bank}</button>`
            ).join('');
        }
        
        function toggleBank(bank) {
            if (selectedBanks.includes(bank)) {
                if (selectedBanks.length > 1) {
                    selectedBanks = selectedBanks.filter(b => b !== bank);
                }
            } else {
                if (selectedBanks.length < 5) {
                    selectedBanks.push(bank);
                }
            }
            renderBankSelector();
            updateEfficiencyChart();
            updateBankMetricsInfo();
        }
        
        function updateBankMetricsInfo() {
            const container = document.getElementById('selectedBanksMetrics');
            if (!container) return;
            
            container.innerHTML = selectedBanks.map(bank => {
                const data = bankRadarData[bank];
                if (!data || !data.realData) return '';
                return `<div style="display:grid; grid-template-columns:repeat(6,1fr); gap:8px; text-align:center; padding:6px 0; border-bottom:1px solid var(--bg-tertiary);">
                    <div style="font-weight:600; color:${data.color}">${bank.length > 12 ? bank.substring(0,10) + '..' : bank}</div>
                    <div style="color:${parseFloat(data.realData.npl) > 4 ? '#ef4444' : '#10b981'}">${data.realData.npl}</div>
                    <div>${data.realData.portfel}</div>
                    <div>${data.realData.mijoz}</div>
                    <div>${data.realData.filial}</div>
                    <div style="color:${parseInt(data.realData.samaradorlik) > 70 ? '#10b981' : '#f59e0b'}">${data.realData.samaradorlik}</div>
                </div>`;
            }).join('');
        }
        
        function updateEfficiencyChart() {
            const col = getColors();
            const datasets = selectedBanks.map(bank => ({
                label: bank.length > 10 ? bank.substring(0,10) + '..' : bank,
                data: bankRadarData[bank].data,
                borderColor: bankRadarData[bank].color,
                backgroundColor: bankRadarData[bank].color + '33',
                borderWidth: 2,
                pointRadius: 4
            }));
            
            if (efficiencyChart) {
                efficiencyChart.data.datasets = datasets;
                efficiencyChart.update();
            }
        }
        
        function initBankRadar(col) {
            renderBankSelector();
            updateBankMetricsInfo();
            
            efficiencyChart = new Chart(document.getElementById('chartEfficiency'), {
                type: 'radar',
                data: { 
                    labels: ['NPL (%)', 'Portfel (trln)', 'Mijozlar (ming)', 'Filiallar', 'Samaradorlik (%)'], 
                    datasets: selectedBanks.map(bank => ({
                        label: bank.length > 10 ? bank.substring(0,10) + '..' : bank,
                        data: bankRadarData[bank].data,
                        borderColor: bankRadarData[bank].color,
                        backgroundColor: bankRadarData[bank].color + '33',
                        borderWidth: 2,
                        pointRadius: 4
                    }))
                },
                options: { 
                    responsive: true, 
                    maintainAspectRatio: false, 
                    plugins: { 
                        legend: { 
                            position: 'bottom',
                            labels: { color: col.txt, font: { size: 11 }, usePointStyle: true, padding: 15 } 
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const bank = context.dataset.label.replace('..', '');
                                    const fullBankName = Object.keys(bankRadarData).find(b => b.startsWith(bank)) || bank;
                                    const realData = bankRadarData[fullBankName]?.realData;
                                    const labelIndex = context.dataIndex;
                                    const labels = ['NPL', 'Portfel', 'Mijozlar', 'Filiallar', 'Samaradorlik'];
                                    const keys = ['npl', 'portfel', 'mijoz', 'filial', 'samaradorlik'];
                                    if (realData) {
                                        return `${fullBankName}: ${labels[labelIndex]} = ${realData[keys[labelIndex]]}`;
                                    }
                                    return `${context.dataset.label}: ${context.raw}`;
                                }
                            }
                        }
                    }, 
                    scales: { 
                        r: { 
                            grid: { color: col.grid }, 
                            ticks: { 
                                display: true,
                                color: col.txt,
                                font: { size: 9 },
                                backdropColor: 'transparent'
                            }, 
                            pointLabels: { color: col.txt, font: { size: 11 } },
                            suggestedMin: 0,
                            suggestedMax: 100
                        } 
                    } 
                }
            });
            charts.push(efficiencyChart);
        }
        
        // ============== BRANCH RADAR GLOBAL FUNCTIONS ==============
        const branchColors = ['#10b981', '#ef4444', '#3b82f6', '#f59e0b', '#8b5cf6', '#06b6d4', '#ec4899', '#84cc16'];
        let selectedBranchesRadar = [];
        let branchRadarChart = null;
        
        function getBranchRadarData(branch) {
            // NPL sifati (100 - npl*5, max 100, min 0)
            const nplScore = Math.max(0, Math.min(100, 100 - branch.npl * 8));
            // Samaradorlik (as is)
            const effScore = branch.efficiency;
            // Portfel (normalize to 100)
            const portfelScore = Math.min(100, branch.portfolio * 50);
            // Xodimlar samaradorligi (loans / staff)
            const staffEffScore = Math.min(100, (branch.loans / branch.staff) / 5);
            // 95413 sifati (100 - (95413/loans)*1000)
            const npl95413Score = Math.max(0, Math.min(100, 100 - (branch.npl95413 / branch.loans) * 500));
            
            return [nplScore, effScore, portfelScore, staffEffScore, npl95413Score];
        }
        
        function renderBranchRadarSelector() {
            const container = document.getElementById('branchRadarSelector');
            if (!container) return;
            
            // Sort branches by efficiency descending
            const sortedBranches = [...branchesData].sort((a, b) => b.efficiency - a.efficiency);
            
            container.innerHTML = sortedBranches.map((branch, idx) => {
                const fullName = `${branch.bank.substring(0,8)} - ${branch.branch.replace(' BXM', '')}`;
                const isSelected = selectedBranchesRadar.some(b => b.bank === branch.bank && b.branch === branch.branch);
                const colorClass = branch.npl < 4 ? 'good' : branch.npl > 8 ? 'bad' : '';
                return `<button class="branch-btn ${colorClass} ${isSelected ? 'active' : ''}" 
                    onclick="toggleBranchRadar(${idx})"
                    style="${isSelected ? 'background:' + branchColors[selectedBranchesRadar.findIndex(b => b.bank === branch.bank && b.branch === branch.branch) % branchColors.length] : ''}">
                    ${fullName}
                </button>`;
            }).join('');
        }
        
        function toggleBranchRadar(idx) {
            const sortedBranches = [...branchesData].sort((a, b) => b.efficiency - a.efficiency);
            const branch = sortedBranches[idx];
            
            const existingIdx = selectedBranchesRadar.findIndex(b => b.bank === branch.bank && b.branch === branch.branch);
            
            if (existingIdx >= 0) {
                selectedBranchesRadar.splice(existingIdx, 1);
            } else if (selectedBranchesRadar.length < 5) {
                selectedBranchesRadar.push(branch);
            }
            
            renderBranchRadarSelector();
            updateBranchRadarChart();
            updateBranchCompareInfo();
        }
        
        function updateBranchRadarChart() {
            const col = getColors();
            
            const datasets = selectedBranchesRadar.map((branch, idx) => ({
                label: `${branch.bank.substring(0,6)}-${branch.branch.replace(' BXM', '').substring(0,8)}`,
                data: getBranchRadarData(branch),
                borderColor: branchColors[idx % branchColors.length],
                backgroundColor: branchColors[idx % branchColors.length] + '33',
                borderWidth: 2,
                pointRadius: 4
            }));
            
            if (branchRadarChart) {
                branchRadarChart.data.datasets = datasets;
                branchRadarChart.update();
            }
        }
        
        function updateBranchCompareInfo() {
            const container = document.getElementById('branchCompareInfo');
            if (!container) return;
            
            if (selectedBranchesRadar.length === 0) {
                container.innerHTML = `
                    <div style="text-align:center;padding:40px;color:var(--text-muted)">
                        <div style="font-size:48px;margin-bottom:16px">üëÜ</div>
                        <p>Solishtirish uchun filiallarni tanlang</p>
                        <p style="font-size:12px;margin-top:8px">5 tagacha filial tanlash mumkin</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = selectedBranchesRadar.map((branch, idx) => {
                const nplClass = branch.npl > 8 ? 'text-red' : branch.npl > 4 ? 'text-yellow' : 'text-green';
                const effClass = branch.efficiency >= 85 ? 'text-green' : branch.efficiency >= 70 ? 'text-yellow' : 'text-red';
                
                return `
                    <div class="branch-compare-item" style="border-left: 4px solid ${branchColors[idx % branchColors.length]}">
                        <h5>
                            <span style="color:${branchColors[idx % branchColors.length]}">‚óè</span>
                            ${branch.bank} - ${branch.branch}
                        </h5>
                        <div class="stats">
                            <div class="stat">
                                <span class="stat-label">NPL</span>
                                <span class="stat-value ${nplClass}">${branch.npl}%</span>
                            </div>
                            <div class="stat">
                                <span class="stat-label">Samaradorlik</span>
                                <span class="stat-value ${effClass}">${branch.efficiency}%</span>
                            </div>
                            <div class="stat">
                                <span class="stat-label">Portfel</span>
                                <span class="stat-value">${branch.portfolio}T</span>
                            </div>
                            <div class="stat">
                                <span class="stat-label">Kreditlar</span>
                                <span class="stat-value">${branch.loans.toLocaleString()}</span>
                            </div>
                            <div class="stat">
                                <span class="stat-label">95413</span>
                                <span class="stat-value">${branch.npl95413}</span>
                            </div>
                            <div class="stat">
                                <span class="stat-label">Xodimlar</span>
                                <span class="stat-value">${branch.staff}</span>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }
        
        function initBranchRadar(col) {
            renderBranchRadarSelector();
            updateBranchCompareInfo();
            
            branchRadarChart = new Chart(document.getElementById('chartBranchRadar'), {
                type: 'radar',
                data: { 
                    labels: ['NPL (past=yaxshi)', 'Samaradorlik (%)', 'Portfel (trln)', 'Kredit/Xodim', '95413 sifati'], 
                    datasets: []
                },
                options: { 
                    responsive: true, 
                    maintainAspectRatio: false, 
                    plugins: { 
                        legend: { 
                            position: 'bottom',
                            labels: { color: col.txt, font: { size: 10 }, usePointStyle: true, padding: 10 } 
                        } 
                    }, 
                    scales: { 
                        r: { 
                            grid: { color: col.grid }, 
                            ticks: { display: false }, 
                            pointLabels: { color: col.txt, font: { size: 10 } },
                            min: 0,
                            max: 100
                        } 
                    } 
                }
            });
            charts.push(branchRadarChart);
        }
        
        // ===================== FUNCTIONS =====================
        function showSection(id) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            event.target.closest('.nav-item')?.classList.add('active');
        }
        
        function setTheme(theme) {
            document.body.setAttribute('data-theme', theme);
            document.querySelectorAll('.theme-btn').forEach(b => b.classList.remove('active'));
            event.target.classList.add('active');
            updateCharts();
        }
        
        function closeModal(e) { if (!e || e.target.classList.contains('modal-overlay')) document.getElementById('modalOverlay').classList.remove('active'); }
        document.addEventListener('keydown', e => { if (e.key === 'Escape') closeModal(); });
        
        function openModal(icon, title, body) {
            document.getElementById('modalIcon').textContent = icon;
            document.getElementById('modalTitle').textContent = title;
            document.getElementById('modalBody').innerHTML = body;
            document.getElementById('modalOverlay').classList.add('active');
        }
        
        function showClientDetail(client, isProblem) {
            if (isProblem && client.loans) {
                const loans95413 = client.loans.filter(l => l.is95413);
                const sum95413 = loans95413.reduce((s, l) => s + l.amount, 0);
                const banks = [...new Set(client.loans.map(l => l.bank))];
                
                openModal('üî¥', client.name, `
                    <div class="modal-stats">
                        <div class="modal-stat"><div class="modal-stat-value text-red">${client.totalDebt}</div><div class="modal-stat-label">Jami qarz (mlrd)</div></div>
                        <div class="modal-stat"><div class="modal-stat-value text-purple">${client.loans.length}</div><div class="modal-stat-label">Kreditlar</div></div>
                        <div class="modal-stat"><div class="modal-stat-value ${client.efficiency > 30 ? 'text-yellow' : 'text-red'}">${client.efficiency}%</div><div class="modal-stat-label">Samaradorlik</div></div>
                        <div class="modal-stat"><div class="modal-stat-value text-blue">${banks.length}</div><div class="modal-stat-label">Banklar</div></div>
                    </div>
                    ${loans95413.length > 0 ? `<div class="modal-section danger"><h5>üö® 95413 OGOHLANTIRISH</h5><p><strong>${loans95413.length} ta kredit (${sum95413.toFixed(2)} mlrd) 95413da yashirilgan!</strong></p></div>` : ''}
                    <div class="modal-section"><h5>üìä Ma'lumot</h5><p><strong>Hudud:</strong> ${client.region} | <strong>Ta'minot:</strong> ${client.collateral}</p></div>
                    <div class="modal-section"><h5>üè¶ Barcha kreditlar</h5>
                        <div class="loans-grid">
                            ${client.loans.map(l => `
                                <div class="loan-card ${l.is95413 ? 'is95413' : ''}">
                                    <div><div class="loan-bank">${l.bank}</div><div class="loan-branch">${l.branch}</div></div>
                                    <div class="loan-amount text-red">${l.amount} mlrd</div>
                                    <div style="font-size:12px">${l.sector}</div>
                                    <div><span class="badge ${l.status === 'NPL' ? 'critical' : l.status === 'Sud' ? 'danger' : l.status === 'Samarali' ? 'success' : 'warning'}">${l.status}</span></div>
                                    <div class="${l.is95413 ? 'text-red' : 'text-green'}" style="font-weight:700">${l.is95413 ? 'üö® 95413' : '‚úÖ'}</div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    <div class="modal-section danger"><h5>üí° Tavsiya</h5><p>${client.rec}</p></div>
                `);
            } else if (client.loans) {
                const banks = [...new Set(client.loans.map(l => l.bank))];
                openModal('üü¢', client.name, `
                    <div class="modal-stats">
                        <div class="modal-stat"><div class="modal-stat-value text-green">${client.totalCredit}</div><div class="modal-stat-label">Jami kredit (mlrd)</div></div>
                        <div class="modal-stat"><div class="modal-stat-value text-green">${client.efficiency}%</div><div class="modal-stat-label">Samaradorlik</div></div>
                        <div class="modal-stat"><div class="modal-stat-value text-purple">${client.loans.length}</div><div class="modal-stat-label">Kreditlar</div></div>
                        <div class="modal-stat"><div class="modal-stat-value text-blue">${client.history}</div><div class="modal-stat-label">Hamkorlik</div></div>
                    </div>
                    <div class="modal-section success"><h5>‚úÖ Samaradorlik</h5><p>Bu mijoz <strong>${client.efficiency}%</strong> samaradorlik bilan <strong>${client.history}</strong> davomida ishonchli hamkor.</p></div>
                    <div class="modal-section"><h5>üè¶ Barcha kreditlar</h5>
                        <div class="loans-grid">
                            ${client.loans.map(l => `
                                <div class="loan-card">
                                    <div><div class="loan-bank">${l.bank}</div><div class="loan-branch">${l.branch}</div></div>
                                    <div class="loan-amount text-green">${l.amount} mlrd</div>
                                    <div style="font-size:12px">${l.sector}</div>
                                    <div><span class="badge success">‚úÖ Samarali</span></div>
                                    <div></div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    <div class="modal-section success"><h5>üí° Tavsiya</h5><p>${client.rec}</p></div>
                `);
            }
        }
        
        // ===================== BANK DETAIL MODAL =====================
        // Bank bo'yicha soha ma'lumotlari
        const bankSectorData = {
            'Agrobank': [
                { sector: 'Qishloq xo\'jaligi', loans: 28500, portfolio: 4.85, npl: 8.2 },
                { sector: 'Fermer xo\'jaligi', loans: 8900, portfolio: 1.42, npl: 6.5 },
                { sector: 'Klasterlar', loans: 3200, portfolio: 0.45, npl: 12.3 },
                { sector: 'Boshqa', loans: 1831, portfolio: 0.25, npl: 3.1 }
            ],
            'BRB': [
                { sector: 'Sanoat', loans: 8500, portfolio: 0.72, npl: 14.5 },
                { sector: 'Savdo', loans: 5200, portfolio: 0.42, npl: 8.2 },
                { sector: 'Ishlab chiqarish', loans: 3800, portfolio: 0.32, npl: 11.8 },
                { sector: 'Boshqa', loans: 1687, portfolio: 0.13, npl: 5.4 }
            ],
            'Xalq Banki': [
                { sector: 'Ta\'lim krediti', loans: 18500, portfolio: 0.85, npl: 2.1 },
                { sector: 'Iste\'mol', loans: 15200, portfolio: 0.72, npl: 3.5 },
                { sector: 'Mikrokredit', loans: 12300, portfolio: 0.58, npl: 4.2 },
                { sector: 'Boshqa', loans: 4005, portfolio: 0.18, npl: 2.8 }
            ],
            'Ipoteka Bank': [
                { sector: 'Ipoteka', loans: 28500, portfolio: 2.15, npl: 1.8 },
                { sector: 'Qurilish', loans: 6800, portfolio: 0.52, npl: 3.2 },
                { sector: 'Iste\'mol', loans: 3384, portfolio: 0.26, npl: 4.5 }
            ],
            'Turonbank': [
                { sector: 'Iste\'mol', loans: 1850, portfolio: 0.72, npl: 0.1 },
                { sector: 'Mikrokredit', loans: 980, portfolio: 0.38, npl: 0.2 },
                { sector: 'Boshqa', loans: 333, portfolio: 0.13, npl: 0.1 }
            ],
            'Mikrokreditbank': [
                { sector: 'Mikrokredit', loans: 12500, portfolio: 0.82, npl: 3.8 },
                { sector: 'Kichik biznes', loans: 2800, portfolio: 0.24, npl: 4.2 },
                { sector: 'Boshqa', loans: 1088, portfolio: 0.08, npl: 2.5 }
            ],
            'Milliy Bank': [
                { sector: 'Tijorat', loans: 15800, portfolio: 1.25, npl: 0.8 },
                { sector: 'Iste\'mol', loans: 8500, portfolio: 0.65, npl: 1.2 },
                { sector: 'Boshqa', loans: 2263, portfolio: 0.20, npl: 1.1 }
            ],
            'Hamkorbank': [
                { sector: 'Mikrokredit', loans: 9500, portfolio: 0.78, npl: 1.0 },
                { sector: 'Kichik biznes', loans: 4200, portfolio: 0.38, npl: 1.5 },
                { sector: 'Boshqa', loans: 1253, portfolio: 0.13, npl: 1.0 }
            ],
            'Asaka Bank': [
                { sector: 'Sanoat', loans: 4200, portfolio: 0.68, npl: 2.8 },
                { sector: 'Avto kredit', loans: 1800, portfolio: 0.32, npl: 2.2 },
                { sector: 'Boshqa', loans: 928, portfolio: 0.12, npl: 2.5 }
            ],
            'Uzsanoatqurilishbank': [
                { sector: 'Sanoat', loans: 15200, portfolio: 1.95, npl: 4.2 },
                { sector: 'Qurilish', loans: 8500, portfolio: 1.12, npl: 3.5 },
                { sector: 'Boshqa', loans: 2555, portfolio: 0.34, npl: 2.8 }
            ],
            'Aloqabank': [
                { sector: 'IT va Telekom', loans: 2800, portfolio: 0.28, npl: 2.8 },
                { sector: 'Xizmat', loans: 1900, portfolio: 0.18, npl: 3.5 },
                { sector: 'Boshqa', loans: 939, portfolio: 0.08, npl: 3.0 }
            ],
            'Anor Bank': [
                { sector: 'Onlayn kredit', loans: 12500, portfolio: 0.38, npl: 0.2 },
                { sector: 'Iste\'mol', loans: 2826, portfolio: 0.09, npl: 0.3 }
            ],
            'Davr Bank': [
                { sector: 'Iste\'mol', loans: 1800, portfolio: 0.35, npl: 0.3 },
                { sector: 'Mikrokredit', loans: 1217, portfolio: 0.24, npl: 0.4 }
            ],
            'Infinbank': [
                { sector: 'Biznes kredit', loans: 1800, portfolio: 0.48, npl: 0.0 },
                { sector: 'Iste\'mol', loans: 1022, portfolio: 0.28, npl: 0.0 }
            ]
        };
        
        // Bank bo'yicha kredit turlari
        const bankCreditTypes = {
            'Agrobank': [
                { type: 'Qishloq xo\'jaligi krediti', count: 25600, amount: 4.2, npl: 7.8 },
                { type: 'Fermer krediti', count: 12800, amount: 1.8, npl: 6.2 },
                { type: 'Klaster krediti', count: 2100, amount: 0.65, npl: 15.4 },
                { type: 'Iste\'mol krediti', count: 1931, amount: 0.32, npl: 3.5 }
            ],
            'BRB': [
                { type: 'Biznes kredit', count: 9500, amount: 0.85, npl: 12.5 },
                { type: 'Sanoat krediti', count: 5800, amount: 0.48, npl: 14.2 },
                { type: 'Aylanma mablag\'', count: 2900, amount: 0.18, npl: 8.5 },
                { type: 'Boshqa', count: 987, amount: 0.08, npl: 5.2 }
            ],
            'Xalq Banki': [
                { type: 'Ta\'lim krediti', count: 22000, amount: 0.95, npl: 1.8 },
                { type: 'Iste\'mol krediti', count: 18500, amount: 0.85, npl: 3.2 },
                { type: 'Mikrokredit', count: 8500, amount: 0.45, npl: 5.1 },
                { type: 'Boshqa', count: 1005, amount: 0.08, npl: 2.5 }
            ],
            'Ipoteka Bank': [
                { type: 'Ipoteka krediti', count: 32000, amount: 2.45, npl: 1.5 },
                { type: 'Qurilish krediti', count: 4800, amount: 0.35, npl: 3.8 },
                { type: 'Boshqa', count: 1884, amount: 0.13, npl: 4.2 }
            ],
            'Turonbank': [
                { type: 'Iste\'mol krediti', count: 2100, amount: 0.82, npl: 0.1 },
                { type: 'Mikrokredit', count: 850, amount: 0.32, npl: 0.2 },
                { type: 'Boshqa', count: 213, amount: 0.09, npl: 0.1 }
            ],
            'Mikrokreditbank': [
                { type: 'Mikrokredit', count: 13500, amount: 0.92, npl: 3.6 },
                { type: 'Kichik biznes', count: 2100, amount: 0.18, npl: 4.5 },
                { type: 'Boshqa', count: 788, amount: 0.04, npl: 2.2 }
            ],
            'Milliy Bank': [
                { type: 'Tijorat krediti', count: 16800, amount: 1.35, npl: 0.9 },
                { type: 'Iste\'mol krediti', count: 7800, amount: 0.58, npl: 1.1 },
                { type: 'Boshqa', count: 1963, amount: 0.17, npl: 1.0 }
            ],
            'Hamkorbank': [
                { type: 'Mikrokredit', count: 10200, amount: 0.85, npl: 1.1 },
                { type: 'Kichik biznes', count: 3800, amount: 0.32, npl: 1.4 },
                { type: 'Boshqa', count: 953, amount: 0.12, npl: 0.9 }
            ],
            'Asaka Bank': [
                { type: 'Sanoat krediti', count: 4500, amount: 0.72, npl: 2.9 },
                { type: 'Avto kredit', count: 1600, amount: 0.28, npl: 2.0 },
                { type: 'Boshqa', count: 828, amount: 0.12, npl: 2.6 }
            ],
            'Uzsanoatqurilishbank': [
                { type: 'Sanoat krediti', count: 16500, amount: 2.15, npl: 4.0 },
                { type: 'Qurilish krediti', count: 7200, amount: 0.95, npl: 3.2 },
                { type: 'Boshqa', count: 2555, amount: 0.31, npl: 2.5 }
            ],
            'Aloqabank': [
                { type: 'IT krediti', count: 2500, amount: 0.25, npl: 2.5 },
                { type: 'Xizmat krediti', count: 2200, amount: 0.21, npl: 3.8 },
                { type: 'Boshqa', count: 939, amount: 0.08, npl: 3.2 }
            ],
            'Anor Bank': [
                { type: 'Onlayn kredit', count: 13500, amount: 0.42, npl: 0.2 },
                { type: 'Boshqa', count: 1826, amount: 0.05, npl: 0.4 }
            ],
            'Davr Bank': [
                { type: 'Iste\'mol krediti', count: 2000, amount: 0.38, npl: 0.3 },
                { type: 'Boshqa', count: 1017, amount: 0.21, npl: 0.4 }
            ],
            'Infinbank': [
                { type: 'Biznes kredit', count: 2000, amount: 0.52, npl: 0.0 },
                { type: 'Boshqa', count: 822, amount: 0.24, npl: 0.0 }
            ]
        };
        
        // Bank bo'yicha eng yomon mijozlar
        const bankProblemClients = {
            'Agrobank': [
                { name: 'OQQORGON PAXTA SANOAT', debt: 127.5, status: 'NPL', reason: 'Paxta narxi tushishi' },
                { name: 'YANGIYO\'L AGRO CLUSTER', debt: 67.8, status: 'Muammoli', reason: 'Klaster bo\'linishi' },
                { name: 'EUROGARDEN EXPORT', debt: 52.79, status: '95413', reason: 'Eksport to\'xtashi' },
                { name: 'Toshmatov D.A. (Fermer)', debt: 87.4, status: 'Muammoli', reason: 'Suv muammosi' },
                { name: 'Salimov O.N. (Fermer)', debt: 123.4, status: 'Kechikish', reason: 'Hosil past' }
            ],
            'BRB': [
                { name: 'REAL TEX TASHKENT', debt: 359.59, status: 'NPL', reason: 'Ishlab chiqarish to\'xtagan' },
                { name: 'CHIRCHIQ TRANSFORMER', debt: 78.2, status: 'NPL', reason: 'Buyurtmalar yo\'q' },
                { name: 'TASHKENT METALS', debt: 36.0, status: '95413', reason: 'Xomashyo muammosi' },
                { name: 'Turgunova S.Y.', debt: 78.9, status: 'NPL', reason: 'Ishsizlik' },
                { name: 'Tursunov F.A.', debt: 78.9, status: 'NPL', reason: 'Kasallik' }
            ],
            'Xalq Banki': [
                { name: 'EUROGARDEN EXPORT', debt: 36.49, status: '95413', reason: 'Eksport muammosi' },
                { name: 'OQQORGON PAXTA', debt: 22.0, status: '95413', reason: 'Hamkorlik' },
                { name: 'Xolmatov Dilshod', debt: 67.8, status: 'NPL', reason: 'Kasb yo\'qotish' },
                { name: 'Qodirov J.B.', debt: 134.5, status: 'Muammoli', reason: 'Biznes muammosi' },
                { name: 'Normatov Sh.E.', debt: 98.6, status: 'NPL', reason: 'Ishsizlik' }
            ],
            'Turonbank': [
                { name: 'Muammoli yo\'q', debt: 0, status: 'Yaxshi', reason: 'Barcha kreditlar samarali - NPL 0.13%' }
            ],
            'Ipoteka Bank': [
                { name: 'BO\'STONLIQ RESORT COMPLEX', debt: 398.0, status: 'Muammoli', reason: 'Turizm pasayishi' },
                { name: 'Karimova Z.Sh.', debt: 156.7, status: 'Muammoli', reason: 'Ipoteka kechikishi' },
                { name: 'Raxmatullayev B.Sh.', debt: 234.5, status: 'Kechikish', reason: 'Daromad pasayishi' }
            ],
            'Mikrokreditbank': [
                { name: 'Normatova F.S. (Savdo)', debt: 56.4, status: 'NPL', reason: 'Bozor yopilishi' },
                { name: 'Ergashov A.M. (Oziq-ovqat)', debt: 67.8, status: 'NPL', reason: 'Raqobat' },
                { name: 'Qosimova D.T.', debt: 34.5, status: 'NPL', reason: 'Kasallik' },
                { name: 'Bekmurodov J.X.', debt: 43.2, status: 'Muammoli', reason: 'Biznes tushishi' }
            ],
            'Milliy Bank': [
                { name: 'TOSHKENT VILOYATI HOKIMLIGI', debt: 89.3, status: 'Muammoli', reason: 'Byudjet kechikishi' },
                { name: 'Mamadaliyev F.Q.', debt: 112.3, status: 'Kechikish', reason: 'Daromad pasayishi' }
            ],
            'Hamkorbank': [
                { name: 'PARKENT MARMAR KONLARI', debt: 34.6, status: 'NPL', reason: 'Kon ishlamayapti' },
                { name: 'Turgunov S.Y. (Savdo)', debt: 45.6, status: 'NPL', reason: 'Bozor muammosi' },
                { name: 'Raximov U.S. (Qurilish)', debt: 167.8, status: 'Muammoli', reason: 'Loyiha kechikishi' }
            ],
            'Asaka Bank': [
                { name: 'REAL TEX TASHKENT (ulush)', debt: 245.0, status: 'NPL', reason: 'Ishlab chiqarish to\'xtagan' },
                { name: 'TASHKENT METALS (ulush)', debt: 36.0, status: '95413', reason: 'Xomashyo muammosi' },
                { name: 'Sharipova Z.I.', debt: 98.7, status: 'Kechikish', reason: 'Avtokredit muammosi' }
            ],
            'Uzsanoatqurilishbank': [
                { name: 'REAL TEX TASHKENT (ulush)', debt: 78.5, status: 'Muammoli', reason: 'Ishlab chiqarish to\'xtagan' },
                { name: 'CHIRCHIQ TRANSFORMER (ulush)', debt: 52.0, status: 'NPL', reason: 'Buyurtmalar yo\'q' },
                { name: 'YANGIYO\'L INDUSTRIAL PARK', debt: 423.0, status: 'Muammoli', reason: 'Infrastruktura muammosi' }
            ],
            'Aloqabank': [
                { name: 'ANGREN ISSIQLIK TARMOG\'I', debt: 38.7, status: 'NPL', reason: 'Kommunal qarz' },
                { name: 'FRESH FRUITS EXPORT', debt: 32.7, status: 'Muammoli', reason: 'Eksport muammosi' }
            ],
            'Davr Bank': [
                { name: 'Muammoli yo\'q', debt: 0, status: 'Yaxshi', reason: 'Barcha kreditlar samarali - NPL 0.33%' }
            ],
            'Anor Bank': [
                { name: 'Muammoli yo\'q', debt: 0, status: 'Yaxshi', reason: 'Onlayn kreditlar samarali - NPL 0.25%' }
            ],
            'Infinbank': [
                { name: 'Muammoli yo\'q', debt: 0, status: 'Yaxshi', reason: 'Barcha kreditlar samarali - NPL 0%' }
            ],
            'Ipak Yo\'li Bank': [
                { name: 'Kichik muammolar', debt: 12.5, status: 'Kechikish', reason: 'Vaqtinchalik qiyinchilik' }
            ],
            'Hayot Bank': [
                { name: 'Kichik muammolar', debt: 8.2, status: 'Kechikish', reason: 'Mavsumiy muammo' }
            ],
            'Garant Bank': [
                { name: 'Muammoli yo\'q', debt: 0, status: 'Yaxshi', reason: 'Barcha kreditlar samarali - NPL 0.34%' }
            ],
            'Universal Bank': [
                { name: 'Muammoli yo\'q', debt: 0, status: 'Yaxshi', reason: 'Barcha kreditlar samarali - NPL 0%' }
            ]
        };
        
        function showBankDetail(bankName) {
            const bank = banksData.find(b => b.name === bankName);
            if (!bank) return;
            
            // Filiallar
            const bankBranches = branchesData.filter(b => b.bank === bankName);
            const bestBranch = bankBranches.length > 0 ? bankBranches.reduce((a, b) => a.efficiency > b.efficiency ? a : b) : null;
            const worstBranch = bankBranches.length > 0 ? bankBranches.reduce((a, b) => a.npl > b.npl ? a : b) : null;
            
            // Sohalar
            const sectors = bankSectorData[bankName] || [{ sector: 'Ma\'lumot yo\'q', loans: 0, portfolio: 0, npl: 0 }];
            
            // Kredit turlari
            const creditTypes = bankCreditTypes[bankName] || [{ type: 'Ma\'lumot yo\'q', count: 0, amount: 0, npl: 0 }];
            
            // Muammoli mijozlar
            const problemClients = bankProblemClients[bankName] || [{ name: 'Ma\'lumot yo\'q', debt: 0, status: '-', reason: '-' }];
            
            const nplClass = bank.npl > 5 ? 'text-red' : bank.npl > 3 ? 'text-yellow' : 'text-green';
            const statusBadge = bank.npl > 5 ? 'critical' : bank.npl > 3 ? 'warning' : 'success';
            
            openModal('üè¶', bankName, `
                <div class="modal-stats">
                    <div class="modal-stat"><div class="modal-stat-value text-blue">${bank.loans.toLocaleString()}</div><div class="modal-stat-label">Kreditlar soni</div></div>
                    <div class="modal-stat"><div class="modal-stat-value text-purple">${bank.portfolio} trln</div><div class="modal-stat-label">Portfel</div></div>
                    <div class="modal-stat"><div class="modal-stat-value ${nplClass}">${bank.npl}%</div><div class="modal-stat-label">NPL</div></div>
                    <div class="modal-stat"><div class="modal-stat-value text-orange">${bank.npl95413.toLocaleString()}</div><div class="modal-stat-label">95413 mijozlar</div></div>
                </div>
                
                <div class="modal-section">
                    <h5>üè¢ Filiallar holati (${bankBranches.length} ta)</h5>
                    ${bankBranches.length > 0 ? `
                        <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:12px;margin-top:12px;">
                            <div style="padding:12px;background:var(--bg-secondary);border-radius:8px;border-left:4px solid var(--success)">
                                <div style="font-size:11px;color:var(--text-muted)">üèÜ Eng yaxshi filial</div>
                                <div style="font-weight:600;margin-top:4px">${bestBranch.branch}</div>
                                <div style="font-size:12px;color:var(--success)">NPL: ${bestBranch.npl}% | Samaradorlik: ${bestBranch.efficiency}%</div>
                            </div>
                            <div style="padding:12px;background:var(--bg-secondary);border-radius:8px;border-left:4px solid var(--danger)">
                                <div style="font-size:11px;color:var(--text-muted)">‚ö†Ô∏è Eng muammoli</div>
                                <div style="font-weight:600;margin-top:4px">${worstBranch.branch}</div>
                                <div style="font-size:12px;color:var(--danger)">NPL: ${worstBranch.npl}% | Samaradorlik: ${worstBranch.efficiency}%</div>
                            </div>
                        </div>
                        <table style="width:100%;margin-top:12px;font-size:12px;">
                            <thead><tr><th>Filial</th><th class="num">Kreditlar</th><th class="num">NPL%</th><th class="num">Samaradorlik</th></tr></thead>
                            <tbody>
                                ${bankBranches.map(b => `<tr>
                                    <td>${b.branch}</td>
                                    <td class="num">${b.loans.toLocaleString()}</td>
                                    <td class="num"><span class="${b.npl > 5 ? 'text-red' : b.npl > 3 ? 'text-yellow' : 'text-green'}">${b.npl}%</span></td>
                                    <td class="num">${b.efficiency}%</td>
                                </tr>`).join('')}
                            </tbody>
                        </table>
                    ` : '<p style="color:var(--text-muted)">Filial ma\'lumotlari mavjud emas</p>'}
                </div>
                
                <div class="modal-section">
                    <h5>üìä Sohalar bo'yicha taqsimot</h5>
                    <table style="width:100%;margin-top:12px;font-size:12px;">
                        <thead><tr><th>Soha</th><th class="num">Kreditlar</th><th class="num">Portfel</th><th class="num">NPL%</th></tr></thead>
                        <tbody>
                            ${sectors.map(s => `<tr>
                                <td>${s.sector}</td>
                                <td class="num">${s.loans.toLocaleString()}</td>
                                <td class="num">${s.portfolio} trln</td>
                                <td class="num"><span class="${s.npl > 5 ? 'text-red' : s.npl > 3 ? 'text-yellow' : 'text-green'}">${s.npl}%</span></td>
                            </tr>`).join('')}
                        </tbody>
                    </table>
                </div>
                
                <div class="modal-section">
                    <h5>üí≥ Kredit turlari bo'yicha</h5>
                    <table style="width:100%;margin-top:12px;font-size:12px;">
                        <thead><tr><th>Kredit turi</th><th class="num">Soni</th><th class="num">Summa (trln)</th><th class="num">NPL%</th></tr></thead>
                        <tbody>
                            ${creditTypes.map(c => `<tr>
                                <td>${c.type}</td>
                                <td class="num">${c.count.toLocaleString()}</td>
                                <td class="num">${c.amount}</td>
                                <td class="num"><span class="${c.npl > 5 ? 'text-red' : c.npl > 3 ? 'text-yellow' : 'text-green'}">${c.npl}%</span></td>
                            </tr>`).join('')}
                        </tbody>
                    </table>
                </div>
                
                <div class="modal-section ${problemClients[0].status === 'Yaxshi' ? 'success' : 'danger'}">
                    <h5>üî¥ Eng muammoli mijozlar (TOP 5)</h5>
                    ${problemClients[0].status !== 'Yaxshi' ? `
                        <table style="width:100%;margin-top:12px;font-size:12px;">
                            <thead><tr><th>Mijoz</th><th class="num">Qarz (mlrd)</th><th>Holat</th><th>Sabab</th></tr></thead>
                            <tbody>
                                ${problemClients.map(c => `<tr>
                                    <td><strong>${c.name}</strong></td>
                                    <td class="num text-red">${c.debt}</td>
                                    <td><span class="badge ${c.status === 'NPL' || c.status === '95413' ? 'critical' : 'warning'}">${c.status}</span></td>
                                    <td style="font-size:11px">${c.reason}</td>
                                </tr>`).join('')}
                            </tbody>
                        </table>
                    ` : '<p style="color:var(--success)">‚úÖ Muammoli mijozlar yo\'q - ajoyib natija!</p>'}
                </div>
                
                <div class="modal-section">
                    <h5>üí° Tavsiyalar</h5>
                    <p>${bank.npl > 5 ? 'üî¥ NPL yuqori - yangi kreditlarni cheklang va undiruv ishlarini kuchaytiring' : 
                        bank.npl > 3 ? 'üü° NPL o\'rtacha - ehtiyotkorlik bilan davom eting' : 
                        'üü¢ Yaxshi ko\'rsatkich - tajribani boshqa banklarga tarqating'}</p>
                </div>
            `);
        }
        
        // ===================== RENDER TABLES =====================
        function renderTables() {
            document.getElementById('banksTable').innerHTML = banksData.map(b => `
                <tr onclick="showBankDetail('${b.name}')" style="cursor:pointer" title="Batafsil ko'rish uchun bosing">
                    <td><strong>${b.name}</strong></td>
                    <td class="num">${b.loans.toLocaleString()}</td>
                    <td class="num">${b.portfolio} trln</td>
                    <td class="num"><div class="npl-indicator"><span class="npl-dot ${b.npl > 4 ? 'bad' : 'good'}"></span>${b.npl}%</div></td>
                    <td class="num">${b.npl95413.toLocaleString()}</td>
                    <td class="num text-red">${b.realNpl}%</td>
                    <td><span class="badge ${b.npl > 7 ? 'critical' : b.npl > 4 ? 'danger' : 'success'}">${b.npl > 7 ? 'Kritik' : b.npl > 4 ? 'NPL>4%' : 'Yaxshi'}</span></td>
                </tr>
            `).join('');
            
            document.getElementById('sectorsTable').innerHTML = sectorsData.map(s => `
                <tr><td><strong>${s.name}</strong></td><td class="num">${s.loans.toLocaleString()}</td><td class="num">${s.portfolio} trln</td><td class="num"><div class="npl-indicator"><span class="npl-dot ${s.npl > 4 ? 'bad' : 'good'}"></span>${s.npl}%</div></td><td class="num">${s.court}%</td><td><span class="badge ${s.npl > 10 ? 'critical' : s.npl > 4 ? 'danger' : 'success'}">${s.npl > 10 ? 'Kritik' : s.npl > 4 ? 'NPL>4%' : 'Yaxshi'}</span></td></tr>
            `).join('');
            
            document.getElementById('regionsTable').innerHTML = regionsData.map(r => `
                <tr><td><strong>${r.name}</strong></td><td class="num">${r.loans.toLocaleString()}</td><td class="num">${r.portfolio} mlrd</td><td class="num">${r.problem}%</td><td class="num"><div class="npl-indicator"><span class="npl-dot ${r.npl > 4 ? 'bad' : 'good'}"></span>${r.npl}%</div></td><td><span class="badge ${r.npl > 5 ? 'danger' : r.npl > 3 ? 'warning' : 'success'}">${r.npl > 5 ? 'Yuqori' : r.npl > 3 ? 'O\'rta' : 'Past'}</span></td></tr>
            `).join('');
            
            document.getElementById('problemClientsTable').innerHTML = problemClients.map(c => {
                const loans95413 = c.loans.filter(l => l.is95413);
                const banks = [...new Set(c.loans.map(l => l.bank))];
                const sectors = [...new Set(c.loans.map(l => l.sector))];
                return `<tr onclick='showClientDetail(${JSON.stringify(c).replace(/'/g, "\\'")}, true)'>
                    <td><strong>${c.name}</strong> ${loans95413.length > 0 ? '<span class="badge critical" style="font-size:10px;padding:4px 8px">üö® 95413</span>' : ''}<br><span style="font-size:11px;color:var(--text-muted)">${c.loans.length} ta kredit</span></td>
                    <td class="num text-red"><strong>${c.totalDebt}</strong></td>
                    <td style="font-size:12px">${banks.join(', ')}</td>
                    <td style="font-size:12px">${sectors.join(', ')}</td>
                    <td><span class="badge ${c.efficiency < 20 ? 'critical' : c.efficiency < 40 ? 'danger' : 'warning'}">${c.efficiency}%</span></td>
                </tr>`;
            }).join('');
            
            document.getElementById('goodClientsTable').innerHTML = goodClients.map(c => {
                const banks = [...new Set(c.loans.map(l => l.bank))];
                const sectors = [...new Set(c.loans.map(l => l.sector))];
                return `<tr onclick='showClientDetail(${JSON.stringify(c).replace(/'/g, "\\'")}, false)'>
                    <td><strong>${c.name}</strong><br><span style="font-size:11px;color:var(--text-muted)">${c.loans.length} ta kredit</span></td>
                    <td class="num text-green"><strong>${c.totalCredit}</strong></td>
                    <td style="font-size:12px">${banks.join(', ')}</td>
                    <td style="font-size:12px">${sectors.join(', ')}</td>
                    <td><span class="badge success">‚úÖ ${c.efficiency}%</span></td>
                </tr>`;
            }).join('');
            
            // Risk Matrix
            const riskCombinations = [
                { bank: 'BRB', sector: 'Sanoat', risk: 'critical' },
                { bank: 'BRB', sector: 'Savdo', risk: 'high' },
                { bank: 'Agrobank', sector: 'Qishloq', risk: 'high' },
                { bank: 'Mikrokreditbank', sector: 'Xizmat', risk: 'medium' },
                { bank: 'Turonbank', sector: 'Barcha', risk: 'low' }
            ];
            
            document.getElementById('riskMatrix').innerHTML = `
                <div class="risk-cell risk-critical"><span>üö®</span>BRB+Sanoat</div>
                <div class="risk-cell risk-high"><span>‚ö†Ô∏è</span>BRB+Savdo</div>
                <div class="risk-cell risk-high"><span>‚ö†Ô∏è</span>Agro+Qishloq</div>
                <div class="risk-cell risk-medium"><span>üìä</span>Mikro+Xizmat</div>
                <div class="risk-cell risk-low"><span>‚úÖ</span>Turon+Barcha</div>
                <div class="risk-cell risk-high"><span>‚ö†Ô∏è</span>Asaka+Sanoat</div>
                <div class="risk-cell risk-critical"><span>üö®</span>Agro+Ishlab</div>
                <div class="risk-cell risk-medium"><span>üìä</span>Xalq+Savdo</div>
                <div class="risk-cell risk-low"><span>‚úÖ</span>Milliy+Tijorat</div>
                <div class="risk-cell risk-low"><span>‚úÖ</span>Ipoteka+Uy</div>
            `;
        }
        
        // ===================== MIJOZLAR JADVALLARI =====================
        function renderClientTables() {
            // Jismoniy shaxslar jadvali
            document.getElementById('jismoniyTable').innerHTML = jismoniyData.map(c => `
                <tr onclick="showJismoniyDetail('${c.fio.replace(/'/g, "\\'")}', '${c.region}', ${c.amount}, '${c.bank}', '${c.type}', '${c.status}', ${c.npl})" style="cursor:pointer" title="Batafsil ko'rish">
                    <td><strong>${c.fio}</strong></td>
                    <td>${c.region}</td>
                    <td class="num">${c.amount}</td>
                    <td>${c.bank}</td>
                    <td>${c.type}</td>
                    <td><span class="badge ${c.npl ? 'critical' : c.status === 'Muammoli' ? 'danger' : 'success'}">${c.status}</span></td>
                </tr>
            `).join('');
            
            // Yuridik shaxslar jadvali
            document.getElementById('yuridikTable').innerHTML = yuridikData.map(c => `
                <tr onclick="showYuridikDetail('${c.name.replace(/'/g, "\\'")}', '${c.stir}', ${c.amount}, '${c.banks.replace(/'/g, "\\'")}', '${c.sector}', '${c.status}', ${c.npl})" style="cursor:pointer" title="Batafsil ko'rish">
                    <td><strong>${c.name}</strong></td>
                    <td>${c.stir}</td>
                    <td class="num">${c.amount}</td>
                    <td style="font-size:11px">${c.banks}</td>
                    <td>${c.sector}</td>
                    <td><span class="badge ${c.npl ? 'critical' : c.status === 'Muammoli' ? 'danger' : 'success'}">${c.status}</span></td>
                </tr>
            `).join('');
            
            // YaTT jadvali
            document.getElementById('yattTable').innerHTML = yattData.map(c => `
                <tr onclick="showYattDetail('${c.name.replace(/'/g, "\\'")}', '${c.region}', ${c.amount}, '${c.bank}', '${c.activity.replace(/'/g, "\\'")}', '${c.status}', ${c.npl})" style="cursor:pointer" title="Batafsil ko'rish">
                    <td><strong>${c.name}</strong></td>
                    <td>${c.region}</td>
                    <td class="num">${c.amount}</td>
                    <td>${c.bank}</td>
                    <td>${c.activity}</td>
                    <td><span class="badge ${c.npl ? 'critical' : c.status === 'Muammoli' ? 'danger' : 'success'}">${c.status}</span></td>
                </tr>
            `).join('');
        }
        
        // Mijoz turi filtrlash
        function filterClientType(type) {
            // Tab buttonlarni yangilash
            document.querySelectorAll('.client-tab').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            // Bo'limlarni ko'rsatish/yashirish
            const jisSection = document.getElementById('sectionJIS');
            const yurSection = document.getElementById('sectionYUR');
            const yattSection = document.getElementById('sectionYATT');
            
            if (type === 'ALL') {
                jisSection.style.display = 'block';
                yurSection.style.display = 'block';
                yattSection.style.display = 'block';
            } else if (type === 'JIS') {
                jisSection.style.display = 'block';
                yurSection.style.display = 'none';
                yattSection.style.display = 'none';
            } else if (type === 'YUR') {
                jisSection.style.display = 'none';
                yurSection.style.display = 'block';
                yattSection.style.display = 'none';
            } else if (type === 'YATT') {
                jisSection.style.display = 'none';
                yurSection.style.display = 'none';
                yattSection.style.display = 'block';
            }
        }
        
        // ===================== MIJOZ DETAIL FUNCTIONS =====================
        function showJismoniyDetail(fio, region, amount, bank, type, status, npl) {
            const statusClass = npl ? 'text-red' : status === 'Muammoli' ? 'text-yellow' : 'text-green';
            const statusBadge = npl ? 'critical' : status === 'Muammoli' ? 'danger' : 'success';
            
            openModal('üë§', fio, `
                <div class="modal-stats">
                    <div class="modal-stat"><div class="modal-stat-value text-blue">${amount} mln</div><div class="modal-stat-label">Kredit summasi</div></div>
                    <div class="modal-stat"><div class="modal-stat-value text-purple">${bank}</div><div class="modal-stat-label">Bank</div></div>
                    <div class="modal-stat"><div class="modal-stat-value ${statusClass}">${status}</div><div class="modal-stat-label">Holat</div></div>
                </div>
                
                <div class="modal-section">
                    <h5>üìç Joylashuv</h5>
                    <p><strong>Hudud:</strong> ${region}, Toshkent viloyati</p>
                </div>
                
                <div class="modal-section">
                    <h5>üí≥ Kredit ma'lumotlari</h5>
                    <table style="width:100%;font-size:13px;">
                        <tr><td style="padding:8px 0;border-bottom:1px solid var(--bg-tertiary)"><strong>Kredit turi:</strong></td><td>${type}</td></tr>
                        <tr><td style="padding:8px 0;border-bottom:1px solid var(--bg-tertiary)"><strong>Kredit summasi:</strong></td><td>${amount} million so'm</td></tr>
                        <tr><td style="padding:8px 0;border-bottom:1px solid var(--bg-tertiary)"><strong>Bank:</strong></td><td>${bank}</td></tr>
                        <tr><td style="padding:8px 0;"><strong>Holat:</strong></td><td><span class="badge ${statusBadge}">${status}</span></td></tr>
                    </table>
                </div>
                
                <div class="modal-section ${npl ? 'danger' : status === 'Muammoli' ? 'warning' : 'success'}">
                    <h5>${npl ? 'üö® NPL Ogohlantirish' : status === 'Muammoli' ? '‚ö†Ô∏è Muammoli kredit' : '‚úÖ Samarali kredit'}</h5>
                    <p>${npl ? "Bu kredit NPL holatida. Undiruv choralarini ko'ring." : 
                        status === 'Muammoli' ? "Kredit to'lovlari kechikmoqda. Mijoz bilan bog'laning." : 
                        "Kredit to'lovlari muntazam amalga oshirilmoqda."}</p>
                </div>
            `);
        }
        
        function showYuridikDetail(name, stir, amount, banks, sector, status, npl) {
            const statusClass = npl ? 'text-red' : status === 'Muammoli' ? 'text-yellow' : 'text-green';
            const statusBadge = npl ? 'critical' : status === 'Muammoli' ? 'danger' : 'success';
            
            openModal('üè¢', name, `
                <div class="modal-stats">
                    <div class="modal-stat"><div class="modal-stat-value text-blue">${amount} mlrd</div><div class="modal-stat-label">Kredit summasi</div></div>
                    <div class="modal-stat"><div class="modal-stat-value text-purple">${sector}</div><div class="modal-stat-label">Soha</div></div>
                    <div class="modal-stat"><div class="modal-stat-value ${statusClass}">${status}</div><div class="modal-stat-label">Holat</div></div>
                </div>
                
                <div class="modal-section">
                    <h5>üè¢ Kompaniya ma'lumotlari</h5>
                    <table style="width:100%;font-size:13px;">
                        <tr><td style="padding:8px 0;border-bottom:1px solid var(--bg-tertiary)"><strong>STIR:</strong></td><td>${stir}</td></tr>
                        <tr><td style="padding:8px 0;border-bottom:1px solid var(--bg-tertiary)"><strong>Soha:</strong></td><td>${sector}</td></tr>
                        <tr><td style="padding:8px 0;border-bottom:1px solid var(--bg-tertiary)"><strong>Kredit summasi:</strong></td><td>${amount} milliard so'm</td></tr>
                        <tr><td style="padding:8px 0;border-bottom:1px solid var(--bg-tertiary)"><strong>Banklar:</strong></td><td>${banks}</td></tr>
                        <tr><td style="padding:8px 0;"><strong>Holat:</strong></td><td><span class="badge ${statusBadge}">${status}</span></td></tr>
                    </table>
                </div>
                
                <div class="modal-section ${npl ? 'danger' : status === 'Muammoli' ? 'warning' : 'success'}">
                    <h5>${npl ? 'üö® NPL Ogohlantirish' : status === 'Muammoli' ? '‚ö†Ô∏è Muammoli kredit' : '‚úÖ Samarali kredit'}</h5>
                    <p>${npl ? "Bu yuridik shaxs NPL holatida. Sudga murojaat qilish tavsiya etiladi." : 
                        status === 'Muammoli' ? "Kredit to'lovlari kechikmoqda. Kompaniya moliyaviy holatini tekshiring." : 
                        "Kompaniya kredit to'lovlarini muntazam amalga oshirmoqda."}</p>
                </div>
            `);
        }
        
        function showYattDetail(name, region, amount, bank, activity, status, npl) {
            const statusClass = npl ? 'text-red' : status === 'Muammoli' ? 'text-yellow' : 'text-green';
            const statusBadge = npl ? 'critical' : status === 'Muammoli' ? 'danger' : 'success';
            
            openModal('üßë‚Äçüíº', name, `
                <div class="modal-stats">
                    <div class="modal-stat"><div class="modal-stat-value text-blue">${amount} mln</div><div class="modal-stat-label">Kredit summasi</div></div>
                    <div class="modal-stat"><div class="modal-stat-value text-purple">${activity}</div><div class="modal-stat-label">Faoliyat</div></div>
                    <div class="modal-stat"><div class="modal-stat-value ${statusClass}">${status}</div><div class="modal-stat-label">Holat</div></div>
                </div>
                
                <div class="modal-section">
                    <h5>üßë‚Äçüíº YaTT ma'lumotlari</h5>
                    <table style="width:100%;font-size:13px;">
                        <tr><td style="padding:8px 0;border-bottom:1px solid var(--bg-tertiary)"><strong>Hudud:</strong></td><td>${region}</td></tr>
                        <tr><td style="padding:8px 0;border-bottom:1px solid var(--bg-tertiary)"><strong>Faoliyat turi:</strong></td><td>${activity}</td></tr>
                        <tr><td style="padding:8px 0;border-bottom:1px solid var(--bg-tertiary)"><strong>Kredit summasi:</strong></td><td>${amount} million so'm</td></tr>
                        <tr><td style="padding:8px 0;border-bottom:1px solid var(--bg-tertiary)"><strong>Bank:</strong></td><td>${bank}</td></tr>
                        <tr><td style="padding:8px 0;"><strong>Holat:</strong></td><td><span class="badge ${statusBadge}">${status}</span></td></tr>
                    </table>
                </div>
                
                <div class="modal-section ${npl ? 'danger' : status === 'Muammoli' ? 'warning' : 'success'}">
                    <h5>${npl ? 'üö® NPL Ogohlantirish' : status === 'Muammoli' ? '‚ö†Ô∏è Muammoli kredit' : '‚úÖ Samarali kredit'}</h5>
                    <p>${npl ? "Bu YaTT NPL holatida. Aktivlarni baholang va undiruv choralarini ko'ring." : 
                        status === 'Muammoli' ? "Kredit to'lovlari kechikmoqda. Tadbirkor bilan bog'laning." : 
                        "Tadbirkor kredit to'lovlarini muntazam amalga oshirmoqda."}</p>
                </div>
            `);
        }
        
        // ===================== CHARTS =====================
        let charts = [];
        function getColors() {
            const dark = document.body.getAttribute('data-theme') === 'dark';
            return { txt: dark ? '#94a3b8' : '#475569', grid: dark ? 'rgba(255,255,255,0.05)' : 'rgba(0,0,0,0.05)' };
        }
        
        function initCharts() {
            const col = getColors();
            // 2025 yil real ma'lumotlari (Yanvar/Fevral 2026 hali yo'q!)
            const months = ['Iyul', 'Avg', 'Sen', 'Okt', 'Noy', 'Dek'];
            
            // Chart 1 - Quality Doughnut
            charts.push(new Chart(document.getElementById('chart1'), {
                type: 'doughnut',
                data: { labels: ['Standart 87.5%', 'Substandart 6.6%', 'Qoniqarsiz 2.9%', 'Shubhali 1.8%', 'Umidsiz 1.2%'], datasets: [{ data: [87.5, 6.6, 2.9, 1.8, 1.2], backgroundColor: ['#10b981', '#f59e0b', '#f97316', '#ef4444', '#7c3aed'], borderWidth: 0, borderRadius: 5 }] },
                options: { responsive: true, maintainAspectRatio: false, cutout: '65%', plugins: { legend: { position: 'right', labels: { color: col.txt, padding: 12, font: { size: 11 }, usePointStyle: true } } } }
            }));
            
            // Chart 2 - Banks NPL
            charts.push(new Chart(document.getElementById('chart2'), {
                type: 'bar',
                data: { labels: banksData.map(b => b.name.length > 12 ? b.name.substring(0, 12) + '...' : b.name), datasets: [{ data: banksData.map(b => b.npl), backgroundColor: banksData.map(b => b.npl > 4 ? 'rgba(239, 68, 68, 0.8)' : 'rgba(16, 185, 129, 0.8)'), borderRadius: 8 }] },
                options: { indexAxis: 'y', responsive: true, maintainAspectRatio: false, layout: { padding: { left: 10 } }, plugins: { legend: { display: false } }, scales: { x: { grid: { color: col.grid }, ticks: { color: col.txt } }, y: { grid: { display: false }, ticks: { color: col.txt, font: { size: 11 }, padding: 5 } } } }
            }));
            
            // Chart Trend - REAL 2025 Toshkent viloyati ma'lumotlari
            charts.push(new Chart(document.getElementById('chartTrend'), {
                type: 'line',
                data: { labels: months, datasets: [
                    { label: 'Rasmiy NPL (%)', data: [3.99, 4.41, 4.10, 4.08, 4.15, 4.07], borderColor: '#f59e0b', backgroundColor: 'rgba(245, 158, 11, 0.1)', fill: true, tension: 0.4 },
                    { label: 'Haqiqiy NPL (%)', data: [5.8, 6.2, 5.9, 5.9, 6.0, 5.8], borderColor: '#ef4444', backgroundColor: 'rgba(239, 68, 68, 0.1)', fill: true, tension: 0.4 }
                ]},
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { labels: { color: col.txt } } }, scales: { x: { grid: { color: col.grid }, ticks: { color: col.txt } }, y: { grid: { color: col.grid }, ticks: { color: col.txt } } } }
            }));
            
            // Chart Regions
            charts.push(new Chart(document.getElementById('chartRegions'), {
                type: 'bar',
                data: { labels: regionsData.slice(0, 7).map(r => r.name.substring(3, 15)), datasets: [{ data: regionsData.slice(0, 7).map(r => r.npl), backgroundColor: regionsData.slice(0, 7).map(r => r.npl > 4 ? 'rgba(239, 68, 68, 0.8)' : 'rgba(16, 185, 129, 0.8)'), borderRadius: 6 }] },
                options: { indexAxis: 'y', responsive: true, maintainAspectRatio: false, layout: { padding: { left: 5 } }, plugins: { legend: { display: false } }, scales: { x: { grid: { color: col.grid }, ticks: { color: col.txt } }, y: { grid: { display: false }, ticks: { color: col.txt, font: { size: 10 }, padding: 5 } } } }
            }));
            
            // Chart Loan Types
            charts.push(new Chart(document.getElementById('chartLoanTypes'), {
                type: 'doughnut',
                data: { labels: ['Qishloq xo\'jaligi', 'Ipoteka', 'Mikrokredit', 'Tijorat', 'Boshqa'], datasets: [{ data: [22.5, 21.2, 14.2, 12.0, 30.1], backgroundColor: ['#10b981', '#3b82f6', '#f59e0b', '#8b5cf6', '#64748b'], borderWidth: 0 }] },
                options: { responsive: true, maintainAspectRatio: false, cutout: '55%', plugins: { legend: { position: 'right', labels: { color: col.txt, font: { size: 12 }, usePointStyle: true, padding: 15, boxWidth: 15 } } } }
            }));
            
            // Chart 3 - Banks NPL Ranking
            charts.push(new Chart(document.getElementById('chart3'), {
                type: 'bar',
                data: { labels: [...banksData].sort((a,b) => b.npl - a.npl).map(b => b.name.length > 12 ? b.name.substring(0, 12) + '..' : b.name), datasets: [{ data: [...banksData].sort((a,b) => b.npl - a.npl).map(b => b.npl), backgroundColor: [...banksData].sort((a,b) => b.npl - a.npl).map(b => b.npl > 4 ? 'rgba(239, 68, 68, 0.8)' : 'rgba(16, 185, 129, 0.8)'), borderRadius: 8 }] },
                options: { indexAxis: 'y', responsive: true, maintainAspectRatio: false, layout: { padding: { left: 10 } }, plugins: { legend: { display: false } }, scales: { x: { grid: { color: col.grid }, ticks: { color: col.txt } }, y: { grid: { display: false }, ticks: { color: col.txt, font: { size: 11 }, padding: 5 } } } }
            }));
            
            // Chart 4 - Portfolio
            charts.push(new Chart(document.getElementById('chart4'), {
                type: 'bar',
                data: { labels: banksData.map(b => b.name.length > 12 ? b.name.substring(0, 12) + '..' : b.name), datasets: [{ data: banksData.map(b => b.portfolio), backgroundColor: 'rgba(99, 102, 241, 0.7)', borderRadius: 8 }] },
                options: { indexAxis: 'y', responsive: true, maintainAspectRatio: false, layout: { padding: { left: 10 } }, plugins: { legend: { display: false } }, scales: { x: { grid: { color: col.grid }, ticks: { color: col.txt } }, y: { grid: { display: false }, ticks: { color: col.txt, font: { size: 11 }, padding: 5 } } } }
            }));
            
            // Chart Growth - REAL 2025 Toshkent viloyati portfel va NPL
            charts.push(new Chart(document.getElementById('chartGrowth'), {
                type: 'line',
                data: { labels: months, datasets: [
                    { label: 'Portfel (trln)', data: [28.91, 28.27, 28.40, 28.32, 29.40, 28.87], borderColor: '#6366f1', backgroundColor: 'rgba(99, 102, 241, 0.1)', fill: true, tension: 0.4, yAxisID: 'y' },
                    { label: 'NPL (%)', data: [3.99, 4.41, 4.10, 4.08, 4.15, 4.07], borderColor: '#ef4444', backgroundColor: 'rgba(239, 68, 68, 0.1)', fill: false, tension: 0.4, yAxisID: 'y1', borderDash: [5, 5] }
                ]},
                options: { responsive: true, maintainAspectRatio: false, interaction: { mode: 'index', intersect: false }, plugins: { legend: { labels: { color: col.txt } } }, scales: { x: { grid: { color: col.grid }, ticks: { color: col.txt } }, y: { type: 'linear', display: true, position: 'left', grid: { color: col.grid }, ticks: { color: col.txt }, title: { display: true, text: 'Portfel (trln)', color: col.txt } }, y1: { type: 'linear', display: true, position: 'right', grid: { drawOnChartArea: false }, ticks: { color: '#ef4444' }, title: { display: true, text: 'NPL (%)', color: '#ef4444' } } } }
            }));
            
            // Chart NPL Change - REAL 2025 oylik NPL o'zgarishi (Yanvar/Fevral 2026 HALI YO'Q!)
            charts.push(new Chart(document.getElementById('chartNPLChange'), {
                type: 'bar',
                data: { labels: months, datasets: [{ label: 'NPL (%)', data: [3.99, 4.41, 4.10, 4.08, 4.15, 4.07], backgroundColor: ['rgba(16, 185, 129, 0.7)', 'rgba(245, 158, 11, 0.7)', 'rgba(16, 185, 129, 0.7)', 'rgba(16, 185, 129, 0.7)', 'rgba(245, 158, 11, 0.7)', 'rgba(16, 185, 129, 0.7)'], borderRadius: 6 }]},
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false }, tooltip: { callbacks: { label: function(context) { return 'NPL: ' + context.raw + '%'; } } } }, scales: { x: { grid: { color: col.grid }, ticks: { color: col.txt } }, y: { grid: { color: col.grid }, ticks: { color: col.txt, callback: function(value) { return value + '%'; } }, min: 0, max: 6 } } }
            }));
            
            // Initialize bank radar chart
            initBankRadar(col);
            
            // Initialize branch radar chart
            initBranchRadar(col);
            
            // Chart Client Types Distribution (Mijozlar taqsimoti)
            charts.push(new Chart(document.getElementById('chartClientTypes'), {
                type: 'doughnut',
                data: { 
                    labels: ['Jismoniy (187,234)', 'Yuridik (12,456)', 'YaTT (42,162)'], 
                    datasets: [{ 
                        data: [187234, 12456, 42162], 
                        backgroundColor: ['#3b82f6', '#10b981', '#f59e0b'], 
                        borderWidth: 0,
                        borderRadius: 5
                    }] 
                },
                options: { 
                    responsive: true, 
                    maintainAspectRatio: false, 
                    cutout: '55%', 
                    plugins: { 
                        legend: { 
                            position: 'right', 
                            labels: { color: col.txt, font: { size: 12 }, usePointStyle: true, padding: 15 } 
                        } 
                    } 
                }
            }));
            
            // Chart Client NPL by Type (Mijoz turi bo'yicha NPL)
            charts.push(new Chart(document.getElementById('chartClientNPL'), {
                type: 'bar',
                data: { 
                    labels: ['üë§ Jismoniy', 'üè¢ Yuridik', 'üßë‚Äçüíº YaTT'], 
                    datasets: [{ 
                        label: 'NPL %',
                        data: [3.2, 8.7, 5.4], 
                        backgroundColor: ['rgba(59, 130, 246, 0.7)', 'rgba(239, 68, 68, 0.7)', 'rgba(245, 158, 11, 0.7)'], 
                        borderRadius: 8 
                    }] 
                },
                options: { 
                    responsive: true, 
                    maintainAspectRatio: false, 
                    plugins: { legend: { display: false } }, 
                    scales: { 
                        x: { grid: { color: col.grid }, ticks: { color: col.txt, font: { size: 12 } } }, 
                        y: { grid: { color: col.grid }, ticks: { color: col.txt, callback: function(value) { return value + '%'; } }, min: 0, max: 12 } 
                    } 
                }
            }));
            
            // Chart Sector Portfolio
            charts.push(new Chart(document.getElementById('chartSectorPortfolio'), {
                type: 'pie',
                data: { labels: sectorsData.map(s => s.name.substring(2)), datasets: [{ data: sectorsData.map(s => s.portfolio), backgroundColor: ['#10b981', '#3b82f6', '#f59e0b', '#8b5cf6', '#06b6d4', '#ef4444', '#84cc16', '#f472b6', '#64748b'], borderWidth: 2, borderColor: 'rgba(0,0,0,0.1)' }] },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { position: 'right', labels: { color: col.txt, font: { size: 10 }, usePointStyle: true } } } }
            }));
            
            // Chart Sectors
            charts.push(new Chart(document.getElementById('chartSectors'), {
                type: 'bar',
                data: { labels: sectorsData.map(s => s.name), datasets: [{ data: sectorsData.map(s => s.npl), backgroundColor: sectorsData.map(s => s.npl > 10 ? 'rgba(124, 58, 237, 0.8)' : s.npl > 4 ? 'rgba(239, 68, 68, 0.8)' : 'rgba(16, 185, 129, 0.8)'), borderRadius: 8 }] },
                options: { indexAxis: 'y', responsive: true, maintainAspectRatio: false, layout: { padding: { left: 10 } }, plugins: { legend: { display: false } }, scales: { x: { grid: { color: col.grid }, ticks: { color: col.txt } }, y: { grid: { display: false }, ticks: { color: col.txt, font: { size: 12 }, padding: 8 } } } }
            }));
            
            // Chart Sectors Pie
            charts.push(new Chart(document.getElementById('chartSectorsPie'), {
                type: 'doughnut',
                data: { labels: sectorsData.slice(0, 6).map(s => s.name.substring(2)), datasets: [{ data: sectorsData.slice(0, 6).map(s => s.portfolio), backgroundColor: ['#10b981', '#3b82f6', '#f59e0b', '#8b5cf6', '#06b6d4', '#ef4444'], borderWidth: 0 }] },
                options: { responsive: true, maintainAspectRatio: false, cutout: '55%', plugins: { legend: { position: 'right', labels: { color: col.txt, font: { size: 11 }, usePointStyle: true } } } }
            }));
            
            // Chart Regions Full
            charts.push(new Chart(document.getElementById('chartRegionsFull'), {
                type: 'bar',
                data: { labels: regionsData.map(r => r.name.substring(3)), datasets: [{ data: regionsData.map(r => r.npl), backgroundColor: regionsData.map(r => r.npl > 5 ? 'rgba(239, 68, 68, 0.8)' : r.npl > 3 ? 'rgba(245, 158, 11, 0.8)' : 'rgba(16, 185, 129, 0.8)'), borderRadius: 8 }] },
                options: { indexAxis: 'y', responsive: true, maintainAspectRatio: false, layout: { padding: { left: 10 } }, plugins: { legend: { display: false } }, scales: { x: { grid: { color: col.grid }, ticks: { color: col.txt } }, y: { grid: { display: false }, ticks: { color: col.txt, font: { size: 11 }, padding: 5 } } } }
            }));
            
            // Chart 95413 Compare
            charts.push(new Chart(document.getElementById('chart95413Compare'), {
                type: 'bar',
                data: { labels: ['Rasmiy NPL', 'Haqiqiy NPL'], datasets: [{ data: [5.8, 9.2], backgroundColor: ['rgba(245, 158, 11, 0.8)', 'rgba(239, 68, 68, 0.8)'], borderRadius: 12 }] },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } }, scales: { x: { grid: { color: col.grid }, ticks: { color: col.txt } }, y: { grid: { color: col.grid }, ticks: { color: col.txt } } } }
            }));
            
            // Chart 95413 Banks
            const top95413 = banksData.filter(b => b.npl95413 > 200).sort((a,b) => b.npl95413 - a.npl95413);
            charts.push(new Chart(document.getElementById('chart95413Banks'), {
                type: 'bar',
                data: { labels: top95413.map(b => b.name.length > 12 ? b.name.substring(0, 12) + '..' : b.name), datasets: [{ data: top95413.map(b => b.npl95413), backgroundColor: 'rgba(239, 68, 68, 0.7)', borderRadius: 8 }] },
                options: { indexAxis: 'y', responsive: true, maintainAspectRatio: false, layout: { padding: { left: 10 } }, plugins: { legend: { display: false } }, scales: { x: { grid: { color: col.grid }, ticks: { color: col.txt } }, y: { grid: { display: false }, ticks: { color: col.txt, font: { size: 11 }, padding: 5 } } } }
            }));
            
            // Chart 95413 Sectors
            charts.push(new Chart(document.getElementById('chart95413Sectors'), {
                type: 'doughnut',
                data: { labels: ['Qishloq xo\'jaligi', 'Ishlab chiqarish', 'Savdo', 'Xizmat', 'Boshqa'], datasets: [{ data: [38, 28, 18, 10, 6], backgroundColor: ['#ef4444', '#f97316', '#f59e0b', '#eab308', '#84cc16'], borderWidth: 0 }] },
                options: { responsive: true, maintainAspectRatio: false, cutout: '60%', plugins: { legend: { position: 'right', labels: { color: col.txt, font: { size: 11 }, usePointStyle: true } } } }
            }));
            
            // Chart 95413 Trend
            charts.push(new Chart(document.getElementById('chart95413Trend'), {
                type: 'line',
                data: { labels: months, datasets: [{ label: '95413 mijozlar (ming)', data: [7.2, 7.5, 7.8, 8.1, 8.4, 8.6], borderColor: '#ef4444', backgroundColor: 'rgba(239, 68, 68, 0.1)', fill: true, tension: 0.4 }]},
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { labels: { color: col.txt } } }, scales: { x: { grid: { color: col.grid }, ticks: { color: col.txt } }, y: { grid: { color: col.grid }, ticks: { color: col.txt } } } }
            }));
            
            // Chart Risk Distribution
            charts.push(new Chart(document.getElementById('chartRiskDist'), {
                type: 'doughnut',
                data: { labels: ['Past risk', 'O\'rta risk', 'Yuqori risk', 'Kritik risk'], datasets: [{ data: [47, 35, 12, 6], backgroundColor: ['#10b981', '#f59e0b', '#ef4444', '#7c3aed'], borderWidth: 0 }] },
                options: { responsive: true, maintainAspectRatio: false, cutout: '55%', plugins: { legend: { position: 'right', labels: { color: col.txt, font: { size: 12 }, usePointStyle: true } } } }
            }));
        }
        
        function updateCharts() {
            const col = getColors();
            charts.forEach(c => {
                if (c && c.options) {
                    if (c.options.plugins?.legend?.labels) c.options.plugins.legend.labels.color = col.txt;
                    if (c.options.scales?.x) { c.options.scales.x.ticks.color = col.txt; c.options.scales.x.grid.color = col.grid; }
                    if (c.options.scales?.y) { c.options.scales.y.ticks.color = col.txt; if (c.options.scales.y.grid) c.options.scales.y.grid.color = col.grid; }
                    if (c.options.scales?.r) { c.options.scales.r.grid.color = col.grid; c.options.scales.r.pointLabels.color = col.txt; }
                    c.update();
                }
            });
        }
        
        document.addEventListener('DOMContentLoaded', () => { renderTables(); renderClientTables(); initCharts(); renderRecommendations(); renderBranches(); render95413Tables(); });
        
        // ============== BRANCHES FUNCTIONS ==============
        let selectedBranchBank = 'ALL';
        
        function renderBranches() {
            renderBranchBankFilter();
            renderBranchesTable();
            renderBranchCharts();
        }
        
        function renderBranchBankFilter() {
            const banks = ['ALL', ...new Set(branchesData.map(b => b.bank))];
            document.getElementById('branchBankFilter').innerHTML = banks.map(bank => 
                `<button class="bank-btn-large ${selectedBranchBank === bank ? 'active' : ''}" onclick="filterBranches('${bank}')">
                    ${bank === 'ALL' ? 'üìä Barcha banklar' : bank}
                </button>`
            ).join('');
        }
        
        function filterBranches(bank) {
            selectedBranchBank = bank;
            renderBranchBankFilter();
            renderBranchesTable();
        }
        
        function getBranchRecommendation(branch) {
            if (branch.npl > 10) return { text: 'üî¥ YANGI KREDIT TO\'XTATING', class: 'critical' };
            if (branch.npl > 7) return { text: 'üî¥ KREDIT CHEKLANG', class: 'danger' };
            if (branch.npl > 5) return { text: 'üü° NAZORAT OSTIDA', class: 'warning' };
            if (branch.npl > 3) return { text: 'üü¢ EHTIYOTKORLIK BILAN', class: 'info' };
            return { text: '‚úÖ KENGAYTIRING', class: 'success' };
        }
        
        function getSectorRecommendation(bank, branch) {
            const bankRec = bankRecommendations[bank];
            if (!bankRec) return '';
            
            let sectors = [];
            if (bankRec.sectors.safe.length > 0) sectors.push('‚úÖ ' + bankRec.sectors.safe.slice(0, 2).join(', '));
            if (bankRec.sectors.avoid.length > 0) sectors.push('üö´ ' + bankRec.sectors.avoid.slice(0, 1).join(', '));
            return sectors.join(' | ');
        }
        
        function renderBranchesTable() {
            const filteredData = selectedBranchBank === 'ALL' 
                ? branchesData 
                : branchesData.filter(b => b.bank === selectedBranchBank);
            
            const sortedData = [...filteredData].sort((a, b) => b.npl - a.npl);
            
            document.getElementById('branchesTable').innerHTML = sortedData.map(b => {
                const rec = getBranchRecommendation(b);
                const effClass = b.efficiency >= 85 ? 'text-green' : b.efficiency >= 70 ? 'text-yellow' : 'text-red';
                const nplClass = b.npl > 7 ? 'text-red' : b.npl > 4 ? 'text-yellow' : 'text-green';
                
                return `<tr>
                    <td><strong>${b.bank}</strong></td>
                    <td>${b.branch}</td>
                    <td class="num">${b.loans.toLocaleString()}</td>
                    <td class="num">${b.portfolio}</td>
                    <td class="num ${nplClass}"><strong>${b.npl}%</strong></td>
                    <td class="num">${b.npl95413}</td>
                    <td class="num">${b.staff}</td>
                    <td class="num ${effClass}"><strong>${b.efficiency}%</strong></td>
                    <td><span class="badge ${rec.class}" style="font-size:10px">${rec.text}</span></td>
                </tr>`;
            }).join('');
        }
        
        function renderBranchCharts() {
            const col = getColors();
            
            // Top 10 efficient branches
            const topBranches = [...branchesData].sort((a, b) => b.efficiency - a.efficiency).slice(0, 10);
            charts.push(new Chart(document.getElementById('chartTopBranches'), {
                type: 'bar',
                data: {
                    labels: topBranches.map(b => b.branch.replace(' BXM', '')),
                    datasets: [{
                        label: 'Samaradorlik %',
                        data: topBranches.map(b => b.efficiency),
                        backgroundColor: topBranches.map(b => b.efficiency >= 90 ? '#10b981' : '#3b82f6'),
                        borderRadius: 6
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        x: { grid: { color: col.grid }, ticks: { color: col.txt }, max: 100 },
                        y: { grid: { display: false }, ticks: { color: col.txt, font: { size: 10 } } }
                    }
                }
            }));
            
            // Worst 10 branches by NPL
            const worstBranches = [...branchesData].sort((a, b) => b.npl - a.npl).slice(0, 10);
            charts.push(new Chart(document.getElementById('chartWorstBranches'), {
                type: 'bar',
                data: {
                    labels: worstBranches.map(b => b.bank.substring(0, 8) + ' - ' + b.branch.replace(' BXM', '').substring(0, 8)),
                    datasets: [{
                        label: 'NPL %',
                        data: worstBranches.map(b => b.npl),
                        backgroundColor: worstBranches.map(b => b.npl > 10 ? '#7c3aed' : '#ef4444'),
                        borderRadius: 6
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        x: { grid: { color: col.grid }, ticks: { color: col.txt } },
                        y: { grid: { display: false }, ticks: { color: col.txt, font: { size: 9 } } }
                    }
                }
            }));
        }
        
        // ============== RECOMMENDATIONS FUNCTIONS ==============
        let selectedRecBank = 'Agrobank';
        
        function renderRecommendations() {
            // Viloyat umumiy tavsiyalar
            document.getElementById('criticalRecs').innerHTML = viloyatRecommendations.general.critical.map(r => `<li>‚ö†Ô∏è ${r}</li>`).join('');
            document.getElementById('strategicRecs').innerHTML = viloyatRecommendations.general.strategic.map(r => `<li>‚úÖ ${r}</li>`).join('');
            document.getElementById('regionalRecs').innerHTML = viloyatRecommendations.general.regional.map(r => `<li>üìç ${r}</li>`).join('');
            
            // Bank selektor
            renderBankRecSelector();
            renderBankRecContent();
            
            // Filial tavsiyalari
            renderBranchRecs();
            
            // Soha tavsiyalari
            renderSectorRecs();
        }
        
        function renderBankRecSelector() {
            const container = document.getElementById('bankRecSelector');
            const riskClasses = { 'KRITIK': 'kritik', 'YUQORI': 'yuqori', 'O\'RTA': 'orta', 'PAST': 'past', 'MINIMAL': 'minimal' };
            container.innerHTML = Object.keys(bankRecommendations).map(bank => {
                const rec = bankRecommendations[bank];
                const riskClass = riskClasses[rec.risk] || 'orta';
                return `<button class="bank-btn-large ${selectedRecBank === bank ? 'active' : ''}" onclick="selectRecBank('${bank}')">
                    ${bank.length > 12 ? bank.substring(0,12) + '..' : bank}
                    <span class="risk-badge ${riskClass}">${rec.risk}</span>
                </button>`;
            }).join('');
        }
        
        function selectRecBank(bank) {
            selectedRecBank = bank;
            renderBankRecSelector();
            renderBankRecContent();
        }
        
        function renderBankRecContent() {
            const rec = bankRecommendations[selectedRecBank];
            const riskColors = { 'KRITIK': 'var(--danger)', 'YUQORI': 'var(--warning)', 'O\'RTA': 'var(--info)', 'PAST': 'var(--success)', 'MINIMAL': 'var(--cyan)' };
            
            document.getElementById('bankRecContent').innerHTML = `
                <div class="bank-detail-card">
                    <div class="bank-detail-header">
                        <h4 style="color:${riskColors[rec.risk]}">${selectedRecBank}</h4>
                        <span class="badge ${rec.risk === 'KRITIK' ? 'critical' : rec.risk === 'YUQORI' ? 'danger' : rec.risk === 'PAST' || rec.risk === 'MINIMAL' ? 'success' : 'warning'}">
                            NPL: ${rec.npl}% | Haqiqiy: ${rec.realNpl}% | Risk: ${rec.risk}
                        </span>
                    </div>
                    <div class="bank-detail-grid">
                        <div class="bank-detail-section">
                            <h5>üí™ Kuchli tomonlari</h5>
                            <ul>${rec.strengths.map(s => `<li>‚úÖ ${s}</li>`).join('')}</ul>
                        </div>
                        <div class="bank-detail-section">
                            <h5>‚ö†Ô∏è Zaif tomonlari</h5>
                            <ul>${rec.weaknesses.map(w => `<li>‚ùå ${w}</li>`).join('')}</ul>
                        </div>
                        <div class="bank-detail-section" style="grid-column: span 2;">
                            <h5>üìã Tavsiyalar</h5>
                            <ul>${rec.recommendations.map(r => `<li>${r}</li>`).join('')}</ul>
                        </div>
                        <div class="bank-detail-section">
                            <h5>üü¢ Xavfsiz sohalar (KREDIT BERING)</h5>
                            <ul>${rec.sectors.safe.map(s => `<li>‚úÖ ${s}</li>`).join('')}</ul>
                        </div>
                        <div class="bank-detail-section">
                            <h5>üü° Riskli sohalar (EHTIYOT BO'LING)</h5>
                            <ul>${rec.sectors.risky.length > 0 ? rec.sectors.risky.map(s => `<li>‚ö†Ô∏è ${s}</li>`).join('') : '<li>‚Äî Yo\'q</li>'}</ul>
                            <h5 style="margin-top:12px">üî¥ Taqiqlangan sohalar (BERMANG)</h5>
                            <ul>${rec.sectors.avoid.map(s => `<li>üö´ ${s}</li>`).join('')}</ul>
                        </div>
                    </div>
                </div>
            `;
        }
        
        function renderBranchRecs() {
            const rows = Object.entries(branchRecommendations).map(([branch, rec]) => {
                const riskBadge = rec.risk === 'KRITIK' ? 'critical' : rec.risk === 'YUQORI' ? 'danger' : rec.risk === 'PAST' ? 'success' : rec.risk === 'MINIMAL' ? 'info' : 'warning';
                return `<tr>
                    <td><strong>${branch}</strong></td>
                    <td><span class="badge ${riskBadge}">${rec.risk}</span></td>
                    <td class="num ${rec.npl > 8 ? 'text-red' : rec.npl > 4 ? 'text-yellow' : 'text-green'}">${rec.npl}%</td>
                    <td><strong>${rec.action}</strong></td>
                    <td style="font-size:11px;color:var(--text-muted)">${rec.detail}</td>
                </tr>`;
            }).join('');
            document.getElementById('branchRecsTable').innerHTML = rows;
        }
        
        function renderSectorRecs() {
            document.getElementById('sectorRecs').innerHTML = `
                <div class="sector-rec-card safe">
                    <h5>üü¢ XAVFSIZ SOHALAR</h5>
                    <p style="font-size:11px;color:var(--text-muted);margin-bottom:12px">Kredit berishni KENGAYTIRING</p>
                    <ul>
                        <li>üè† <strong>Ipoteka</strong> - 0.79% NPL, eng barqaror</li>
                        <li>üéì <strong>Ta'lim</strong> - 0.33% NPL, davlat kafolati</li>
                        <li>üè™ <strong>Tijorat</strong> - 3.12% NPL, tez aylanma</li>
                        <li>üè® <strong>Turizm</strong> - mavsumiy, lekin kafolatli</li>
                    </ul>
                </div>
                <div class="sector-rec-card risky">
                    <h5>üü° EHTIYOTKORLIK BILAN</h5>
                    <p style="font-size:11px;color:var(--text-muted);margin-bottom:12px">Qat'iy nazorat ostida</p>
                    <ul>
                        <li>üöú <strong>Qishloq xo'jaligi</strong> - 5.53% NPL, mavsumiy</li>
                        <li>üí≥ <strong>Mikrokredit</strong> - 3.59% NPL, summani cheklang</li>
                        <li>üîß <strong>Xizmat ko'rsatish</strong> - 7.09% NPL, tanlab bering</li>
                        <li>‚õèÔ∏è <strong>Kon sanoati</strong> - litsenziya risklari</li>
                    </ul>
                </div>
                <div class="sector-rec-card avoid">
                    <h5>üî¥ TAQIQLANGAN SOHALAR</h5>
                    <p style="font-size:11px;color:var(--text-muted);margin-bottom:12px">Kredit BERMANG</p>
                    <ul>
                        <li>‚öôÔ∏è <strong>Ishlab chiqarish</strong> - 21.02% NPL!</li>
                        <li>ü™° <strong>Hunarmandchilik</strong> - 20.36% NPL!</li>
                        <li>üõçÔ∏è <strong>Iste'mol krediti</strong> - 14.23% NPL</li>
                        <li>üèóÔ∏è <strong>Tugallanmagan qurilish</strong> - likvidlik yo'q</li>
                    </ul>
                </div>
            `;
        }
        
        // ===================== 95413 MA'LUMOTLARI =====================
        // 95413 Banklar bo'yicha
        const data95413Banks = [
            { bank: 'Agrobank', loans: 42431, npl95413: 2456, amount: 478.5 },
            { bank: 'BRB', loans: 19187, npl95413: 1823, amount: 312.4 },
            { bank: 'Mikrokreditbank', loans: 16388, npl95413: 1245, amount: 189.6 },
            { bank: 'Xalq Banki', loans: 50005, npl95413: 987, amount: 156.8 },
            { bank: 'Asaka Bank', loans: 6928, npl95413: 654, amount: 98.7 },
            { bank: 'Uzsanoatqurilishbank', loans: 26255, npl95413: 543, amount: 87.4 },
            { bank: 'Ipoteka Bank', loans: 38684, npl95413: 234, amount: 67.5 },
            { bank: 'Hamkorbank', loans: 14953, npl95413: 234, amount: 45.6 },
            { bank: 'Aloqabank', loans: 5639, npl95413: 187, amount: 34.2 },
            { bank: 'Milliy Bank', loans: 26563, npl95413: 123, amount: 28.9 },
            { bank: 'Ipak Yo\'li Bank', loans: 2463, npl95413: 45, amount: 12.3 },
            { bank: 'Anor Bank', loans: 15326, npl95413: 34, amount: 8.7 },
            { bank: 'Hayot Bank', loans: 1404, npl95413: 18, amount: 4.5 },
            { bank: 'Davr Bank', loans: 3017, npl95413: 12, amount: 3.2 },
            { bank: 'Turonbank', loans: 3163, npl95413: 12, amount: 2.8 },
            { bank: 'Garant Bank', loans: 1160, npl95413: 8, amount: 1.9 },
            { bank: 'Infinbank', loans: 2822, npl95413: 0, amount: 0 },
            { bank: 'Universal Bank', loans: 323, npl95413: 0, amount: 0 }
        ];
        
        // 95413 Sohalar bo'yicha
        const data95413Sectors = [
            { sector: 'üöú Qishloq xo\'jaligi', loans: 23647, npl95413: 3245, amount: 523.4, trend: '‚ÜóÔ∏è +12%' },
            { sector: '‚öôÔ∏è Ishlab chiqarish', loans: 18563, npl95413: 2156, amount: 312.5, trend: '‚ÜóÔ∏è +8%' },
            { sector: 'üõçÔ∏è Savdo', loans: 15234, npl95413: 1234, amount: 189.3, trend: '‚ÜòÔ∏è -3%' },
            { sector: 'üí≥ Mikrokredit', loans: 35678, npl95413: 987, amount: 145.6, trend: '‚ÜóÔ∏è +5%' },
            { sector: 'üîß Xizmat ko\'rsatish', loans: 12456, npl95413: 456, amount: 78.4, trend: '‚Üí 0%' },
            { sector: 'üè† Ipoteka', loans: 27833, npl95413: 234, amount: 56.7, trend: '‚ÜòÔ∏è -15%' },
            { sector: 'üèóÔ∏è Qurilish', loans: 8945, npl95413: 187, amount: 45.3, trend: '‚ÜóÔ∏è +2%' },
            { sector: 'üöõ Transport', loans: 5678, npl95413: 98, amount: 23.4, trend: '‚ÜòÔ∏è -5%' },
            { sector: 'üè® Turizm', loans: 3456, npl95413: 17, amount: 8.9, trend: '‚ÜòÔ∏è -8%' }
        ];
        
        // 95413 Mijozlar ro'yxati
        const data95413Clients = [
            { name: 'REAL TEX TASHKENT MChJ', type: 'Yuridik', bank: 'BRB', branch: 'Toshkent vil. BXM', amount: 359.59, sector: 'Ishlab chiqarish', reason: 'Bankrotlik', date: '2024-03-15' },
            { name: 'OQQORGON PAXTA SANOAT', type: 'Yuridik', bank: 'Agrobank', branch: 'Oqqo\'rg\'on BXM', amount: 127.50, sector: 'Qishloq xo\'jaligi', reason: 'Paxta narxi', date: '2024-06-20' },
            { name: 'CHIRCHIQ TRANSFORMER', type: 'Yuridik', bank: 'BRB', branch: 'Chirchiq BXM', amount: 78.20, sector: 'Ishlab chiqarish', reason: 'Buyurtma yo\'q', date: '2024-02-10' },
            { name: 'YANGIYO\'L AGRO CLUSTER', type: 'Yuridik', bank: 'Agrobank', branch: 'Yangiyo\'l BXM', amount: 67.80, sector: 'Qishloq xo\'jaligi', reason: 'Klaster bo\'linishi', date: '2024-05-12' },
            { name: 'EUROGARDEN EXPORT', type: 'Yuridik', bank: 'Xalq Banki', branch: 'Toshkent vil. BXM', amount: 52.79, sector: 'Eksport', reason: 'Sanksiyalar', date: '2024-04-08' },
            { name: 'TASHKENT METALS', type: 'Yuridik', bank: 'Asaka Bank', branch: 'Olmaliq BXM', amount: 45.30, sector: 'Ishlab chiqarish', reason: 'Xomashyo muammosi', date: '2024-07-22' },
            { name: 'PARKENT MARMAR KONLARI', type: 'Yuridik', bank: 'Hamkorbank', branch: 'Parkent BXM', amount: 34.60, sector: 'Kon sanoati', reason: 'Litsenziya bekor', date: '2024-01-30' },
            { name: 'FRESH FRUITS EXPORT', type: 'Yuridik', bank: 'Aloqabank', branch: 'Chirchiq BXM', amount: 32.70, sector: 'Eksport', reason: 'Eksport to\'xtashi', date: '2024-08-05' },
            { name: 'ANGREN ISSIQLIK', type: 'Yuridik', bank: 'Aloqabank', branch: 'Angren BXM', amount: 28.70, sector: 'Kommunal', reason: 'Byudjet qarzi', date: '2024-03-28' },
            { name: 'BEKOBOD STEEL WORKS', type: 'Yuridik', bank: 'Uzsanoatqurilishbank', branch: 'Bekobod BXM', amount: 24.50, sector: 'Ishlab chiqarish', reason: 'Jihozlar eskirgan', date: '2024-06-15' },
            { name: 'Turgunova Saida Yusufovna', type: 'Jismoniy', bank: 'BRB', branch: 'O\'rtachirchiq BXM', amount: 78.90, sector: 'Mikrokredit', reason: 'Ishsizlik', date: '2024-04-20' },
            { name: 'Tursunov Farxod Abdullayevich', type: 'Jismoniy', bank: 'BRB', branch: 'Angren BXM', amount: 78.90, sector: 'Mikrokredit', reason: 'Kasallik', date: '2024-05-10' },
            { name: 'Ergashev Dilmurod Rustamovich', type: 'Jismoniy', bank: 'Mikrokreditbank', branch: 'Yangiyo\'l BXM', amount: 67.80, sector: 'Iste\'mol', reason: 'Ishsizlik', date: '2024-07-08' },
            { name: 'Nizomov Farrux Komiljonovich', type: 'Jismoniy', bank: 'Agrobank', branch: 'Oqqo\'rg\'on BXM', amount: 56.40, sector: 'Fermer krediti', reason: 'Hosil nobud', date: '2024-08-25' },
            { name: 'Karimova Zulfiya Shavkatovna', type: 'Jismoniy', bank: 'Ipoteka Bank', branch: 'Bo\'stonliq BXM', amount: 45.60, sector: 'Ipoteka', reason: 'Ajralish', date: '2024-02-14' },
            { name: 'Abdullayev Sardor Toxirovich', type: 'Jismoniy', bank: 'Xalq Banki', branch: 'Nurafshon BXM', amount: 43.20, sector: 'Ta\'lim krediti', reason: 'O\'qishdan chetlatish', date: '2024-09-01' },
            { name: 'Normatova Feruza Sobirovna', type: 'Jismoniy', bank: 'Mikrokreditbank', branch: 'Chirchiq BXM', amount: 38.50, sector: 'Savdo', reason: 'Bozor yopilishi', date: '2024-06-30' },
            { name: 'Qosimov Jahongir Bahromovich', type: 'Jismoniy', bank: 'Agrobank', branch: 'Bekobod BXM', amount: 34.80, sector: 'Fermer krediti', reason: 'Suv taqchilligi', date: '2024-07-18' },
            { name: 'Bekmurodov Javlon Xolmurodovich', type: 'Jismoniy', bank: 'Mikrokreditbank', branch: 'Olmaliq BXM', amount: 32.10, sector: 'Mikrokredit', reason: 'Biznes tushishi', date: '2024-05-22' },
            { name: 'Rahimova Dilnoza Abdullaevna', type: 'Jismoniy', bank: 'Xalq Banki', branch: 'Qibray BXM', amount: 28.90, sector: 'Iste\'mol', reason: 'Ishdan bo\'shatish', date: '2024-04-05' },
            { name: 'OLMALIQ MEVA SAVDO YaTT', type: 'YaTT', bank: 'Mikrokreditbank', branch: 'Olmaliq BXM', amount: 45.60, sector: 'Savdo', reason: 'Raqobat', date: '2024-03-12' },
            { name: 'CHIRCHIQ AVTO SERVIS YaTT', type: 'YaTT', bank: 'Hamkorbank', branch: 'Chirchiq BXM', amount: 38.40, sector: 'Xizmat', reason: 'Mijoz yo\'qolishi', date: '2024-06-08' },
            { name: 'BEKOBOD DON SAVDO YaTT', type: 'YaTT', bank: 'Agrobank', branch: 'Bekobod BXM', amount: 34.20, sector: 'Savdo', reason: 'Narx pasayishi', date: '2024-07-25' },
            { name: 'NURAFSHON QURILISH YaTT', type: 'YaTT', bank: 'Uzsanoatqurilishbank', branch: 'Nurafshon BXM', amount: 28.70, sector: 'Qurilish', reason: 'Loyiha bekor', date: '2024-08-15' },
            { name: 'ANGREN OZIQ-OVQAT YaTT', type: 'YaTT', bank: 'Mikrokreditbank', branch: 'Angren BXM', amount: 25.30, sector: 'Ishlab chiqarish', reason: 'Sertifikat muammosi', date: '2024-05-30' },
            { name: 'PARKENT TURIZM YaTT', type: 'YaTT', bank: 'Milliy Bank', branch: 'Parkent BXM', amount: 23.40, sector: 'Turizm', reason: 'Mavsumiy tushish', date: '2024-09-10' },
            { name: 'YANGIYO\'L TRANSPORT YaTT', type: 'YaTT', bank: 'Hamkorbank', branch: 'Yangiyo\'l BXM', amount: 21.80, sector: 'Transport', reason: 'Mashina buzilishi', date: '2024-04-18' },
            { name: 'QIBRAY BOGDORCHILIK YaTT', type: 'YaTT', bank: 'Agrobank', branch: 'Qibray BXM', amount: 19.60, sector: 'Qishloq xo\'jaligi', reason: 'Kasallik', date: '2024-06-22' },
            { name: 'TOSHKENT MEBEL YaTT', type: 'YaTT', bank: 'Asaka Bank', branch: 'Toshkent vil. BXM', amount: 18.90, sector: 'Ishlab chiqarish', reason: 'Xomashyo qimmatlashi', date: '2024-07-05' },
            { name: 'BO\'STONLIQ MEHMONXONA YaTT', type: 'YaTT', bank: 'Ipoteka Bank', branch: 'Bo\'stonliq BXM', amount: 16.50, sector: 'Turizm', reason: 'Pandemiya oqibati', date: '2024-03-20' }
        ];
        
        // 95413 jadvallarini render qilish
        function render95413Tables() {
            // Banklar jadvali
            const banksTable = document.getElementById('table95413Banks');
            if (banksTable) {
                banksTable.innerHTML = data95413Banks.map(b => {
                    const pct = ((b.npl95413 / b.loans) * 100).toFixed(2);
                    const riskClass = pct > 5 ? 'critical' : pct > 3 ? 'danger' : pct > 1 ? 'warning' : 'success';
                    const riskText = pct > 5 ? 'üî¥ Kritik' : pct > 3 ? 'üü† Yuqori' : pct > 1 ? 'üü° O\'rta' : 'üü¢ Past';
                    return `<tr>
                        <td><strong>${b.bank}</strong></td>
                        <td class="num">${b.loans.toLocaleString()}</td>
                        <td class="num text-red">${b.npl95413.toLocaleString()}</td>
                        <td class="num"><span class="${pct > 3 ? 'text-red' : 'text-green'}">${pct}%</span></td>
                        <td class="num text-red">${b.amount} mlrd</td>
                        <td><span class="badge ${riskClass}">${riskText}</span></td>
                    </tr>`;
                }).join('');
            }
            
            // Filiallar jadvali - eng muammoli 20 ta
            const branchesTable = document.getElementById('table95413Branches');
            if (branchesTable) {
                const sortedBranches = [...branchesData]
                    .map(b => ({ ...b, pct: (b.npl95413 / b.loans) * 100 }))
                    .sort((a, b) => b.pct - a.pct)
                    .slice(0, 20);
                    
                branchesTable.innerHTML = sortedBranches.map(b => {
                    const riskClass = b.pct > 5 ? 'critical' : b.pct > 3 ? 'danger' : b.pct > 1 ? 'warning' : 'success';
                    const riskText = b.pct > 5 ? 'üî¥ Kritik' : b.pct > 3 ? 'üü† Yuqori' : b.pct > 1 ? 'üü° O\'rta' : 'üü¢ Past';
                    return `<tr>
                        <td><strong>${b.bank}</strong></td>
                        <td>${b.branch}</td>
                        <td class="num">${b.loans.toLocaleString()}</td>
                        <td class="num text-red">${b.npl95413}</td>
                        <td class="num"><span class="${b.pct > 3 ? 'text-red' : 'text-green'}">${b.pct.toFixed(2)}%</span></td>
                        <td><span class="badge ${riskClass}">${riskText}</span></td>
                    </tr>`;
                }).join('');
            }
            
            // Sohalar jadvali
            const sectorsTable = document.getElementById('table95413Sectors');
            if (sectorsTable) {
                sectorsTable.innerHTML = data95413Sectors.map(s => {
                    const pct = ((s.npl95413 / s.loans) * 100).toFixed(2);
                    const trendClass = s.trend.includes('‚ÜóÔ∏è') ? 'text-red' : s.trend.includes('‚ÜòÔ∏è') ? 'text-green' : 'text-yellow';
                    return `<tr>
                        <td><strong>${s.sector}</strong></td>
                        <td class="num">${s.loans.toLocaleString()}</td>
                        <td class="num text-red">${s.npl95413.toLocaleString()}</td>
                        <td class="num"><span class="${pct > 5 ? 'text-red' : 'text-green'}">${pct}%</span></td>
                        <td class="num text-red">${s.amount} mlrd</td>
                        <td><span class="${trendClass}">${s.trend}</span></td>
                    </tr>`;
                }).join('');
            }
            
            // Mijozlar jadvali
            const clientsTable = document.getElementById('table95413Clients');
            if (clientsTable) {
                clientsTable.innerHTML = data95413Clients.map(c => {
                    const typeClass = c.type === 'Yuridik' ? 'text-purple' : c.type === 'Jismoniy' ? 'text-blue' : 'text-orange';
                    const typeIcon = c.type === 'Yuridik' ? 'üè¢' : c.type === 'Jismoniy' ? 'üë§' : 'üßë‚Äçüíº';
                    return `<tr onclick="show95413ClientDetail('${c.name.replace(/'/g, "\\'")}', '${c.type}', '${c.bank}', '${c.branch}', ${c.amount}, '${c.sector}', '${c.reason}', '${c.date}')" style="cursor:pointer">
                        <td><strong>${c.name}</strong></td>
                        <td><span class="${typeClass}">${typeIcon} ${c.type}</span></td>
                        <td>${c.bank}</td>
                        <td style="font-size:11px">${c.branch}</td>
                        <td class="num text-red"><strong>${c.amount} mlrd</strong></td>
                        <td style="font-size:11px">${c.sector}</td>
                        <td style="font-size:11px">${c.reason}</td>
                        <td style="font-size:11px">${c.date}</td>
                    </tr>`;
                }).join('');
            }
        }
        
        function show95413ClientDetail(name, type, bank, branch, amount, sector, reason, date) {
            const typeIcon = type === 'Yuridik' ? 'üè¢' : type === 'Jismoniy' ? 'üë§' : 'üßë‚Äçüíº';
            
            openModal('üö®', name, `
                <div class="modal-stats">
                    <div class="modal-stat"><div class="modal-stat-value text-red">${amount} mlrd</div><div class="modal-stat-label">95413 qarz</div></div>
                    <div class="modal-stat"><div class="modal-stat-value text-purple">${type}</div><div class="modal-stat-label">Mijoz turi</div></div>
                    <div class="modal-stat"><div class="modal-stat-value text-blue">${bank}</div><div class="modal-stat-label">Bank</div></div>
                </div>
                
                <div class="modal-section danger">
                    <h5>‚õî 95413 - Portfeldan olingan!</h5>
                    <p>Bu kredit rasmiy NPL statistikasida aks etmaydi, lekin bank uchun haqiqiy yo'qotish hisoblanadi.</p>
                </div>
                
                <div class="modal-section">
                    <h5>${typeIcon} Mijoz ma'lumotlari</h5>
                    <table style="width:100%;font-size:13px;">
                        <tr><td style="padding:8px 0;border-bottom:1px solid var(--bg-tertiary)"><strong>Filial:</strong></td><td>${branch}</td></tr>
                        <tr><td style="padding:8px 0;border-bottom:1px solid var(--bg-tertiary)"><strong>Soha:</strong></td><td>${sector}</td></tr>
                        <tr><td style="padding:8px 0;border-bottom:1px solid var(--bg-tertiary)"><strong>95413 ga o'tkazilgan:</strong></td><td>${date}</td></tr>
                        <tr><td style="padding:8px 0;"><strong>Sabab:</strong></td><td><span class="badge critical">${reason}</span></td></tr>
                    </table>
                </div>
                
                <div class="modal-section danger">
                    <h5>üí° Tavsiya</h5>
                    <p>${amount > 50 ? "üî¥ KATTA QARZ - Sudga murojaat qiling va aktivlarni musodara qilishni boshlang." : 
                        amount > 20 ? "üü† O'RTA QARZ - Mijoz bilan muzokaralar olib boring va restrukturizatsiya imkoniyatini ko'ring." : 
                        "üü° KICHIK QARZ - Undirish bo'limi orqali ishlang."}</p>
                </div>
            `);
        }
        
        // ===================== AZURE SPEECH API - OVOZLI TAVSIYALAR =====================
        const AZURE_SPEECH_KEY = '1XBh7tnZOwcd7uI1kGu8at1gkys1aBIIRiYwQ5Dn7dxszAMShYVqJQQJ99CAACYeBjFXJ3w3AAAYACOGcO7v';
        const AZURE_SPEECH_REGION = 'eastus';
        let isSpeaking = false;
        
        async function speakText(text, lang = 'uz-UZ') {
            if (isSpeaking) {
                window.speechSynthesis.cancel();
                isSpeaking = false;
                return;
            }
            
            try {
                // Azure Speech API orqali ovozli sintez
                const tokenUrl = `https://${AZURE_SPEECH_REGION}.api.cognitive.microsoft.com/sts/v1.0/issueToken`;
                const tokenResponse = await fetch(tokenUrl, {
                    method: 'POST',
                    headers: {
                        'Ocp-Apim-Subscription-Key': AZURE_SPEECH_KEY,
                        'Content-Type': 'application/x-www-form-urlencoded'
                    }
                });
                
                if (!tokenResponse.ok) {
                    throw new Error('Token olishda xato');
                }
                
                const token = await tokenResponse.text();
                
                const ssml = `
                    <speak version='1.0' xmlns='http://www.w3.org/2001/10/synthesis' xml:lang='${lang}'>
                        <voice name='uz-UZ-MadinaNeural'>
                            <prosody rate='0.9' pitch='+0%'>
                                ${text}
                            </prosody>
                        </voice>
                    </speak>
                `;
                
                const audioUrl = `https://${AZURE_SPEECH_REGION}.tts.speech.microsoft.com/cognitiveservices/v1`;
                const audioResponse = await fetch(audioUrl, {
                    method: 'POST',
                    headers: {
                        'Authorization': 'Bearer ' + token,
                        'Content-Type': 'application/ssml+xml',
                        'X-Microsoft-OutputFormat': 'audio-16khz-128kbitrate-mono-mp3'
                    },
                    body: ssml
                });
                
                if (!audioResponse.ok) {
                    throw new Error('Audio yaratishda xato');
                }
                
                const audioBlob = await audioResponse.blob();
                const audioUrlObj = URL.createObjectURL(audioBlob);
                const audio = new Audio(audioUrlObj);
                
                isSpeaking = true;
                audio.onended = () => { isSpeaking = false; };
                audio.play();
                
            } catch (error) {
                console.error('Azure Speech xato:', error);
                // Fallback - brauzer Speech API
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = 'ru-RU'; // Uzbek yo'q bo'lsa ruscha
                utterance.rate = 0.9;
                isSpeaking = true;
                utterance.onend = () => { isSpeaking = false; };
                window.speechSynthesis.speak(utterance);
            }
        }
        
        function speak95413Summary() {
            const text = `
                Diqqat! 95413 hisobi bo'yicha muhim ma'lumot.
                
                Toshkent viloyatida 8 ming 614 ta kredit 95413 hisobiga o'tkazilgan.
                Umumiy yashirilgan summa 1 trillion 600 milliard so'm.
                
                Eng muammoli banklar:
                Birinchi: Agrobank, 2456 ta kredit, 478 milliard so'm.
                Ikkinchi: BRB, 1823 ta kredit, 312 milliard so'm.
                Uchinchi: Mikrokreditbank, 1245 ta kredit, 189 milliard so'm.
                
                Eng xavfli sohalar:
                Qishloq xo'jaligi, 3245 ta kredit 95413 da.
                Ishlab chiqarish, 2156 ta kredit.
                Savdo sohasi, 1234 ta kredit.
                
                Tavsiya: 95413 hisobiga yangi kredit o'tkazishni to'xtating.
                Mavjud qarzlarni undirish choralarini ko'ring.
                Bu kredit portfelidan olib tashlangan, lekin bank uchun haqiqiy yo'qotish!
            `;
            
            speakText(text);
        }
        
        function speakRecommendation(bank) {
            const rec = bankRecommendations[bank];
            if (!rec) return;
            
            const text = `
                ${bank} banki bo'yicha tavsiya.
                
                Holat: ${rec.status}.
                ${rec.comment}
                
                Xavfsiz sohalar: ${rec.sectors.safe.join(', ')}.
                Ehtiyot bo'ling: ${rec.sectors.caution.join(', ')}.
                Taqiqlangan: ${rec.sectors.avoid.join(', ')}.
                
                ${rec.action}
            `;
            
            speakText(text);
        }
        
    </script>
</body>
</html>
